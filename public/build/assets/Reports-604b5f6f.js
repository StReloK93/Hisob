import{r as k,a as M}from"./helpers-ab18c3f4.js";import{d as C,m as v,b as r,o as _,c as w,w as o,f as l,x as G,y as H,g as D,t as U,z as j,h as V,n as g,p as I,a as z,r as $,A as P,i as N,e as S,j as q,F as T,l as B,B as J}from"./app-d5ce1550.js";import{s as A}from"./swal-00d0fd38.js";import{_ as x}from"./Icon.vue_vue_type_script_setup_true_lang-cb1fb80e.js";const K=C({__name:"AddMonthReport",props:["report"],emits:["addReport"],setup(p,{emit:f}){const{report:u}=p,n=v({name:null,report_type_id:u.id,old:!0});async function i(){await g.post("report",n).then(({data:e})=>{f("addReport",{report_type_id:u.id,report:e,old:!0}),d.dialog=!1})}const d=v({dialog:!1,products:null});return(e,t)=>{const s=r("v-list-item"),a=r("v-text-field"),y=r("v-col"),b=r("v-row"),R=r("v-dialog");return _(),w(R,{modelValue:d.dialog,"onUpdate:modelValue":t[2]||(t[2]=c=>d.dialog=c),persistent:"",width:"600",location:"right"},{activator:o(({props:c})=>[l(s,G(H(c)),{default:o(()=>[D(U(p.report.name),1)]),_:2},1040)]),default:o(()=>[l(j,{submitMethod:i,onClose:t[1]||(t[1]=c=>d.dialog=!1),title:p.report.name},{default:o(()=>[l(b,null,{default:o(()=>[l(y,{cols:"12",class:"pt-3"},{default:o(()=>[l(a,{rules:V(k),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=c=>n.name=c),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),Q=C({__name:"AddMonth",props:["report"],emits:["addReport"],setup(p,{emit:f}){const{report:u}=p,n=v({name:null,report_type_id:u.id,old:!1});async function i(){await g.post("report",n).then(({data:e})=>{f("addReport",{report_type_id:u.id,report:e,old:!0}),d.dialog=!1})}const d=v({dialog:!1,products:null});return(e,t)=>{const s=r("v-list-item"),a=r("v-text-field"),y=r("v-col"),b=r("v-row"),R=r("v-dialog");return _(),w(R,{modelValue:d.dialog,"onUpdate:modelValue":t[2]||(t[2]=c=>d.dialog=c),persistent:"",width:"600",location:"right"},{activator:o(({props:c})=>[l(s,G(H(c)),{default:o(()=>[D(U(p.report.name),1)]),_:2},1040)]),default:o(()=>[l(j,{submitMethod:i,onClose:t[1]||(t[1]=c=>d.dialog=!1),title:p.report.name},{default:o(()=>[l(b,null,{default:o(()=>[l(y,{cols:"12",class:"pt-3"},{default:o(()=>[l(a,{rules:V(k),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=c=>n.name=c),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),W=C({__name:"Movement",props:["report"],emits:["addMovement"],setup(p,{emit:f}){const{report:u}=p,n=v({name:null,start:null,end:null,products:[],report_type_id:u.id});async function i(){await g.post("report",n).then(({data:e})=>{f("addMovement",{report_type_id:u.id,report:e,old:!0}),d.dialog=!1})}const d=v({dialog:!1,products:null});return g.get("product").then(({data:e})=>{d.products=e}),(e,t)=>{const s=r("v-btn"),a=r("v-text-field"),y=r("v-col"),b=r("v-autocomplete"),R=r("v-row"),c=r("v-dialog");return _(),w(c,{modelValue:d.dialog,"onUpdate:modelValue":t[5]||(t[5]=m=>d.dialog=m),persistent:"",width:"600",location:"right"},{activator:o(({props:m})=>[l(s,I({"prepend-icon":"mdi-timeline-clock-outline",class:"text-capitalize ml-4",variant:"tonal"},m),{default:o(()=>[D(" Harakat ")]),_:2},1040)]),default:o(()=>[l(j,{submitMethod:i,onClose:t[4]||(t[4]=m=>d.dialog=!1),title:"Belgilangan vaqtda muddati o'tadiganlar"},{default:o(()=>[l(R,null,{default:o(()=>[l(y,null,{default:o(()=>[l(a,{rules:V(k),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=m=>n.name=m),label:"Nomi"},null,8,["rules","modelValue"])]),_:1}),l(y,{cols:"12",class:"pt-3"},{default:o(()=>[l(b,{rules:V(k),items:d.products,modelValue:n.products,"onUpdate:modelValue":t[1]||(t[1]=m=>n.products=m),label:"Himoya vositalari","item-title":"name","item-value":m=>m,multiple:""},null,8,["rules","items","modelValue","item-value"])]),_:1}),l(y,null,{default:o(()=>[l(a,{rules:V(k),type:"date",modelValue:n.start,"onUpdate:modelValue":t[2]||(t[2]=m=>n.start=m),label:"Dan"},null,8,["rules","modelValue"])]),_:1}),l(y,null,{default:o(()=>[l(a,{rules:V(k),type:"date",modelValue:n.end,"onUpdate:modelValue":t[3]||(t[3]=m=>n.end=m),label:"Gacha"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),X=C({__name:"MovementTable",props:["report_id"],setup(p,{expose:f}){const{report_id:u}=p,n=z(),i=v({gridApi:null,reports:[]}),d=v([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:x,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{hide:n.userRoles.includes(2),cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:x,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:e,node:t})=>{e.confirmed||A.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(s=>{s.isConfirmed&&g.get(`report_success/${e.id}`).then(({data:a})=>{t.setData(a)})})}},{hide:n.userRoles.includes(3)==!1||n.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:x,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:e})=>{e.confirmed||A.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{i.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${u}`).then(({data:e})=>{i.reports=e}),f({pageData:i}),(e,t)=>{const s=r("AgGridVue");return _(),w(s,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:d,rowData:i.reports,onGridReady:t[0]||(t[0]=a=>i.gridApi=a.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),Z=C({__name:"OldReportTable",props:["report_id"],setup(p,{expose:f}){const{report_id:u}=p,n=z(),i=v({gridApi:null,reports:[]}),d=v([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:x,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{M(`umumiy/muddati-utganlar/${e.id}`,`${e.name}.xlsx`)}},{hide:n.userRoles.includes(3)==!1,cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:x,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:e,node:t})=>{e.confirmed||A.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(s=>{s.isConfirmed&&g.get(`report_success/${e.id}`).then(({data:a})=>{t.setData(a)})})}},{hide:n.userRoles.includes(3)==!1||n.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:x,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:e})=>{e.confirmed||A.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{i.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${u}`).then(({data:e})=>{i.reports=e}),f({pageData:i}),(e,t)=>{const s=r("AgGridVue");return _(),w(s,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:d,rowData:i.reports,onGridReady:t[0]||(t[0]=a=>i.gridApi=a.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),ee=C({__name:"CurrentReportTable",props:["report_id"],setup(p,{expose:f}){const{report_id:u}=p,n=z(),i=v({gridApi:null,reports:[]}),d=v([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:x,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{M(`umumiy/hali-amalda/${e.id}`,`${e.name}.xlsx`)}},{hide:n.userRoles.includes(3)==!1||n.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:x,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},onCellClicked:({data:e})=>{A.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{i.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${u}`).then(({data:e})=>{i.reports=e}),f({pageData:i}),(e,t)=>{const s=r("AgGridVue");return _(),w(s,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:d,rowData:i.reports,onGridReady:t[0]||(t[0]=a=>i.gridApi=a.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),te={class:"d-flex flex-column"},re=C({__name:"Reports",setup(p){const f=$(),u=$(),n=$();function i(t){n.value.pageData.gridApi.applyTransaction({add:[t.report]}),e.tab=2}function d(t){t.report_type_id==1?(e.tab=0,f.value.pageData.gridApi.applyTransaction({add:[t.report]})):t.report_type_id==2&&(e.tab=1,u.value.pageData.gridApi.applyTransaction({add:[t.report]}))}g.get("report_type").then(({data:t})=>{const s=t.map(a=>(a.id==1&&(a.component=P(K)),a.id==2&&(a.component=P(Q)),a));e.report_types=s});const e=v({tab:0,report_types:[]});return(t,s)=>{const a=r("v-btn"),y=r("v-list"),b=r("v-menu"),R=r("v-tab"),c=r("v-tabs"),m=r("v-window-item"),Y=r("v-window"),E=r("v-card-text"),F=r("v-card"),L=r("v-spacer");return _(),N("section",te,[l(b,null,{activator:o(({props:h})=>[S("div",null,[l(a,I({"append-icon":"mdi-chevron-down",class:"text-capitalize",color:"blue-grey",variant:"tonal"},h),{default:o(()=>[D(" Hisobotlar ")]),_:2},1040),e.report_types.length?(_(),w(W,{key:0,onAddMovement:i,report:e.report_types[2]},null,8,["report"])):q("",!0),l(a,{onClick:s[0]||(s[0]=O=>V(M)("umumiy/employes","umumiy.xlsx")),"prepend-icon":"mdi-book-account",class:"text-capitalize ml-4",variant:"tonal"},{default:o(()=>[D(" Umumiy malumotlar ")]),_:1})])]),default:o(()=>[l(y,{class:"py-1"},{default:o(()=>[(_(!0),N(T,null,B(e.report_types,h=>(_(),N("div",null,[h.id!=3?(_(),w(J(h.component),{key:0,onAddReport:d,report:h},null,40,["report"])):q("",!0)]))),256))]),_:1})]),_:1}),l(L,{class:"mt-4"},{default:o(()=>[l(F,{class:"h-100 d-flex flex-column"},{default:o(()=>[l(c,{modelValue:e.tab,"onUpdate:modelValue":s[1]||(s[1]=h=>e.tab=h)},{default:o(()=>[(_(!0),N(T,null,B(e.report_types,(h,O)=>(_(),N(T,null,[h.id!=4?(_(),w(R,{key:0,class:"text-capitalize"},{default:o(()=>[D(U(h.name),1)]),_:2},1024)):q("",!0)],64))),256))]),_:1},8,["modelValue"]),l(E,{class:"flex-grow-1"},{default:o(()=>[l(Y,{modelValue:e.tab,"onUpdate:modelValue":s[2]||(s[2]=h=>e.tab=h),class:"h-100"},{default:o(()=>[l(m,{class:"h-100"},{default:o(()=>[l(Z,{ref_key:"oldTable",ref:f,report_id:1},null,512)]),_:1}),l(m,{class:"h-100"},{default:o(()=>[l(ee,{ref_key:"currentTable",ref:u,report_id:2},null,512)]),_:1}),l(m,{class:"h-100"},{default:o(()=>[l(X,{ref_key:"movementTable",ref:n,report_id:3},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}});export{re as default};
