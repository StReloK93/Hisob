import{d as C,l as f,a as r,o as _,c as h,w as o,e as l,s as q,v as z,f as y,t as k,x as P,g as U,m as g,r as N,y as A,h as V,b as I,n as F,F as $,k as T,z as Y}from"./app-5751a8d8.js";import{r as j}from"./helpers-ca74a7fa.js";import{s as D}from"./swal-48ea1942.js";import{_ as R}from"./Icon.vue_vue_type_script_setup_true_lang-2b491ab6.js";const E=C({__name:"AddMonthReport",props:["report"],emits:["addReport"],setup(c,{emit:p}){const{report:m}=c,n=f({name:null,report_type_id:m.id,old:!0});async function i(){await g.post("report",n).then(({data:a})=>{p("addReport",{report_type_id:m.id,report:a,old:!0}),e.dialog=!1})}const e=f({dialog:!1,products:null});return(a,t)=>{const s=r("v-list-item"),w=r("v-text-field"),b=r("v-col"),x=r("v-row"),v=r("v-dialog");return _(),h(v,{modelValue:e.dialog,"onUpdate:modelValue":t[2]||(t[2]=d=>e.dialog=d),persistent:"",width:"600",location:"right"},{activator:o(({props:d})=>[l(s,q(z(d)),{default:o(()=>[y(k(c.report.name),1)]),_:2},1040)]),default:o(()=>[l(P,{submitMethod:i,onClose:t[1]||(t[1]=d=>e.dialog=!1),title:c.report.name},{default:o(()=>[l(x,null,{default:o(()=>[l(b,{cols:"12",class:"pt-3"},{default:o(()=>[l(w,{rules:U(j),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=d=>n.name=d),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),L=C({__name:"AddMonth",props:["report"],emits:["addReport"],setup(c,{emit:p}){const{report:m}=c,n=f({name:null,report_type_id:m.id,old:!1});async function i(){await g.post("report",n).then(({data:a})=>{p("addReport",{report_type_id:m.id,report:a,old:!0}),e.dialog=!1})}const e=f({dialog:!1,products:null});return(a,t)=>{const s=r("v-list-item"),w=r("v-text-field"),b=r("v-col"),x=r("v-row"),v=r("v-dialog");return _(),h(v,{modelValue:e.dialog,"onUpdate:modelValue":t[2]||(t[2]=d=>e.dialog=d),persistent:"",width:"600",location:"right"},{activator:o(({props:d})=>[l(s,q(z(d)),{default:o(()=>[y(k(c.report.name),1)]),_:2},1040)]),default:o(()=>[l(P,{submitMethod:i,onClose:t[1]||(t[1]=d=>e.dialog=!1),title:c.report.name},{default:o(()=>[l(x,null,{default:o(()=>[l(b,{cols:"12",class:"pt-3"},{default:o(()=>[l(w,{rules:U(j),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=d=>n.name=d),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),O=C({__name:"OldReportTable",props:["report_id"],setup(c,{expose:p}){const{report_id:m}=c,n=f({gridApi:null,reports:[]}),i=f([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:R,cellRendererParams:{icon:"mdi-checkbox-marked-outline"},onCellClicked:({data:e})=>{D.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(a=>{a.isConfirmed&&g.get(`report_success/${e.id}`)})}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},onCellClicked:({data:e})=>{D.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(a=>{a.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{n.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${m}`).then(({data:e})=>{n.reports=e}),p({pageData:n}),(e,a)=>{const t=r("AgGridVue");return _(),h(t,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:s})=>s.id,columnDefs:i,rowData:n.reports,onGridReady:a[0]||(a[0]=s=>n.gridApi=s.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),S=C({__name:"CurrentReportTable",props:["report_id"],setup(c,{expose:p}){const{report_id:m}=c,n=f({gridApi:null,reports:[]}),i=f([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},onCellClicked:({data:e})=>{D.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(a=>{a.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{n.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${m}`).then(({data:e})=>{n.reports=e}),p({pageData:n}),(e,a)=>{const t=r("AgGridVue");return _(),h(t,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:s})=>s.id,columnDefs:i,rowData:n.reports,onGridReady:a[0]||(a[0]=s=>n.gridApi=s.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),J={class:"d-flex flex-column"},Z=C({__name:"Reports",setup(c){const p=N(),m=N();function n(e){e.report_type_id==1?(i.tab=0,p.value.pageData.gridApi.applyTransaction({add:[e.report]})):e.report_type_id==2&&(i.tab=1,m.value.pageData.gridApi.applyTransaction({add:[e.report]}))}g.get("report_type").then(({data:e})=>{const a=e.map(t=>(t.id==1&&(t.component=A(E)),t.id==2&&(t.component=A(L)),t));i.report_types=a});const i=f({tab:0,report_types:[]});return(e,a)=>{const t=r("v-btn"),s=r("v-list"),w=r("v-menu"),b=r("v-tab"),x=r("v-tabs"),v=r("v-window-item"),d=r("v-window"),G=r("v-card-text"),H=r("v-card"),M=r("v-spacer");return _(),V("section",J,[l(w,null,{activator:o(({props:u})=>[I("div",null,[l(t,F({"prepend-icon":"mdi-microsoft-excel",class:"text-capitalize",color:"blue-grey",variant:"tonal"},u),{default:o(()=>[y(" Hisobotlar ")]),_:2},1040),l(t,{"prepend-icon":"mdi-microsoft-excel",class:"text-capitalize ml-4",color:"blue-grey",variant:"tonal"},{default:o(()=>[y(" Harakat ")]),_:1})])]),default:o(()=>[l(s,{class:"py-1"},{default:o(()=>[(_(!0),V($,null,T(i.report_types,u=>(_(),V("div",null,[(_(),h(Y(u.component),{onAddReport:n,report:u},null,40,["report"]))]))),256))]),_:1})]),_:1}),l(M,{class:"mt-4"},{default:o(()=>[l(H,{class:"h-100 d-flex flex-column"},{default:o(()=>[l(x,{modelValue:i.tab,"onUpdate:modelValue":a[0]||(a[0]=u=>i.tab=u)},{default:o(()=>[(_(!0),V($,null,T(i.report_types,(u,B)=>(_(),h(b,{value:B,class:"text-capitalize"},{default:o(()=>[y(k(u.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),l(G,{class:"flex-grow-1"},{default:o(()=>[l(d,{modelValue:i.tab,"onUpdate:modelValue":a[1]||(a[1]=u=>i.tab=u),class:"h-100"},{default:o(()=>[l(v,{value:"one",class:"h-100"},{default:o(()=>[l(O,{ref_key:"oldTable",ref:p,report_id:1},null,512)]),_:1}),l(v,{value:"two",class:"h-100"},{default:o(()=>[l(S,{ref_key:"currentTable",ref:m,report_id:2},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}});export{Z as default};
