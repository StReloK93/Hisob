import{_ as C}from"./Icon.vue_vue_type_script_setup_true_lang-4480cc42.js";import{d as x,l as y,m as _,a as d,o as V,c as D,w as u,e as a,g as p,i as w,n as I,p as $,u as j,r as k,q as B,h as F,b as E}from"./app-e1ef3618.js";import{r as v}from"./helpers-ca74a7fa.js";const R=x({__name:"FormInputs",props:["formData","pageData"],setup(o){const{formData:r}=o,s=y({organizations:null,positions:null,inputLoading:!1});function m(){r.table_number.length==5&&(s.inputLoading=!0,f())}_.all([_.get("accessOrganizations"),_.get("position")]).then(_.spread(({data:t},{data:l})=>{s.organizations=t,s.positions=l}));function f(){_.get(`employe/getdata/${r.table_number}`).then(({data:t})=>{r.name=t.name,r.organization_id=t.organization_id,r.profession=t.profession,r.hiring_date=t.hiring_date,setTimeout(()=>s.inputLoading=!1,1e3)}).catch(()=>{s.inputLoading=!1})}return(t,l)=>{const c=d("v-text-field"),b=d("v-autocomplete"),e=d("v-col"),i=d("v-radio"),g=d("v-radio-group"),z=d("v-row");return V(),D(z,null,{default:u(()=>[a(e,{cols:"12",class:"pt-0"},{default:u(()=>[a(c,{class:"mb-2",onInput:m,loading:s.inputLoading,rules:p(v),label:"Tabel raqam",modelValue:o.formData.table_number,"onUpdate:modelValue":l[0]||(l[0]=n=>o.formData.table_number=n),type:"number"},null,8,["loading","rules","modelValue"]),a(c,{class:"mb-2",rules:p(v),label:"F.I.SH",modelValue:o.formData.name,"onUpdate:modelValue":l[1]||(l[1]=n=>o.formData.name=n)},null,8,["rules","modelValue"]),s.organizations?(V(),D(b,{key:0,class:"mb-2",items:s.organizations,modelValue:o.formData.organization_id,"onUpdate:modelValue":l[2]||(l[2]=n=>o.formData.organization_id=n),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:p(v)},null,8,["items","modelValue","rules"])):w("",!0),s.positions?(V(),D(b,{key:1,class:"mb-2",items:s.positions,modelValue:o.formData.position_id,"onUpdate:modelValue":l[3]||(l[3]=n=>o.formData.position_id=n),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:p(v),"item-value":"id"},null,8,["items","modelValue","rules"])):w("",!0),a(c,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:o.formData.profession,"onUpdate:modelValue":l[4]||(l[4]=n=>o.formData.profession=n),rules:p(v)},null,8,["modelValue","rules"]),a(c,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:o.formData.hiring_date,"onUpdate:modelValue":l[5]||(l[5]=n=>o.formData.hiring_date=n),type:"date",rules:p(v)},null,8,["modelValue","rules"])]),_:1}),a(e,{cols:"6"},{default:u(()=>[a(c,{class:"mb-2",label:"Bo'yi",modelValue:o.formData.heigth,"onUpdate:modelValue":l[6]||(l[6]=n=>o.formData.heigth=n)},null,8,["modelValue"]),a(c,{class:"mb-2",label:"Kiyim o'lchami",modelValue:o.formData.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=n=>o.formData.size_cloth=n)},null,8,["modelValue"])]),_:1}),a(e,{cols:"6"},{default:u(()=>[a(c,{class:"mb-2",label:"Bosh o'lchami",modelValue:o.formData.size_head,"onUpdate:modelValue":l[8]||(l[8]=n=>o.formData.size_head=n)},null,8,["modelValue"]),a(c,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:o.formData.size_shoes,"onUpdate:modelValue":l[9]||(l[9]=n=>o.formData.size_shoes=n)},null,8,["modelValue"])]),_:1}),a(e,{cols:"12"},{default:u(()=>[a(g,{small:"",modelValue:o.formData.gender,"onUpdate:modelValue":l[10]||(l[10]=n=>o.formData.gender=n),rules:p(v)},{default:u(()=>[a(i,{label:"Erkak",value:!0}),a(i,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})}}}),L=x({__name:"AddEmploye",emits:["addEmploye"],setup(o,{emit:r}){const s=y({dialog:!1}),m=y({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function f(){await _.post("employe",m).then(({data:t})=>{s.dialog=!1,r("addEmploye",t)})}return(t,l)=>{const c=d("v-btn"),b=d("CustomForm"),e=d("v-dialog"),i=d("v-row");return V(),D(i,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:u(()=>[a(e,{modelValue:s.dialog,"onUpdate:modelValue":l[1]||(l[1]=g=>s.dialog=g),persistent:"",width:"768",location:"right"},{activator:u(({props:g})=>[a(c,I({icon:"mdi-plus",color:"teal"},g),null,16)]),default:u(()=>[a(b,{submitMethod:f,onClose:l[0]||(l[0]=g=>s.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:u(()=>[a(R,{formData:m,pageData:s},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),q=x({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(o,{expose:r,emit:s}){const{current:m}=o,f=y({dialog:!1}),t=y({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function l(){_.get(`employe/${m.selected}`).then(({data:e})=>{const i=e.position.at(-1);i&&(t.position_id=i.position.id),t.table_number=e.table_number,t.name=e.name,t.hiring_date=e.hiring_date,t.gender=e.gender,t.heigth=e.heigth,t.profession=e.profession,t.size_cloth=e.size_cloth,t.size_head=e.size_head,t.size_shoes=e.size_shoes,t.organization_id=e.organization_id})}async function c(){await _.patch(`employe/${m.selected}`,t).then(({data:e})=>{f.dialog=!1,s("editEmploye",e)})}return $(()=>f.dialog,e=>{e&&l()}),r({toggle:()=>f.dialog=!0}),(e,i)=>{const g=d("CustomForm"),z=d("v-dialog");return V(),D(z,{modelValue:f.dialog,"onUpdate:modelValue":i[1]||(i[1]=n=>f.dialog=n),persistent:"",width:"768",location:"right"},{default:u(()=>[a(g,{submitMethod:c,onClose:i[0]||(i[0]=n=>f.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:u(()=>[a(R,{formData:t,pageData:f},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])}}}),T={class:"d-flex flex-column"},S={class:"d-flex justify-space-between items-center"},G={class:"px-4 mb-2"},O=x({__name:"Employes",setup(o){const r=j(),s=k(),m=y({gridApi:null,selected:null});function f(e){m.gridApi.applyTransaction({add:[e],addIndex:0})}function t(e){m.gridApi.getRowNode(e.id).setData(e)}const l=B(),c=y([{field:"table_number",headerName:"Tabel №",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"profession",headerName:"Lavozimi",sortable:!0},{headerName:"Yoriqnoma №",sortable:!0,cellRenderer:e=>{const i=e.data.position.at(-1).position;return`${i.position_type_id} - ${i.number_in_document}`}},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{hide:(r.userRoles.includes(4)||r.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:C,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>l.push({name:"employe",params:{id:e.id}})},{hide:(r.userRoles.includes(4)||r.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:C,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>{m.selected=e.id,s.value.toggle()}}]),b=k([]);return _.get("employe").then(({data:e})=>b.value=e),(e,i)=>{const g=d("Breadcrumbs"),z=d("v-text-field"),n=d("v-col"),N=d("v-row"),U=d("AgGridVue"),A=d("v-spacer");return V(),F("main",T,[E("div",S,[a(g),p(r).userRoles.includes(4)||p(r).userRoles.includes(1)?(V(),D(L,{key:0,onAddEmploye:f})):w("",!0),a(q,{onEditEmploye:t,ref_key:"editComponent",ref:s,current:m},null,8,["current"])]),E("div",G,[a(N,{class:"d-flex justify-end"},{default:u(()=>[a(n,{cols:"3"},{default:u(()=>[a(z,{"prepend-inner-icon":"mdi-magnify",onInput:i[0]||(i[0]=h=>m.gridApi.setQuickFilter(h.target.value)),label:"Qidiruv"})]),_:1})]),_:1})]),a(A,{class:"px-4"},{default:u(()=>[a(U,{defaultColDef:{sortable:!0},class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:h})=>h.id,columnDefs:c,rowData:b.value,onGridReady:i[1]||(i[1]=h=>m.gridApi=h.api),onRowDoubleClicked:i[2]||(i[2]=h=>p(l).push({name:"employe",params:{id:h.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{O as default};
