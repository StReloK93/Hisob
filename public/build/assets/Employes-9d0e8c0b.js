import{d as U,a as n,o as x,c as E,r as C,l as y,m as g,w as u,b as e,p as L,j as S,g as $,n as q,u as T,q as O,h as H,f as M,e as F,i as G}from"./app-eb415e53.js";const I=U({__name:"Icon",props:["params"],setup(h){return(b,v)=>{const s=n("v-btn");return x(),E(s,{color:"teal",icon:h.params.icon,size:"x-small"},null,8,["icon"])}}}),K=U({__name:"AddEmploye",emits:["addEmploye"],setup(h,{emit:b}){const v=C(),s=y({dialog:!1,organizations:null,positions:null,inputLoading:!1,rules:[p=>[null,""].includes(p)?"toldiring":!0]}),t=y({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function m(){const{valid:p}=await v.value.validate();p!=!1&&g.post("employe",t).then(({data:l})=>{s.dialog=!1,b("addEmploye",l)})}function o(){t.table_number.length==5&&(s.inputLoading=!0,z())}function z(){g.get(`employe/getdata/${t.table_number}`).then(({data:p})=>{t.name=p.name,t.organization_id=p.organization_id,setTimeout(()=>s.inputLoading=!1,1e3)}).catch(()=>{s.inputLoading=!1})}return g.all([g.get("accessOrganizations"),g.get("position")]).then(g.spread(({data:p},{data:l})=>{s.organizations=p,s.positions=l})),(p,l)=>{const d=n("v-btn"),a=n("v-card-title"),f=n("v-text-field"),_=n("v-autocomplete"),c=n("v-col"),V=n("v-radio"),w=n("v-radio-group"),k=n("v-row"),N=n("v-container"),R=n("v-card-text"),j=n("FormFooter"),A=n("v-form"),B=n("v-card"),D=n("v-dialog");return x(),E(k,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:u(()=>[e(D,{modelValue:s.dialog,"onUpdate:modelValue":l[13]||(l[13]=i=>s.dialog=i),persistent:"",width:"768",location:"right"},{activator:u(({props:i})=>[e(d,L({icon:"mdi-plus",color:"teal"},i),null,16)]),default:u(()=>[e(B,null,{default:u(()=>[e(A,{ref_key:"form",ref:v,"fast-fail":"",class:"bg-white",onSubmit:S(m,["prevent"]),onVnodeMounted:l[12]||(l[12]=i=>v.value.reset())},{default:u(()=>[e(a,null,{default:u(()=>[$(" Xodim kiritish ")]),_:1}),e(R,{class:"pa-0"},{default:u(()=>[e(N,null,{default:u(()=>[e(k,null,{default:u(()=>[e(c,{cols:"12",class:"pt-0"},{default:u(()=>[e(f,{class:"mb-2",onInput:o,loading:s.inputLoading,rules:s.rules,label:"Tabel raqam",modelValue:t.table_number,"onUpdate:modelValue":l[0]||(l[0]=i=>t.table_number=i),type:"number"},null,8,["loading","rules","modelValue"]),e(f,{class:"mb-2",rules:s.rules,label:"F.I.SH",modelValue:t.name,"onUpdate:modelValue":l[1]||(l[1]=i=>t.name=i)},null,8,["rules","modelValue"]),e(_,{class:"mb-2",items:s.organizations,modelValue:t.organization_id,"onUpdate:modelValue":l[2]||(l[2]=i=>t.organization_id=i),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:s.rules},null,8,["items","modelValue","rules"]),e(_,{class:"mb-2",items:s.positions,modelValue:t.position_id,"onUpdate:modelValue":l[3]||(l[3]=i=>t.position_id=i),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:s.rules,"item-value":"id"},null,8,["items","modelValue","rules"]),e(f,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:t.profession,"onUpdate:modelValue":l[4]||(l[4]=i=>t.profession=i),rules:s.rules},null,8,["modelValue","rules"]),e(f,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:t.hiring_date,"onUpdate:modelValue":l[5]||(l[5]=i=>t.hiring_date=i),type:"date",rules:s.rules},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"6"},{default:u(()=>[e(f,{class:"mb-2",label:"Bo'yi",modelValue:t.heigth,"onUpdate:modelValue":l[6]||(l[6]=i=>t.heigth=i)},null,8,["modelValue"]),e(f,{class:"mb-2",label:"Kiyim o'lchami",modelValue:t.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=i=>t.size_cloth=i)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:u(()=>[e(f,{class:"mb-2",label:"Bosh o'lchami",modelValue:t.size_head,"onUpdate:modelValue":l[8]||(l[8]=i=>t.size_head=i)},null,8,["modelValue"]),e(f,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:t.size_shoes,"onUpdate:modelValue":l[9]||(l[9]=i=>t.size_shoes=i)},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:u(()=>[e(w,{small:"",modelValue:t.gender,"onUpdate:modelValue":l[10]||(l[10]=i=>t.gender=i),rules:s.rules},{default:u(()=>[e(V,{label:"Erkak",value:!0}),e(V,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{onClose:l[11]||(l[11]=i=>s.dialog=!1)})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),P=U({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(h,{expose:b,emit:v}){const{current:s}=h,t=C(),m=y({dialog:!1,organizations:null,positions:null,rules:[d=>d==null||d==""?"toldiring":!0]}),o=y({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function z(){g.get(`employe/${s.selected}`).then(({data:d})=>{const a=d.position.at(-1);a&&(o.position_id=a.position.id),o.table_number=d.table_number,o.name=d.name,o.hiring_date=d.hiring_date,o.gender=d.gender,o.heigth=d.heigth,o.size_cloth=d.size_cloth,o.size_head=d.size_head,o.size_shoes=d.size_shoes,o.organization_id=d.organization_id})}async function p(){const{valid:d}=await t.value.validate();d!=!1&&g.patch(`employe/${s.selected}`,o).then(({data:a})=>{m.dialog=!1,v("editEmploye",a)})}return g.all([g.get("accessOrganizations"),g.get("position")]).then(g.spread(({data:d},{data:a})=>{m.organizations=d,m.positions=a})),q(()=>m.dialog,d=>{d?z():t.value.reset()}),b({toggle:()=>m.dialog=!0}),(d,a)=>{const f=n("v-card-title"),_=n("v-text-field"),c=n("v-autocomplete"),V=n("v-col"),w=n("v-radio"),k=n("v-radio-group"),N=n("v-row"),R=n("v-container"),j=n("v-card-text"),A=n("FormFooter"),B=n("v-form"),D=n("v-card"),i=n("v-dialog");return x(),E(i,{modelValue:m.dialog,"onUpdate:modelValue":a[12]||(a[12]=r=>m.dialog=r),persistent:"",width:"768",location:"right"},{default:u(()=>[e(D,null,{default:u(()=>[e(B,{ref_key:"form",ref:t,class:"bg-white",onSubmit:S(p,["prevent"])},{default:u(()=>[e(f,null,{default:u(()=>[$(" Xodimni tahrirlash ")]),_:1}),e(j,{class:"pa-0"},{default:u(()=>[e(R,null,{default:u(()=>[e(N,null,{default:u(()=>[e(V,{cols:"12",class:"pt-0"},{default:u(()=>[e(_,{class:"mb-2",rules:m.rules,label:"Tabel raqam",modelValue:o.table_number,"onUpdate:modelValue":a[0]||(a[0]=r=>o.table_number=r),type:"number"},null,8,["rules","modelValue"]),e(_,{class:"mb-2",rules:m.rules,label:"F.I.SH",modelValue:o.name,"onUpdate:modelValue":a[1]||(a[1]=r=>o.name=r)},null,8,["rules","modelValue"]),e(c,{class:"mb-2",items:m.organizations,modelValue:o.organization_id,"onUpdate:modelValue":a[2]||(a[2]=r=>o.organization_id=r),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:m.rules},null,8,["items","modelValue","rules"]),e(c,{class:"mb-2",items:m.positions,modelValue:o.position_id,"onUpdate:modelValue":a[3]||(a[3]=r=>o.position_id=r),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:m.rules,"item-value":"id"},null,8,["items","modelValue","rules"]),e(_,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:o.profession,"onUpdate:modelValue":a[4]||(a[4]=r=>o.profession=r),rules:m.rules},null,8,["modelValue","rules"]),e(_,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:o.hiring_date,"onUpdate:modelValue":a[5]||(a[5]=r=>o.hiring_date=r),type:"date",rules:m.rules},null,8,["modelValue","rules"])]),_:1}),e(V,{cols:"6"},{default:u(()=>[e(_,{class:"mb-2",label:"Bo'yi",modelValue:o.heigth,"onUpdate:modelValue":a[6]||(a[6]=r=>o.heigth=r)},null,8,["modelValue"]),e(_,{class:"mb-2",label:"Kiyim o'lchami",modelValue:o.size_cloth,"onUpdate:modelValue":a[7]||(a[7]=r=>o.size_cloth=r)},null,8,["modelValue"])]),_:1}),e(V,{cols:"6"},{default:u(()=>[e(_,{class:"mb-2",label:"Bosh o'lchami",modelValue:o.size_head,"onUpdate:modelValue":a[8]||(a[8]=r=>o.size_head=r)},null,8,["modelValue"]),e(_,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:o.size_shoes,"onUpdate:modelValue":a[9]||(a[9]=r=>o.size_shoes=r)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:u(()=>[e(k,{small:"",modelValue:o.gender,"onUpdate:modelValue":a[10]||(a[10]=r=>o.gender=r),rules:m.rules},{default:u(()=>[e(w,{label:"Erkak",value:!0}),e(w,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{onClose:a[11]||(a[11]=r=>m.dialog=!1)})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}});function X(h){return h?"Erkak":"Ayol"}const J={class:"d-flex flex-column"},W={class:"d-flex justify-space-between items-center"},Y=U({__name:"Employes",setup(h){const b=T(),v=C(),s=y({gridApi:null,selected:null});function t(l){s.gridApi.applyTransaction({add:[l],addIndex:0})}function m(l){s.gridApi.getRowNode(l.id).setData(l)}const o=O(),z=y([{field:"table_number",headerName:"Tabel â„–",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:l=>l.value.at(-1)?l.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:l=>X(l.value),sortable:!0,width:60,headerClass:["px-2"],cellClass:["px-2"]},{field:"heigth",headerName:"Bo'yi (sm)",sortable:!0,width:85,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_head",headerName:"Bosh o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_cloth",headerName:"Kiyim o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_shoes",headerName:"Oyoq kiyim o'lch..",sortable:!0,width:125,headerClass:["px-2"],cellClass:["px-2"]},{hide:(b.userRoles.includes(4)||b.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:I,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:l})=>o.push({name:"employe",params:{id:l.id}})},{hide:(b.userRoles.includes(4)||b.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:I,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:l})=>{s.selected=l.id,v.value.toggle()}}]),p=C([]);return g.get("employe").then(({data:l})=>p.value=l),(l,d)=>{const a=n("Breadcrumbs"),f=n("AgGridVue"),_=n("v-spacer");return x(),H("main",J,[M("div",W,[e(a),F(b).userRoles.includes(4)||F(b).userRoles.includes(1)?(x(),E(K,{key:0,onAddEmploye:t})):G("",!0),e(P,{onEditEmploye:m,ref_key:"editComponent",ref:v,current:s},null,8,["current"])]),e(_,{class:"px-4"},{default:u(()=>[e(f,{class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:c})=>c.id,columnDefs:z,rowData:p.value,onGridReady:d[0]||(d[0]=c=>s.gridApi=c.api),onRowDoubleClicked:d[1]||(d[1]=c=>F(o).push({name:"employe",params:{id:c.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{Y as default};
