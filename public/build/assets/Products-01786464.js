import{d as F,r as D,l as g,m as p,n as k,a as o,o as B,c as T,w as a,b as t,p as I,j as U,g as R,h as S,f as E}from"./app-eb415e53.js";import{B as G}from"./Button-04deac47.js";import{I as M}from"./IconEdit-cefb1ea4.js";const H=F({__name:"AddProduct",emits:["addProduct"],setup(w,{emit:f}){const u=D(),r=g({dialog:!1,products_types:null,products:null,rules:[c=>c==null||c==""?"toldiring":!0]}),l=g({name:null,product_type_id:null,isActive:!0});async function d(){const{valid:c}=await u.value.validate();c!=!1&&p.post("product",l).then(({data:e})=>{r.dialog=!1,f("addProduct",e)})}return p.get("product_type").then(({data:c})=>{r.products_types=c.map(e=>({...e,count:1}))}),p.get("product").then(({data:c})=>{r.products=c.map(e=>e.name)}),k(()=>r.dialog,c=>{c&&(l.name=null,l.product_type_id=null,l.isActive=!0)}),(c,e)=>{const _=o("v-btn"),b=o("v-card-title"),s=o("v-combobox"),n=o("v-autocomplete"),v=o("v-switch"),x=o("v-col"),y=o("v-row"),V=o("v-container"),h=o("v-card-text"),A=o("FormFooter"),C=o("v-form"),N=o("v-card"),P=o("v-dialog");return B(),T(y,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:a(()=>[t(P,{modelValue:r.dialog,"onUpdate:modelValue":e[4]||(e[4]=i=>r.dialog=i),persistent:"",width:"512",location:"right"},{activator:a(({props:i})=>[t(_,I({icon:"mdi-plus"},i),null,16)]),default:a(()=>[t(N,{class:"bg-white"},{default:a(()=>[t(C,{ref_key:"formTag",ref:u,onSubmit:U(d,["prevent"])},{default:a(()=>[t(b,null,{default:a(()=>[R(" Mahsulot kiritish ")]),_:1}),t(h,{class:"pa-0"},{default:a(()=>[t(V,null,{default:a(()=>[t(y,null,{default:a(()=>[t(x,{cols:"12",class:"pt-0"},{default:a(()=>[t(s,{class:"mb-2",label:"Nomi",modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=i=>l.name=i),items:r.products,rules:r.rules},null,8,["modelValue","items","rules"]),t(n,{class:"mb-2",label:"Turi",modelValue:l.product_type_id,"onUpdate:modelValue":e[1]||(e[1]=i=>l.product_type_id=i),items:r.products_types,rules:r.rules,"item-title":"name","item-value":i=>i.id},null,8,["modelValue","items","rules","item-value"]),t(v,{label:"Faolligi",modelValue:l.isActive,"onUpdate:modelValue":e[2]||(e[2]=i=>l.isActive=i)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(A,{onClose:e[3]||(e[3]=i=>r.dialog=!1)})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),K=F({__name:"EditProduct",props:["current"],emits:["editProduct"],setup(w,{expose:f,emit:u}){const{current:r}=w,l=g({dialog:!1,products_types:null,products:null,rules:[s=>s==null||s==""?"toldiring":!0]}),d=g({name:null,product_type_id:null,isActive:!0});p.get("product_type").then(({data:s})=>{l.products_types=s});function c(){p.patch(`product/${r.selected}`,d).then(({data:s})=>{l.dialog=!1,u("editProduct",s)})}p.get("product").then(({data:s})=>{l.products=s.map(n=>n.name)});function e(s){p.get(`product/${s}`).then(({data:n})=>{d.name=n.name,d.product_type_id=n.product_type_id,d.isActive=!!n.isActive})}function _(){d.name=null,d.product_type_id=null,d.isActive=!0}return k(()=>l.dialog,s=>{s?e(r.selected):_()}),f({toggle:()=>l.dialog=!0}),(s,n)=>{const v=o("v-card-title"),x=o("v-combobox"),y=o("v-autocomplete"),V=o("v-switch"),h=o("v-col"),A=o("v-row"),C=o("v-container"),N=o("v-card-text"),P=o("FormFooter"),i=o("v-form"),$=o("v-card"),j=o("v-dialog");return B(),T(j,{modelValue:l.dialog,"onUpdate:modelValue":n[4]||(n[4]=m=>l.dialog=m),persistent:"",width:"512",location:"right"},{default:a(()=>[t($,{class:"bg-white"},{default:a(()=>[t(i,{ref:"formTag",onSubmit:U(c,["prevent"])},{default:a(()=>[t(v,null,{default:a(()=>[R(" Mahsulotni tahrirlash ")]),_:1}),t(N,{class:"pa-0"},{default:a(()=>[t(C,null,{default:a(()=>[t(A,null,{default:a(()=>[t(h,{cols:"12",class:"pt-0"},{default:a(()=>[t(x,{class:"mb-2",label:"Nomi",modelValue:d.name,"onUpdate:modelValue":n[0]||(n[0]=m=>d.name=m),items:l.products,rules:l.rules},null,8,["modelValue","items","rules"]),t(y,{class:"mb-2",label:"Turi",modelValue:d.product_type_id,"onUpdate:modelValue":n[1]||(n[1]=m=>d.product_type_id=m),items:l.products_types,rules:l.rules,"item-title":"name","item-value":m=>m.id},null,8,["modelValue","items","rules","item-value"]),t(V,{label:"Faolligi",modelValue:d.isActive,"onUpdate:modelValue":n[2]||(n[2]=m=>d.isActive=m)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(P,{onClose:n[3]||(n[3]=m=>l.dialog=!1)})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}}),q={class:"d-flex flex-column"},z={class:"d-flex justify-space-between items-center"},Q=F({__name:"Products",setup(w){const f=D(),u=g({selected:null,gridApi:null});function r(e){u.gridApi.applyTransaction({add:[e],addIndex:0})}function l(e){u.gridApi.getRowNode(e.id).setData(e)}const d=g([{field:"id",headerName:"Kod",width:80},{field:"name",headerName:"Nomi",flex:1},{field:"product_type.name",headerName:"Turi"},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:G,width:60,headerClass:["px-2"],onCellClicked:e=>{p.post(`product/set_activate/${e.data.id}`,{active:!e.value}).then(()=>{e.node.setDataValue("isActive",!e.value)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:M,headerClass:["px-2"],onCellClicked:({data:e})=>{u.selected=e.id,f.value.toggle()}}]),c=D([]);return p.get("product").then(({data:e})=>c.value=e),(e,_)=>{const b=o("Breadcrumbs"),s=o("AgGridVue"),n=o("v-spacer");return B(),S("section",q,[E("div",z,[t(b),t(H,{onAddProduct:r}),t(K,{onEditProduct:l,ref_key:"editComponent",ref:f,current:u},null,8,["current"])]),t(n,{class:"px-4"},{default:a(()=>[t(s,{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:v})=>v.id,columnDefs:d,rowData:c.value,onGridReady:_[0]||(_[0]=v=>u.gridApi=v.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{Q as default};
