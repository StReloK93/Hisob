import{I as T}from"./IconEdit-0a8d414e.js";import{d as z,a as l,o as b,h as $,F as q,k as G,c as A,w as t,f as w,t as O,r as B,l as x,m as I,b as e,n as X,j as F,e as S,p as v,g as Y}from"./app-2de8305d.js";import{_ as H,A as M}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-26705092.js";const P=z({__name:"UserRoles",props:["params"],setup(h){return(f,r)=>{const m=l("v-chip");return b(),$("main",null,[(b(!0),$(q,null,G(h.params.value,o=>(b(),A(m,{size:"small",label:"",key:o,class:"mx-1"},{default:t(()=>[w(O(o.role.name),1)]),_:2},1024))),128))])}}}),J=S("span",null,"Xodim kiritish",-1),K=z({__name:"AddUser",emits:["addUser"],setup(h,{emit:f}){function r(){}const m=B(),o=x({dialog:!1,organizations:null,positions:null,inputLoading:!1,rules:[a=>a==null||a==""?"toldiring":!0]}),c=x({name:null,login:null,organizations:[]});function d(){c.name=null,c.login=null,c.organizations=[]}return I(()=>o.dialog,a=>{a&&d()}),(a,u)=>{const _=l("v-btn"),s=l("v-card-title"),n=l("v-text-field"),k=l("v-col"),V=l("v-row"),g=l("v-container"),U=l("v-card-text"),N=l("v-spacer"),C=l("v-card-actions"),D=l("v-form"),R=l("v-card"),y=l("v-dialog");return b(),A(V,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:t(()=>[e(y,{modelValue:o.dialog,"onUpdate:modelValue":u[2]||(u[2]=p=>o.dialog=p),persistent:"",width:"512",location:"right"},{activator:t(({props:p})=>[e(_,X({icon:"mdi-plus",color:"teal"},p),null,16)]),default:t(()=>[e(R,null,{default:t(()=>[e(D,{ref_key:"formTag",ref:m,"fast-fail":"",class:"bg-white",onSubmit:F(r,["prevent"])},{default:t(()=>[e(s,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[J]),_:1}),e(U,{class:"pa-0"},{default:t(()=>[e(g,null,{default:t(()=>[e(V,null,{default:t(()=>[e(k,{cols:"12",class:"pt-0"},{default:t(()=>[e(n,{loading:o.inputLoading,color:"teal",rules:o.rules,label:"F.I.O",variant:"underlined","hide-details":"auto",modelValue:c.name,"onUpdate:modelValue":u[0]||(u[0]=p=>c.name=p),type:"number"},null,8,["loading","rules","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(N),e(_,{color:"blue-gray-1",variant:"text",type:"button",onClick:u[1]||(u[1]=p=>o.dialog=!1)},{default:t(()=>[w(" Yopish ")]),_:1}),e(_,{color:"teal",variant:"text",type:"submit"},{default:t(()=>[w(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Q=S("span",null,"Xodim ma'lumotlarini o'zgartirish",-1),W=z({__name:"EditUser",props:["selected"],emits:["editUser"],setup(h,{expose:f,emit:r}){const{selected:m}=h,o=x({name:null,login:null,organizations:[],roles:[]});function c(){const s=m.user;o.login=s.login,o.name=s.name,o.organizations=s.organizations.map(n=>n.organizations_id),o.roles=s.roles.map(n=>n.role_id)}function d(){v.put(`users/${m.user.id}`,o).then(({data:s})=>{a.dialog=!1,r("editUser",s)})}const a=x({rules:[s=>s==null||s==""?"toldiring":!0],dialog:!1,organizations:[],roles:[]});v.all([v.get("organization"),v.get("role")]).then(v.spread(({data:s},{data:n})=>{a.organizations=s,a.roles=n}));function u(){o.name=null,o.login=null,o.organizations=[]}return f({toggle:()=>a.dialog=!0}),I(()=>a.dialog,s=>{s?c():u()}),(s,n)=>{const k=l("v-card-title"),V=l("v-text-field"),g=l("v-col"),U=l("v-autocomplete"),N=l("v-row"),C=l("v-container"),D=l("v-card-text"),R=l("v-spacer"),y=l("v-btn"),p=l("v-card-actions"),L=l("v-form"),j=l("v-card"),E=l("v-dialog");return b(),A(E,{modelValue:a.dialog,"onUpdate:modelValue":n[5]||(n[5]=i=>a.dialog=i),persistent:"",width:"512",location:"right"},{default:t(()=>[e(j,null,{default:t(()=>[e(L,{ref:"form",class:"bg-white",onSubmit:F(d,["prevent"])},{default:t(()=>[e(k,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[Q]),_:1}),e(D,{class:"pa-0"},{default:t(()=>[e(C,null,{default:t(()=>[e(N,null,{default:t(()=>[e(g,{cols:"12",class:"pt-0"},{default:t(()=>[e(V,{color:"teal",label:"Login",variant:"underlined",disabled:"","hide-details":"auto",modelValue:o.login,"onUpdate:modelValue":n[0]||(n[0]=i=>o.login=i)},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:t(()=>[e(V,{color:"teal",label:"F.I.O",variant:"underlined","hide-details":"auto",modelValue:o.name,"onUpdate:modelValue":n[1]||(n[1]=i=>o.name=i),rules:a.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:t(()=>[e(U,{color:"teal",variant:"underlined",label:"Bo'linmalar",modelValue:o.organizations,"onUpdate:modelValue":n[2]||(n[2]=i=>o.organizations=i),items:a.organizations,"item-title":"short_name","item-value":i=>i.id,multiple:"",chips:""},null,8,["modelValue","items","item-value"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:t(()=>[e(U,{color:"teal",variant:"underlined",label:"Bo'linmalar",modelValue:o.roles,"onUpdate:modelValue":n[3]||(n[3]=i=>o.roles=i),items:a.roles,"item-title":"name","item-value":i=>i.id,multiple:"",chips:""},null,8,["modelValue","items","item-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(R),e(y,{color:"blue-gray-1",type:"button",onClick:n[4]||(n[4]=i=>a.dialog=!1)},{default:t(()=>[w(" Yopish ")]),_:1}),e(y,{color:"blue-darken-1",type:"submit"},{default:t(()=>[w(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}}),Z={class:"d-flex flex-column"},ee={class:"d-flex justify-space-between items-center"},ae=z({__name:"Users",setup(h){const f=B(),r=x({gridApi:null,users:[],user:null});function m(){}function o(d){r.gridApi.getRowNode(d.id).setData(d)}const c=x([{field:"id",headerName:"â„–",width:65},{field:"login",headerName:"Login"},{field:"name",headerName:"Nomi",flex:1},{field:"roles",headerName:"Rollari",flex:1,cellRenderer:P,valueFormatter:null},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:T,headerClass:["px-2"],onCellClicked:({data:d})=>{r.user=d,f.value.toggle()}}]);return v.get("users").then(({data:d})=>r.users=d),(d,a)=>{const u=l("v-spacer");return b(),$("section",Z,[S("div",ee,[e(H),e(K,{onAddUser:m}),e(W,{onEditUser:o,ref_key:"editUserComp",ref:f,selected:r},null,8,["selected"])]),e(u,{class:"px-4"},{default:t(()=>[e(Y(M),{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:_})=>_.id,columnDefs:c,rowData:r.users,onGridReady:a[0]||(a[0]=_=>r.gridApi=_.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ae as default};
