import{d as C,l as g,a as r,o as f,c as w,w as a,e as l,s as q,v as z,f as y,t as k,x as P,g as U,m as v,u as I,r as A,y as N,h as V,b as F,n as S,F as $,k as T,z as Y}from"./app-1e7dc77b.js";import{r as j}from"./helpers-ca74a7fa.js";import{s as D}from"./swal-fb5a2260.js";import{_ as R}from"./Icon.vue_vue_type_script_setup_true_lang-1ce7e81b.js";const E=C({__name:"AddMonthReport",props:["report"],emits:["addReport"],setup(c,{emit:u}){const{report:m}=c,i=g({name:null,report_type_id:m.id,old:!0});async function n(){await v.post("report",i).then(({data:t})=>{u("addReport",{report_type_id:m.id,report:t,old:!0}),o.dialog=!1})}const o=g({dialog:!1,products:null});return(t,e)=>{const s=r("v-list-item"),p=r("v-text-field"),b=r("v-col"),x=r("v-row"),h=r("v-dialog");return f(),w(h,{modelValue:o.dialog,"onUpdate:modelValue":e[2]||(e[2]=d=>o.dialog=d),persistent:"",width:"600",location:"right"},{activator:a(({props:d})=>[l(s,q(z(d)),{default:a(()=>[y(k(c.report.name),1)]),_:2},1040)]),default:a(()=>[l(P,{submitMethod:n,onClose:e[1]||(e[1]=d=>o.dialog=!1),title:c.report.name},{default:a(()=>[l(x,null,{default:a(()=>[l(b,{cols:"12",class:"pt-3"},{default:a(()=>[l(p,{rules:U(j),modelValue:i.name,"onUpdate:modelValue":e[0]||(e[0]=d=>i.name=d),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),L=C({__name:"AddMonth",props:["report"],emits:["addReport"],setup(c,{emit:u}){const{report:m}=c,i=g({name:null,report_type_id:m.id,old:!1});async function n(){await v.post("report",i).then(({data:t})=>{u("addReport",{report_type_id:m.id,report:t,old:!0}),o.dialog=!1})}const o=g({dialog:!1,products:null});return(t,e)=>{const s=r("v-list-item"),p=r("v-text-field"),b=r("v-col"),x=r("v-row"),h=r("v-dialog");return f(),w(h,{modelValue:o.dialog,"onUpdate:modelValue":e[2]||(e[2]=d=>o.dialog=d),persistent:"",width:"600",location:"right"},{activator:a(({props:d})=>[l(s,q(z(d)),{default:a(()=>[y(k(c.report.name),1)]),_:2},1040)]),default:a(()=>[l(P,{submitMethod:n,onClose:e[1]||(e[1]=d=>o.dialog=!1),title:c.report.name},{default:a(()=>[l(x,null,{default:a(()=>[l(b,{cols:"12",class:"pt-3"},{default:a(()=>[l(p,{rules:U(j),modelValue:i.name,"onUpdate:modelValue":e[0]||(e[0]=d=>i.name=d),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),O=C({__name:"OldReportTable",props:["report_id"],setup(c,{expose:u}){const{report_id:m}=c,i=I(),n=g({gridApi:null,reports:[]}),o=g([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:t})=>{window.open(`/storage/${t.file_source}`,"_blank")}},{hide:i.userRoles.includes(2),cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:R,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:t,node:e})=>{t.confirmed||D.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(s=>{s.isConfirmed&&v.get(`report_success/${t.id}`).then(({data:p})=>{e.setData(p)})})}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:t})=>{t.confirmed||D.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(e=>{e.isConfirmed&&v.delete(`report/${t.id}`).then(()=>{n.gridApi.applyTransaction({remove:[t]})})})}}]);return v.get(`report_type/${m}`).then(({data:t})=>{n.reports=t}),u({pageData:n}),(t,e)=>{const s=r("AgGridVue");return f(),w(s,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:p})=>p.id,columnDefs:o,rowData:n.reports,onGridReady:e[0]||(e[0]=p=>n.gridApi=p.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),J=C({__name:"CurrentReportTable",props:["report_id"],setup(c,{expose:u}){const{report_id:m}=c,i=g({gridApi:null,reports:[]}),n=g([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:o})=>{window.open(`/storage/${o.file_source}`,"_blank")}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:R,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},onCellClicked:({data:o})=>{D.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&v.delete(`report/${o.id}`).then(()=>{i.gridApi.applyTransaction({remove:[o]})})})}}]);return v.get(`report_type/${m}`).then(({data:o})=>{i.reports=o}),u({pageData:i}),(o,t)=>{const e=r("AgGridVue");return f(),w(e,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:s})=>s.id,columnDefs:n,rowData:i.reports,onGridReady:t[0]||(t[0]=s=>i.gridApi=s.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),K={class:"d-flex flex-column"},ee=C({__name:"Reports",setup(c){const u=A(),m=A();function i(o){o.report_type_id==1?(n.tab=0,u.value.pageData.gridApi.applyTransaction({add:[o.report]})):o.report_type_id==2&&(n.tab=1,m.value.pageData.gridApi.applyTransaction({add:[o.report]}))}v.get("report_type").then(({data:o})=>{const t=o.map(e=>(e.id==1&&(e.component=N(E)),e.id==2&&(e.component=N(L)),e));n.report_types=t});const n=g({tab:0,report_types:[]});return(o,t)=>{const e=r("v-btn"),s=r("v-list"),p=r("v-menu"),b=r("v-tab"),x=r("v-tabs"),h=r("v-window-item"),d=r("v-window"),B=r("v-card-text"),G=r("v-card"),H=r("v-spacer");return f(),V("section",K,[l(p,null,{activator:a(({props:_})=>[F("div",null,[l(e,S({"prepend-icon":"mdi-microsoft-excel",class:"text-capitalize",color:"blue-grey",variant:"tonal"},_),{default:a(()=>[y(" Hisobotlar ")]),_:2},1040),l(e,{"prepend-icon":"mdi-microsoft-excel",class:"text-capitalize ml-4",color:"blue-grey",variant:"tonal"},{default:a(()=>[y(" Harakat ")]),_:1})])]),default:a(()=>[l(s,{class:"py-1"},{default:a(()=>[(f(!0),V($,null,T(n.report_types,_=>(f(),V("div",null,[(f(),w(Y(_.component),{onAddReport:i,report:_},null,40,["report"]))]))),256))]),_:1})]),_:1}),l(H,{class:"mt-4"},{default:a(()=>[l(G,{class:"h-100 d-flex flex-column"},{default:a(()=>[l(x,{modelValue:n.tab,"onUpdate:modelValue":t[0]||(t[0]=_=>n.tab=_)},{default:a(()=>[(f(!0),V($,null,T(n.report_types,(_,M)=>(f(),w(b,{value:M,class:"text-capitalize"},{default:a(()=>[y(k(_.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),l(B,{class:"flex-grow-1"},{default:a(()=>[l(d,{modelValue:n.tab,"onUpdate:modelValue":t[1]||(t[1]=_=>n.tab=_),class:"h-100"},{default:a(()=>[l(h,{value:"one",class:"h-100"},{default:a(()=>[l(O,{ref_key:"oldTable",ref:u,report_id:1},null,512)]),_:1}),l(h,{value:"two",class:"h-100"},{default:a(()=>[l(J,{ref_key:"currentTable",ref:m,report_id:2},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}});export{ee as default};
