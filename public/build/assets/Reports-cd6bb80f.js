import{d as V,m as h,b as r,o as g,c as y,w as o,f as l,v as G,x as H,g as D,t as M,y as j,h as C,n as v,p as I,a as z,r as q,z as P,i as N,e as F,j as T,F as U,l as B,A as S}from"./app-aaa2841a.js";import{r as k}from"./helpers-ca74a7fa.js";import{s as A}from"./swal-049c190b.js";import{_ as b}from"./Icon.vue_vue_type_script_setup_true_lang-a0419ab8.js";const J=V({__name:"AddMonthReport",props:["report"],emits:["addReport"],setup(p,{emit:f}){const{report:m}=p,n=h({name:null,report_type_id:m.id,old:!0});async function d(){await v.post("report",n).then(({data:e})=>{f("addReport",{report_type_id:m.id,report:e,old:!0}),s.dialog=!1})}const s=h({dialog:!1,products:null});return(e,t)=>{const i=r("v-list-item"),a=r("v-text-field"),c=r("v-col"),x=r("v-row"),R=r("v-dialog");return g(),y(R,{modelValue:s.dialog,"onUpdate:modelValue":t[2]||(t[2]=u=>s.dialog=u),persistent:"",width:"600",location:"right"},{activator:o(({props:u})=>[l(i,G(H(u)),{default:o(()=>[D(M(p.report.name),1)]),_:2},1040)]),default:o(()=>[l(j,{submitMethod:d,onClose:t[1]||(t[1]=u=>s.dialog=!1),title:p.report.name},{default:o(()=>[l(x,null,{default:o(()=>[l(c,{cols:"12",class:"pt-3"},{default:o(()=>[l(a,{rules:C(k),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=u=>n.name=u),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),K=V({__name:"AddMonth",props:["report"],emits:["addReport"],setup(p,{emit:f}){const{report:m}=p,n=h({name:null,report_type_id:m.id,old:!1});async function d(){await v.post("report",n).then(({data:e})=>{f("addReport",{report_type_id:m.id,report:e,old:!0}),s.dialog=!1})}const s=h({dialog:!1,products:null});return(e,t)=>{const i=r("v-list-item"),a=r("v-text-field"),c=r("v-col"),x=r("v-row"),R=r("v-dialog");return g(),y(R,{modelValue:s.dialog,"onUpdate:modelValue":t[2]||(t[2]=u=>s.dialog=u),persistent:"",width:"600",location:"right"},{activator:o(({props:u})=>[l(i,G(H(u)),{default:o(()=>[D(M(p.report.name),1)]),_:2},1040)]),default:o(()=>[l(j,{submitMethod:d,onClose:t[1]||(t[1]=u=>s.dialog=!1),title:p.report.name},{default:o(()=>[l(x,null,{default:o(()=>[l(c,{cols:"12",class:"pt-3"},{default:o(()=>[l(a,{rules:C(k),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=u=>n.name=u),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),Q=V({__name:"Movement",props:["report"],emits:["addMovement"],setup(p,{emit:f}){const{report:m}=p,n=h({name:null,start:null,end:null,products:[],report_type_id:m.id});async function d(){await v.post("report",n).then(({data:e})=>{f("addMovement",{report_type_id:m.id,report:e,old:!0}),s.dialog=!1})}const s=h({dialog:!1,products:null});return v.get("product").then(({data:e})=>{s.products=e}),(e,t)=>{const i=r("v-btn"),a=r("v-text-field"),c=r("v-col"),x=r("v-autocomplete"),R=r("v-row"),u=r("v-dialog");return g(),y(u,{modelValue:s.dialog,"onUpdate:modelValue":t[5]||(t[5]=_=>s.dialog=_),persistent:"",width:"600",location:"right"},{activator:o(({props:_})=>[l(i,I({"prepend-icon":"mdi-timeline-clock-outline",class:"text-capitalize ml-4",variant:"tonal"},_),{default:o(()=>[D(" Harakat ")]),_:2},1040)]),default:o(()=>[l(j,{submitMethod:d,onClose:t[4]||(t[4]=_=>s.dialog=!1),title:"Belgilangan vaqtda muddati o'tadiganlar"},{default:o(()=>[l(R,null,{default:o(()=>[l(c,null,{default:o(()=>[l(a,{rules:C(k),modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=_=>n.name=_),label:"Nomi"},null,8,["rules","modelValue"])]),_:1}),l(c,{cols:"12",class:"pt-3"},{default:o(()=>[l(x,{rules:C(k),items:s.products,modelValue:n.products,"onUpdate:modelValue":t[1]||(t[1]=_=>n.products=_),label:"Himoya vositalari","item-title":"name","item-value":_=>_,multiple:""},null,8,["rules","items","modelValue","item-value"])]),_:1}),l(c,null,{default:o(()=>[l(a,{rules:C(k),type:"date",modelValue:n.start,"onUpdate:modelValue":t[2]||(t[2]=_=>n.start=_),label:"Dan"},null,8,["rules","modelValue"])]),_:1}),l(c,null,{default:o(()=>[l(a,{rules:C(k),type:"date",modelValue:n.end,"onUpdate:modelValue":t[3]||(t[3]=_=>n.end=_),label:"Gacha"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),W=V({__name:"MovementTable",props:["report_id"],setup(p,{expose:f}){const{report_id:m}=p,n=z(),d=h({gridApi:null,reports:[]}),s=h([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{hide:n.userRoles.includes(2),cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:b,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:e,node:t})=>{e.confirmed||A.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(i=>{i.isConfirmed&&v.get(`report_success/${e.id}`).then(({data:a})=>{t.setData(a)})})}},{hide:n.userRoles.includes(3)==!1||n.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:e})=>{e.confirmed||A.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&v.delete(`report/${e.id}`).then(()=>{d.gridApi.applyTransaction({remove:[e]})})})}}]);return v.get(`report_type/${m}`).then(({data:e})=>{d.reports=e}),f({pageData:d}),(e,t)=>{const i=r("AgGridVue");return g(),y(i,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:s,rowData:d.reports,onGridReady:t[0]||(t[0]=a=>d.gridApi=a.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),X=V({__name:"OldReportTable",props:["report_id"],setup(p,{expose:f}){const{report_id:m}=p,n=z(),d=h({gridApi:null,reports:[]}),s=h([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{hide:n.userRoles.includes(3)==!1,cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:b,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:e,node:t})=>{e.confirmed||A.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(i=>{i.isConfirmed&&v.get(`report_success/${e.id}`).then(({data:a})=>{t.setData(a)})})}},{hide:n.userRoles.includes(3)==!1||n.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:e})=>{e.confirmed||A.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&v.delete(`report/${e.id}`).then(()=>{d.gridApi.applyTransaction({remove:[e]})})})}}]);return v.get(`report_type/${m}`).then(({data:e})=>{d.reports=e}),f({pageData:d}),(e,t)=>{const i=r("AgGridVue");return g(),y(i,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:s,rowData:d.reports,onGridReady:t[0]||(t[0]=a=>d.gridApi=a.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),Z=V({__name:"CurrentReportTable",props:["report_id"],setup(p,{expose:f}){const{report_id:m}=p,n=z(),d=h({gridApi:null,reports:[]}),s=h([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{hide:n.userRoles.includes(3)==!1||n.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},onCellClicked:({data:e})=>{A.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&v.delete(`report/${e.id}`).then(()=>{d.gridApi.applyTransaction({remove:[e]})})})}}]);return v.get(`report_type/${m}`).then(({data:e})=>{d.reports=e}),f({pageData:d}),(e,t)=>{const i=r("AgGridVue");return g(),y(i,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:s,rowData:d.reports,onGridReady:t[0]||(t[0]=a=>d.gridApi=a.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),ee={class:"d-flex flex-column"},re=V({__name:"Reports",setup(p){const f=q(),m=q(),n=q();function d(i){n.value.pageData.gridApi.applyTransaction({add:[i.report]}),e.tab=2}function s(i){i.report_type_id==1?(e.tab=0,f.value.pageData.gridApi.applyTransaction({add:[i.report]})):i.report_type_id==2&&(e.tab=1,m.value.pageData.gridApi.applyTransaction({add:[i.report]}))}v.get("report_type").then(({data:i})=>{const a=i.map(c=>(c.id==1&&(c.component=P(J)),c.id==2&&(c.component=P(K)),c));e.report_types=a});const e=h({tab:0,report_types:[]});function t(){v.get("umumiy/employes",{responseType:"blob"}).then(i=>{const a=window.URL.createObjectURL(new Blob([i.data])),c=document.createElement("a");c.href=a,c.setAttribute("download","umumiy.xlsx"),document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(a),document.body.removeChild(c)})}return(i,a)=>{const c=r("v-btn"),x=r("v-list"),R=r("v-menu"),u=r("v-tab"),_=r("v-tabs"),$=r("v-window-item"),L=r("v-window"),E=r("v-card-text"),O=r("v-card"),Y=r("v-spacer");return g(),N("section",ee,[l(R,null,{activator:o(({props:w})=>[F("div",null,[l(c,I({"append-icon":"mdi-chevron-down",class:"text-capitalize",color:"blue-grey",variant:"tonal"},w),{default:o(()=>[D(" Hisobotlar ")]),_:2},1040),e.report_types.length?(g(),y(Q,{key:0,onAddMovement:d,report:e.report_types[2]},null,8,["report"])):T("",!0),l(c,{onClick:t,"prepend-icon":"mdi-book-account",class:"text-capitalize ml-4",variant:"tonal"},{default:o(()=>[D(" Umumiy malumotlar ")]),_:1})])]),default:o(()=>[l(x,{class:"py-1"},{default:o(()=>[(g(!0),N(U,null,B(e.report_types,w=>(g(),N("div",null,[w.id!=3?(g(),y(S(w.component),{key:0,onAddReport:s,report:w},null,40,["report"])):T("",!0)]))),256))]),_:1})]),_:1}),l(Y,{class:"mt-4"},{default:o(()=>[l(O,{class:"h-100 d-flex flex-column"},{default:o(()=>[l(_,{modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=w=>e.tab=w)},{default:o(()=>[(g(!0),N(U,null,B(e.report_types,(w,te)=>(g(),N(U,null,[w.id!=4?(g(),y(u,{key:0,class:"text-capitalize"},{default:o(()=>[D(M(w.name),1)]),_:2},1024)):T("",!0)],64))),256))]),_:1},8,["modelValue"]),l(E,{class:"flex-grow-1"},{default:o(()=>[l(L,{modelValue:e.tab,"onUpdate:modelValue":a[1]||(a[1]=w=>e.tab=w),class:"h-100"},{default:o(()=>[l($,{class:"h-100"},{default:o(()=>[l(X,{ref_key:"oldTable",ref:f,report_id:1},null,512)]),_:1}),l($,{class:"h-100"},{default:o(()=>[l(Z,{ref_key:"currentTable",ref:m,report_id:2},null,512)]),_:1}),l($,{class:"h-100"},{default:o(()=>[l(W,{ref_key:"movementTable",ref:n,report_id:3},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}});export{re as default};
