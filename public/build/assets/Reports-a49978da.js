import{d as V,l as h,a as d,o as v,c as y,w as l,e as o,s as B,v as G,f as D,t as T,x as U,g as C,m as g,n as H,u as I,r as q,y as M,h as A,b as S,i as j,F as z,k as P,z as J}from"./app-181ef7cc.js";import{r as k}from"./helpers-ca74a7fa.js";import{s as N}from"./swal-2cabbcbe.js";import{_ as b}from"./Icon.vue_vue_type_script_setup_true_lang-e702baad.js";const K=V({__name:"AddMonthReport",props:["report"],emits:["addReport"],setup(p,{emit:f}){const{report:m}=p,a=h({name:null,report_type_id:m.id,old:!0});async function c(){await g.post("report",a).then(({data:e})=>{f("addReport",{report_type_id:m.id,report:e,old:!0}),n.dialog=!1})}const n=h({dialog:!1,products:null});return(e,t)=>{const r=d("v-list-item"),i=d("v-text-field"),s=d("v-col"),x=d("v-row"),R=d("v-dialog");return v(),y(R,{modelValue:n.dialog,"onUpdate:modelValue":t[2]||(t[2]=u=>n.dialog=u),persistent:"",width:"600",location:"right"},{activator:l(({props:u})=>[o(r,B(G(u)),{default:l(()=>[D(T(p.report.name),1)]),_:2},1040)]),default:l(()=>[o(U,{submitMethod:c,onClose:t[1]||(t[1]=u=>n.dialog=!1),title:p.report.name},{default:l(()=>[o(x,null,{default:l(()=>[o(s,{cols:"12",class:"pt-3"},{default:l(()=>[o(i,{rules:C(k),modelValue:a.name,"onUpdate:modelValue":t[0]||(t[0]=u=>a.name=u),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),Q=V({__name:"AddMonth",props:["report"],emits:["addReport"],setup(p,{emit:f}){const{report:m}=p,a=h({name:null,report_type_id:m.id,old:!1});async function c(){await g.post("report",a).then(({data:e})=>{f("addReport",{report_type_id:m.id,report:e,old:!0}),n.dialog=!1})}const n=h({dialog:!1,products:null});return(e,t)=>{const r=d("v-list-item"),i=d("v-text-field"),s=d("v-col"),x=d("v-row"),R=d("v-dialog");return v(),y(R,{modelValue:n.dialog,"onUpdate:modelValue":t[2]||(t[2]=u=>n.dialog=u),persistent:"",width:"600",location:"right"},{activator:l(({props:u})=>[o(r,B(G(u)),{default:l(()=>[D(T(p.report.name),1)]),_:2},1040)]),default:l(()=>[o(U,{submitMethod:c,onClose:t[1]||(t[1]=u=>n.dialog=!1),title:p.report.name},{default:l(()=>[o(x,null,{default:l(()=>[o(s,{cols:"12",class:"pt-3"},{default:l(()=>[o(i,{rules:C(k),modelValue:a.name,"onUpdate:modelValue":t[0]||(t[0]=u=>a.name=u),label:"Hisobot nomi"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),W=V({__name:"Movement",props:["report"],emits:["addMovement"],setup(p,{emit:f}){const{report:m}=p,a=h({name:null,start:null,end:null,products:[],report_type_id:m.id});async function c(){await g.post("report",a).then(({data:e})=>{f("addMovement",{report_type_id:m.id,report:e,old:!0}),n.dialog=!1})}const n=h({dialog:!1,products:null});return g.get("product").then(({data:e})=>{n.products=e}),(e,t)=>{const r=d("v-btn"),i=d("v-text-field"),s=d("v-col"),x=d("v-autocomplete"),R=d("v-row"),u=d("v-dialog");return v(),y(u,{modelValue:n.dialog,"onUpdate:modelValue":t[5]||(t[5]=_=>n.dialog=_),persistent:"",width:"600",location:"right"},{activator:l(({props:_})=>[o(r,H({"prepend-icon":"mdi-timeline-clock-outline",class:"text-capitalize ml-4",variant:"tonal"},_),{default:l(()=>[D(" Harakat ")]),_:2},1040)]),default:l(()=>[o(U,{submitMethod:c,onClose:t[4]||(t[4]=_=>n.dialog=!1),title:"Belgilangan vaqtda muddati o'tadiganlar"},{default:l(()=>[o(R,null,{default:l(()=>[o(s,null,{default:l(()=>[o(i,{rules:C(k),modelValue:a.name,"onUpdate:modelValue":t[0]||(t[0]=_=>a.name=_),label:"Nomi"},null,8,["rules","modelValue"])]),_:1}),o(s,{cols:"12",class:"pt-3"},{default:l(()=>[o(x,{rules:C(k),items:n.products,modelValue:a.products,"onUpdate:modelValue":t[1]||(t[1]=_=>a.products=_),label:"Himoya vositalari","item-title":"name","item-value":_=>_,multiple:""},null,8,["rules","items","modelValue","item-value"])]),_:1}),o(s,null,{default:l(()=>[o(i,{rules:C(k),type:"date",modelValue:a.start,"onUpdate:modelValue":t[2]||(t[2]=_=>a.start=_),label:"Dan"},null,8,["rules","modelValue"])]),_:1}),o(s,null,{default:l(()=>[o(i,{rules:C(k),type:"date",modelValue:a.end,"onUpdate:modelValue":t[3]||(t[3]=_=>a.end=_),label:"Gacha"},null,8,["rules","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),X=V({__name:"MovementTable",props:["report_id"],setup(p,{expose:f}){const{report_id:m}=p,a=I(),c=h({gridApi:null,reports:[]}),n=h([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{hide:a.userRoles.includes(2),cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:b,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:e,node:t})=>{e.confirmed||N.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(r=>{r.isConfirmed&&g.get(`report_success/${e.id}`).then(({data:i})=>{t.setData(i)})})}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:e})=>{e.confirmed||N.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{c.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${m}`).then(({data:e})=>{c.reports=e}),f({pageData:c}),(e,t)=>{const r=d("AgGridVue");return v(),y(r,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:i})=>i.id,columnDefs:n,rowData:c.reports,onGridReady:t[0]||(t[0]=i=>c.gridApi=i.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),Z=V({__name:"OldReportTable",props:["report_id"],setup(p,{expose:f}){const{report_id:m}=p,a=I(),c=h({gridApi:null,reports:[]}),n=h([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:e})=>{window.open(`/storage/${e.file_source}`,"_blank")}},{hide:a.userRoles.includes(2),cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"Tasdiqlash",width:90,cellRenderer:b,cellRendererParams:{icon:"mdi-checkbox-marked-outline",isBlocked:!0},onCellClicked:({data:e,node:t})=>{e.confirmed||N.fire({title:"Ushbu amalni aniq bajarmoqchimisiz?",icon:"warning"}).then(r=>{r.isConfirmed&&g.get(`report_success/${e.id}`).then(({data:i})=>{t.setData(i)})})}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-delete-empty",color:"red",isBlocked:!0},onCellClicked:({data:e})=>{e.confirmed||N.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(t=>{t.isConfirmed&&g.delete(`report/${e.id}`).then(()=>{c.gridApi.applyTransaction({remove:[e]})})})}}]);return g.get(`report_type/${m}`).then(({data:e})=>{c.reports=e}),f({pageData:c}),(e,t)=>{const r=d("AgGridVue");return v(),y(r,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:i})=>i.id,columnDefs:n,rowData:c.reports,onGridReady:t[0]||(t[0]=i=>c.gridApi=i.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),ee=V({__name:"CurrentReportTable",props:["report_id"],setup(p,{expose:f}){const{report_id:m}=p,a=h({gridApi:null,reports:[]}),c=h([{field:"id",headerName:"№",width:65},{field:"name",headerName:"Nomi",width:200},{field:"user.name",headerName:"Yaratdi"},{field:"created_at",headerName:"Vaqti",flex:1},{cellClass:["d-flex","justify-center","align-center"],field:"file_source",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-microsoft-excel"},onCellClicked:({data:n})=>{window.open(`/storage/${n.file_source}`,"_blank")}},{cellClass:["d-flex","justify-center","align-center"],field:"",headerName:"",width:60,cellRenderer:b,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},onCellClicked:({data:n})=>{N.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(e=>{e.isConfirmed&&g.delete(`report/${n.id}`).then(()=>{a.gridApi.applyTransaction({remove:[n]})})})}}]);return g.get(`report_type/${m}`).then(({data:n})=>{a.reports=n}),f({pageData:a}),(n,e)=>{const t=d("AgGridVue");return v(),y(t,{headerHeight:34,defaultColDef:{sortable:!0},class:"ag-theme-material h-100",getRowId:({data:r})=>r.id,columnDefs:c,rowData:a.reports,onGridReady:e[0]||(e[0]=r=>a.gridApi=r.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])}}}),te={class:"d-flex flex-column"},re=V({__name:"Reports",setup(p){const f=q(),m=q(),a=q();function c(r){a.value.pageData.gridApi.applyTransaction({add:[r.report]}),e.tab=2}function n(r){r.report_type_id==1?(e.tab=0,f.value.pageData.gridApi.applyTransaction({add:[r.report]})):r.report_type_id==2&&(e.tab=1,m.value.pageData.gridApi.applyTransaction({add:[r.report]}))}g.get("report_type").then(({data:r})=>{const i=r.map(s=>(s.id==1&&(s.component=M(K)),s.id==2&&(s.component=M(Q)),s));e.report_types=i});const e=h({tab:0,report_types:[]});function t(){g.get("umumiy/employes",{responseType:"blob"}).then(r=>{const i=window.URL.createObjectURL(new Blob([r.data])),s=document.createElement("a");s.href=i,s.setAttribute("download","umumiy.xlsx"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(i),document.body.removeChild(s)})}return(r,i)=>{const s=d("v-btn"),x=d("v-list"),R=d("v-menu"),u=d("v-tab"),_=d("v-tabs"),$=d("v-window-item"),L=d("v-window"),E=d("v-card-text"),O=d("v-card"),Y=d("v-spacer");return v(),A("section",te,[o(R,null,{activator:l(({props:w})=>[S("div",null,[o(s,H({"append-icon":"mdi-chevron-down",class:"text-capitalize",color:"blue-grey",variant:"tonal"},w),{default:l(()=>[D(" Hisobotlar ")]),_:2},1040),e.report_types.length?(v(),y(W,{key:0,onAddMovement:c,report:e.report_types[2]},null,8,["report"])):j("",!0),o(s,{onClick:t,"prepend-icon":"mdi-book-account",class:"text-capitalize ml-4",variant:"tonal"},{default:l(()=>[D(" Umumiy malumotlar ")]),_:1})])]),default:l(()=>[o(x,{class:"py-1"},{default:l(()=>[(v(!0),A(z,null,P(e.report_types,w=>(v(),A("div",null,[w.id!=3?(v(),y(J(w.component),{key:0,onAddReport:n,report:w},null,40,["report"])):j("",!0)]))),256))]),_:1})]),_:1}),o(Y,{class:"mt-4"},{default:l(()=>[o(O,{class:"h-100 d-flex flex-column"},{default:l(()=>[o(_,{modelValue:e.tab,"onUpdate:modelValue":i[0]||(i[0]=w=>e.tab=w)},{default:l(()=>[(v(!0),A(z,null,P(e.report_types,(w,F)=>(v(),y(u,{value:F,class:"text-capitalize"},{default:l(()=>[D(T(w.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),o(E,{class:"flex-grow-1"},{default:l(()=>[o(L,{modelValue:e.tab,"onUpdate:modelValue":i[1]||(i[1]=w=>e.tab=w),class:"h-100"},{default:l(()=>[o($,{class:"h-100"},{default:l(()=>[o(Z,{ref_key:"oldTable",ref:f,report_id:1},null,512)]),_:1}),o($,{class:"h-100"},{default:l(()=>[o(ee,{ref_key:"currentTable",ref:m,report_id:2},null,512)]),_:1}),o($,{class:"h-100"},{default:l(()=>[o(X,{ref_key:"movementTable",ref:a,report_id:3},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}});export{re as default};
