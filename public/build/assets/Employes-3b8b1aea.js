import{d as S,r as E,l as b,m as f,a as n,o as U,c as $,w as a,b as e,p as O,j,g as N,f as L,n as F,u as H,q as K,h as G,e as k,i as M}from"./app-c9a20659.js";import{I as X}from"./IconEdit-336cb755.js";import{A as Y}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-e699bd52.js";const J=L("span",null,"Xodim kiritish",-1),P=S({__name:"AddEmploye",emits:["addEmploye"],setup(V,{emit:v}){const h=E(),s=b({dialog:!1,organizations:null,positions:null,inputLoading:!1,rules:[p=>[null,""].includes(p)?"toldiring":!0]}),i=b({table_number:null,name:null,position_id:null,hiring_date:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function _(){const{valid:p}=await h.value.validate();p!=!1&&f.post("employe",i).then(({data:l})=>{s.dialog=!1,v("addEmploye",l)})}function t(){i.table_number.length==5&&(s.inputLoading=!0,y())}function y(){f.get(`employe/getdata/${i.table_number}`).then(({data:p})=>{i.name=p.name,i.organization_id=p.organization_id,setTimeout(()=>s.inputLoading=!1,1e3)}).catch(()=>{s.inputLoading=!1})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:p},{data:l})=>{s.organizations=p,s.positions=l})),(p,l)=>{const d=n("v-btn"),o=n("v-card-title"),g=n("v-text-field"),r=n("v-col"),c=n("v-autocomplete"),z=n("v-radio"),x=n("v-radio-group"),w=n("v-row"),I=n("v-container"),q=n("v-card-text"),R=n("v-spacer"),A=n("v-card-actions"),C=n("v-form"),B=n("v-card"),D=n("v-dialog");return U(),$(w,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:a(()=>[e(D,{modelValue:s.dialog,"onUpdate:modelValue":l[12]||(l[12]=u=>s.dialog=u),persistent:"",width:"768",location:"right"},{activator:a(({props:u})=>[e(d,O({icon:"mdi-plus",color:"teal"},u),null,16)]),default:a(()=>[e(B,null,{default:a(()=>[e(C,{ref_key:"form",ref:h,"fast-fail":"",class:"bg-white",onSubmit:j(_,["prevent"]),onVnodeMounted:l[11]||(l[11]=u=>h.value.reset())},{default:a(()=>[e(o,{class:"bg-blue-grey-lighten-5"},{default:a(()=>[J]),_:1}),e(q,{class:"pa-0"},{default:a(()=>[e(I,null,{default:a(()=>[e(w,null,{default:a(()=>[e(r,{cols:"12",class:"pt-0"},{default:a(()=>[e(g,{onInput:t,loading:s.inputLoading,color:"teal",rules:s.rules,label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:i.table_number,"onUpdate:modelValue":l[0]||(l[0]=u=>i.table_number=u),type:"number"},null,8,["loading","rules","modelValue"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:a(()=>[e(g,{color:"teal",rules:s.rules,label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:i.name,"onUpdate:modelValue":l[1]||(l[1]=u=>i.name=u)},null,8,["rules","modelValue"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:a(()=>[e(c,{color:"teal",items:s.organizations,variant:"underlined","hide-details":"auto",modelValue:i.organization_id,"onUpdate:modelValue":l[2]||(l[2]=u=>i.organization_id=u),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:s.rules},null,8,["items","modelValue","rules"])]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(c,{color:"teal",items:s.positions,variant:"underlined","hide-details":"auto",modelValue:i.position_id,"onUpdate:modelValue":l[3]||(l[3]=u=>i.position_id=u),label:"Lavozimi","item-title":"name",rules:s.rules,"item-value":"id"},null,8,["items","modelValue","rules"])]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(g,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:i.hiring_date,"onUpdate:modelValue":l[4]||(l[4]=u=>i.hiring_date=u),type:"date",rules:s.rules},null,8,["modelValue","rules"])]),_:1}),e(r,{cols:"6"},{default:a(()=>[e(g,{color:"teal",label:"Bo'yi",variant:"underlined","hide-details":"auto",modelValue:i.heigth,"onUpdate:modelValue":l[5]||(l[5]=u=>i.heigth=u)},null,8,["modelValue"])]),_:1}),e(r,{cols:"6"},{default:a(()=>[e(g,{color:"teal",label:"Bosh o'lchami",variant:"underlined","hide-details":"auto",modelValue:i.size_head,"onUpdate:modelValue":l[6]||(l[6]=u=>i.size_head=u)},null,8,["modelValue"])]),_:1}),e(r,{cols:"6"},{default:a(()=>[e(g,{color:"teal",label:"Kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:i.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=u=>i.size_cloth=u)},null,8,["modelValue"])]),_:1}),e(r,{cols:"6"},{default:a(()=>[e(g,{color:"teal",label:"Oyoq kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:i.size_shoes,"onUpdate:modelValue":l[8]||(l[8]=u=>i.size_shoes=u)},null,8,["modelValue"])]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(x,{color:"teal",class:"",small:"",modelValue:i.gender,"onUpdate:modelValue":l[9]||(l[9]=u=>i.gender=u),"hide-details":"auto",rules:s.rules},{default:a(()=>[e(z,{label:"Erkak",value:!0}),e(z,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(R),e(d,{color:"blue-gray-1",variant:"text",type:"button",onClick:l[10]||(l[10]=u=>s.dialog=!1)},{default:a(()=>[N(" Yopish ")]),_:1}),e(d,{color:"teal",variant:"text",type:"submit"},{default:a(()=>[N(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),W=L("span",null,"Xodim ma'lumotlarini o'zgartirish",-1),Q=S({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(V,{expose:v,emit:h}){const{current:s}=V,i=E(),_=b({dialog:!1,organizations:null,positions:null,rules:[d=>d==null||d==""?"toldiring":!0]}),t=b({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function y(){f.get(`employe/${s.selected}`).then(({data:d})=>{const o=d.position.at(-1);o&&(t.position_id=o.position.id),t.table_number=d.table_number,t.name=d.name,t.hiring_date=d.hiring_date,t.gender=d.gender,t.heigth=d.heigth,t.size_cloth=d.size_cloth,t.size_head=d.size_head,t.size_shoes=d.size_shoes,t.organization_id=d.organization_id})}async function p(){const{valid:d}=await i.value.validate();d!=!1&&f.patch(`employe/${s.selected}`,t).then(({data:o})=>{_.dialog=!1,h("editEmploye",o)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:d},{data:o})=>{_.organizations=d,_.positions=o})),F(()=>_.dialog,d=>{d?y():i.value.reset()}),v({toggle:()=>_.dialog=!0}),(d,o)=>{const g=n("v-card-title"),r=n("v-text-field"),c=n("v-col"),z=n("v-autocomplete"),x=n("v-radio"),w=n("v-radio-group"),I=n("v-row"),q=n("v-container"),R=n("v-card-text"),A=n("v-spacer"),C=n("v-btn"),B=n("v-card-actions"),D=n("v-form"),u=n("v-card"),T=n("v-dialog");return U(),$(T,{modelValue:_.dialog,"onUpdate:modelValue":o[11]||(o[11]=m=>_.dialog=m),persistent:"",width:"768",location:"right"},{default:a(()=>[e(u,null,{default:a(()=>[e(D,{ref_key:"form",ref:i,class:"bg-white",onSubmit:j(p,["prevent"])},{default:a(()=>[e(g,{class:"bg-blue-grey-lighten-5"},{default:a(()=>[W]),_:1}),e(R,{class:"pa-0"},{default:a(()=>[e(q,null,{default:a(()=>[e(I,null,{default:a(()=>[e(c,{cols:"12",class:"pt-0"},{default:a(()=>[e(r,{color:"teal",label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:t.table_number,"onUpdate:modelValue":o[0]||(o[0]=m=>t.table_number=m),type:"number",rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12",class:"pt-0"},{default:a(()=>[e(r,{color:"teal",label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:t.name,"onUpdate:modelValue":o[1]||(o[1]=m=>t.name=m),rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12",class:"pt-0"},{default:a(()=>[e(z,{color:"teal",items:_.organizations,variant:"underlined","hide-details":"auto",modelValue:t.organization_id,"onUpdate:modelValue":o[2]||(o[2]=m=>t.organization_id=m),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:_.rules},null,8,["items","modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(z,{color:"teal",items:_.positions,variant:"underlined","hide-details":"auto",modelValue:t.position_id,"onUpdate:modelValue":o[3]||(o[3]=m=>t.position_id=m),label:"Lavozimi","item-title":"name","item-value":"id",rules:_.rules},null,8,["items","modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(r,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:t.hiring_date,"onUpdate:modelValue":o[4]||(o[4]=m=>t.hiring_date=m),type:"date",rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(r,{color:"teal",label:"Bo'yi",variant:"underlined","hide-details":"auto",modelValue:t.heigth,"onUpdate:modelValue":o[5]||(o[5]=m=>t.heigth=m)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(r,{color:"teal",label:"Bosh o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_head,"onUpdate:modelValue":o[6]||(o[6]=m=>t.size_head=m)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(r,{color:"teal",label:"Kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_cloth,"onUpdate:modelValue":o[7]||(o[7]=m=>t.size_cloth=m)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(r,{color:"teal",label:"Oyoq kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_shoes,"onUpdate:modelValue":o[8]||(o[8]=m=>t.size_shoes=m)},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(w,{color:"teal",small:"",modelValue:t.gender,"onUpdate:modelValue":o[9]||(o[9]=m=>t.gender=m),"hide-details":"auto"},{default:a(()=>[e(x,{label:"Erkak",value:!0}),e(x,{label:"Ayol",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(B,null,{default:a(()=>[e(A),e(C,{color:"blue-gray-1",variant:"text",type:"button",onClick:o[10]||(o[10]=m=>_.dialog=!1)},{default:a(()=>[N(" Yopish ")]),_:1}),e(C,{color:"blue-darken-1",variant:"text",type:"submit"},{default:a(()=>[N(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}});function Z(V){return V?"Erkak":"Ayol"}const ee={class:"d-flex flex-column"},le={class:"d-flex justify-space-between items-center"},ne=S({__name:"Employes",setup(V){const v=H(),h=E(),s=b({gridApi:null,selected:null});function i(l){s.gridApi.applyTransaction({add:[l],addIndex:0})}function _(l){s.gridApi.getRowNode(l.id).setData(l)}const t=K(),y=b([{field:"table_number",headerName:"Tabel №",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:l=>l.value.at(-1)?l.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:l=>Z(l.value),sortable:!0,width:60,headerClass:["px-2"],cellClass:["px-2"]},{field:"heigth",headerName:"Bo'yi (sm)",sortable:!0,width:85,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_head",headerName:"Bosh o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_cloth",headerName:"Kiyim o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_shoes",headerName:"Oyoq kiyim o'lch..",sortable:!0,width:125,headerClass:["px-2"],cellClass:["px-2"]},{hide:(v.userRoles.includes(4)||v.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:X,headerClass:["px-2"],onCellClicked:({data:l})=>{s.selected=l.id,h.value.toggle()}}]),p=E([]);return f.get("employe").then(({data:l})=>p.value=l),(l,d)=>{const o=n("Breadcrumbs"),g=n("v-spacer");return U(),G("main",ee,[L("div",le,[e(o),k(v).userRoles.includes(4)||k(v).userRoles.includes(1)?(U(),$(P,{key:0,onAddEmploye:i})):M("",!0),e(Q,{onEditEmploye:_,ref_key:"editComponent",ref:h,current:s},null,8,["current"])]),e(g,{class:"px-4"},{default:a(()=>[e(k(Y),{class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:r})=>r.id,columnDefs:y,rowData:p.value,onGridReady:d[0]||(d[0]=r=>s.gridApi=r.api),onRowDoubleClicked:d[1]||(d[1]=r=>k(t).push({name:"employe",params:{id:r.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ne as default};
