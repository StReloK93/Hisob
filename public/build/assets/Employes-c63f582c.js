import{s as $}from"./swal-8a44a15e.js";import{_ as w}from"./Icon.vue_vue_type_script_setup_true_lang-b631698b.js";import{d as x,l as V,m as _,a as r,o as y,c as D,w as m,e as a,g as p,i as C,n as I,p as j,u as q,r as k,q as B,h as F,b as R}from"./app-2941f757.js";import{r as v}from"./helpers-ca74a7fa.js";const E=x({__name:"FormInputs",props:["formData","pageData"],setup(o){const{formData:d}=o,s=V({organizations:null,positions:null,inputLoading:!1});function u(){d.table_number.length==5&&(s.inputLoading=!0,f())}_.all([_.get("accessOrganizations"),_.get("position")]).then(_.spread(({data:t},{data:l})=>{s.organizations=t,s.positions=l}));function f(){_.get(`employe/getdata/${d.table_number}`).then(({data:t})=>{d.name=t.name,d.organization_id=t.organization_id,d.profession=t.profession,d.hiring_date=t.hiring_date,setTimeout(()=>s.inputLoading=!1,1e3)}).catch(()=>{s.inputLoading=!1})}return(t,l)=>{const c=r("v-text-field"),h=r("v-autocomplete"),e=r("v-col"),i=r("v-radio"),g=r("v-radio-group"),z=r("v-row");return y(),D(z,null,{default:m(()=>[a(e,{cols:"12",class:"pt-0"},{default:m(()=>[a(c,{class:"mb-2",onInput:u,loading:s.inputLoading,rules:p(v),label:"Tabel raqam",modelValue:o.formData.table_number,"onUpdate:modelValue":l[0]||(l[0]=n=>o.formData.table_number=n),type:"number"},null,8,["loading","rules","modelValue"]),a(c,{class:"mb-2",rules:p(v),label:"F.I.SH",modelValue:o.formData.name,"onUpdate:modelValue":l[1]||(l[1]=n=>o.formData.name=n)},null,8,["rules","modelValue"]),s.organizations?(y(),D(h,{key:0,class:"mb-2",items:s.organizations,modelValue:o.formData.organization_id,"onUpdate:modelValue":l[2]||(l[2]=n=>o.formData.organization_id=n),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:p(v)},null,8,["items","modelValue","rules"])):C("",!0),s.positions?(y(),D(h,{key:1,class:"mb-2",items:s.positions,modelValue:o.formData.position_id,"onUpdate:modelValue":l[3]||(l[3]=n=>o.formData.position_id=n),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:p(v),"item-value":"id"},null,8,["items","modelValue","rules"])):C("",!0),a(c,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:o.formData.profession,"onUpdate:modelValue":l[4]||(l[4]=n=>o.formData.profession=n),rules:p(v)},null,8,["modelValue","rules"]),a(c,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:o.formData.hiring_date,"onUpdate:modelValue":l[5]||(l[5]=n=>o.formData.hiring_date=n),type:"date",rules:p(v)},null,8,["modelValue","rules"])]),_:1}),a(e,{cols:"6"},{default:m(()=>[a(c,{class:"mb-2",label:"Bo'yi",modelValue:o.formData.heigth,"onUpdate:modelValue":l[6]||(l[6]=n=>o.formData.heigth=n)},null,8,["modelValue"]),a(c,{class:"mb-2",label:"Kiyim o'lchami",modelValue:o.formData.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=n=>o.formData.size_cloth=n)},null,8,["modelValue"])]),_:1}),a(e,{cols:"6"},{default:m(()=>[a(c,{class:"mb-2",label:"Bosh o'lchami",modelValue:o.formData.size_head,"onUpdate:modelValue":l[8]||(l[8]=n=>o.formData.size_head=n)},null,8,["modelValue"]),a(c,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:o.formData.size_shoes,"onUpdate:modelValue":l[9]||(l[9]=n=>o.formData.size_shoes=n)},null,8,["modelValue"])]),_:1}),a(e,{cols:"12"},{default:m(()=>[a(g,{small:"",modelValue:o.formData.gender,"onUpdate:modelValue":l[10]||(l[10]=n=>o.formData.gender=n),rules:p(v)},{default:m(()=>[a(i,{label:"Erkak",value:!0}),a(i,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})}}}),L=x({__name:"AddEmploye",emits:["addEmploye"],setup(o,{emit:d}){const s=V({dialog:!1}),u=V({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function f(){await _.post("employe",u).then(({data:t})=>{s.dialog=!1,d("addEmploye",t)})}return(t,l)=>{const c=r("v-btn"),h=r("CustomForm"),e=r("v-dialog"),i=r("v-row");return y(),D(i,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:m(()=>[a(e,{modelValue:s.dialog,"onUpdate:modelValue":l[1]||(l[1]=g=>s.dialog=g),persistent:"",width:"768",location:"right"},{activator:m(({props:g})=>[a(c,I({icon:"mdi-plus",color:"teal"},g),null,16)]),default:m(()=>[a(h,{submitMethod:f,onClose:l[0]||(l[0]=g=>s.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:m(()=>[a(E,{formData:u,pageData:s},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),T=x({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(o,{expose:d,emit:s}){const{current:u}=o,f=V({dialog:!1}),t=V({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function l(){_.get(`employe/${u.selected}`).then(({data:e})=>{const i=e.position.at(-1);i&&(t.position_id=i.position.id),t.table_number=e.table_number,t.name=e.name,t.hiring_date=e.hiring_date,t.gender=e.gender,t.heigth=e.heigth,t.profession=e.profession,t.size_cloth=e.size_cloth,t.size_head=e.size_head,t.size_shoes=e.size_shoes,t.organization_id=e.organization_id})}async function c(){await _.patch(`employe/${u.selected}`,t).then(({data:e})=>{f.dialog=!1,s("editEmploye",e)})}return j(()=>f.dialog,e=>{e&&l()}),d({toggle:()=>f.dialog=!0}),(e,i)=>{const g=r("CustomForm"),z=r("v-dialog");return y(),D(z,{modelValue:f.dialog,"onUpdate:modelValue":i[1]||(i[1]=n=>f.dialog=n),persistent:"",width:"768",location:"right"},{default:m(()=>[a(g,{submitMethod:c,onClose:i[0]||(i[0]=n=>f.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:m(()=>[a(E,{formData:t,pageData:f},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])}}}),M={class:"d-flex flex-column"},P={class:"d-flex justify-space-between items-center"},S={class:"px-4 mb-2"},X=x({__name:"Employes",setup(o){const d=q(),s=k(),u=V({gridApi:null,selected:null});function f(e){u.gridApi.applyTransaction({add:[e],addIndex:0})}function t(e){u.gridApi.getRowNode(e.id).setData(e)}const l=B(),c=V([{field:"table_number",headerName:"Tabel №",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"profession",headerName:"Lavozimi",sortable:!0},{headerName:"Yoriqnoma №",sortable:!0,cellRenderer:e=>{const i=e.data.position.at(-1).position;return`${i.position_type_id} - ${i.number_in_document}`}},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>l.push({name:"employe",params:{id:e.id}})},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>{u.selected=e.id,s.value.toggle()}},{hide:d.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},headerClass:["px-2"],onCellClicked:({data:e})=>{$.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(i=>{i.isConfirmed&&_.delete(`employe/${e.id}`).then(()=>{u.gridApi.applyTransaction({remove:[e]})})})}}]),h=k([]);return _.get("employe").then(({data:e})=>h.value=e),(e,i)=>{const g=r("Breadcrumbs"),z=r("v-text-field"),n=r("v-col"),N=r("v-row"),U=r("AgGridVue"),A=r("v-spacer");return y(),F("main",M,[R("div",P,[a(g),p(d).userRoles.includes(4)||p(d).userRoles.includes(1)?(y(),D(L,{key:0,onAddEmploye:f})):C("",!0),a(T,{onEditEmploye:t,ref_key:"editComponent",ref:s,current:u},null,8,["current"])]),R("div",S,[a(N,{class:"d-flex justify-end"},{default:m(()=>[a(n,{cols:"3"},{default:m(()=>[a(z,{"prepend-inner-icon":"mdi-magnify",onInput:i[0]||(i[0]=b=>u.gridApi.setQuickFilter(b.target.value)),label:"Qidiruv"})]),_:1})]),_:1})]),a(A,{class:"px-4"},{default:m(()=>[a(U,{defaultColDef:{sortable:!0},class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:b})=>b.id,columnDefs:c,rowData:h.value,onGridReady:i[1]||(i[1]=b=>u.gridApi=b.api),onRowDoubleClicked:i[2]||(i[2]=b=>p(l).push({name:"employe",params:{id:b.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{X as default};
