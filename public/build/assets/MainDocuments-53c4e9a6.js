import{I as F}from"./IconEdit-912b1d74.js";import{d as x,a as c,o as g,h as y,F as j,k as T,c as C,w as u,e as o,g as v,b as N,l as D,n as k,m as w,r as U}from"./app-2941f757.js";import{r as h}from"./helpers-ca74a7fa.js";const E={class:"d-flex item-center"},I=x({__name:"FileIcons",props:["params"],setup(s){return(f,i)=>{const d=c("v-btn");return g(),y("div",E,[(g(!0),y(j,null,T(s.params.value,m=>(g(),C(d,{tag:"a",href:`/files/${m.src}`,target:"_blank",color:"teal",icon:"mdi-file-pdf-box",class:"mr-1",size:"small"},null,8,["href"]))),256))])}}}),A={class:"text-subtitle-1 d-flex justify-space-between align-center mb-2"},R=N("span",null," Ish turlari ",-1),B={class:"d-flex flex-wrap bg-grey-lighten-4 mb-1"},$=x({__name:"FormInputs",props:["formData"],setup(s){const{formData:f}=s;function i(){f.positionTypes.push({name:"",code:""})}function d(m){f.positionTypes.splice(m,1)}return(m,t)=>{const n=c("v-textarea"),r=c("v-text-field"),_=c("v-file-input"),a=c("v-col"),e=c("v-btn"),p=c("v-row");return g(),C(p,null,{default:u(()=>[o(a,{cols:"6",class:"pt-0"},{default:u(()=>[o(n,{class:"mb-2",label:"Nomi",modelValue:s.formData.name,"onUpdate:modelValue":t[0]||(t[0]=l=>s.formData.name=l),rules:v(h)},null,8,["modelValue","rules"]),o(r,{class:"mb-2",label:"Hujjat tasdiqlangan sana",modelValue:s.formData.confirm_date,"onUpdate:modelValue":t[1]||(t[1]=l=>s.formData.confirm_date=l),type:"date",rules:v(h)},null,8,["modelValue","rules"]),o(_,{class:"mb-2",chips:"",modelValue:s.formData.files,"onUpdate:modelValue":t[2]||(t[2]=l=>s.formData.files=l),multiple:"",label:"Normaviy hujjatlar",rules:v(h)},null,8,["modelValue","rules"]),o(n,{class:"mb-2",label:"Izoh",modelValue:s.formData.description,"onUpdate:modelValue":t[3]||(t[3]=l=>s.formData.description=l)},null,8,["modelValue"])]),_:1}),o(a,{cols:"6"},{default:u(()=>[N("h2",A,[R,o(e,{density:"comfortable",icon:"mdi-plus",onClick:i})]),(g(!0),y(j,null,T(s.formData.positionTypes,(l,b)=>(g(),y("section",B,[o(a,{cols:"12",class:"pt-1 pb-0 d-flex justify-end"},{default:u(()=>[o(e,{color:"red",density:"compact",onClick:V=>d(b),variant:"text",icon:"mdi-close"},null,8,["onClick"])]),_:2},1024),o(a,{cols:"4",class:"pb-1 pt-0"},{default:u(()=>[o(r,{density:"compact",class:"mb-2",label:"Tartib raqami",hideDetails:!0,modelValue:l.code,"onUpdate:modelValue":V=>l.code=V,rules:v(h)},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(a,{cols:"8",class:"pb-1 pt-0"},{default:u(()=>[o(r,{density:"compact",class:"mb-2",label:"Nomi",hideDetails:!0,modelValue:l.name,"onUpdate:modelValue":V=>l.name=V,rules:v(h)},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]))),256))]),_:1})]),_:1})}}}),M=x({__name:"AddDocument",emits:["addDocument"],setup(s,{emit:f}){const i=D({dialog:!1}),d=D({name:null,confirm_date:null,description:null,files:[],positionTypes:[{name:"",code:""}]});async function m(){const n=new FormData;n.append("name",d.name),n.append("confirm_date",d.confirm_date),n.append("description",d.description==null?"":d.description),d.files.forEach(_=>n.append("files[]",_)),d.positionTypes.forEach(_=>n.append("positionTypes[]",JSON.stringify(_)));const{data:r}=await w.post("document",n);i.dialog=!1,f("addDocument",r)}function t(){d.positionTypes=[{name:"",code:""}]}return(n,r)=>{const _=c("v-btn"),a=c("CustomForm"),e=c("v-dialog"),p=c("v-row");return g(),C(p,{justify:"end",class:"ma-0 pb-2 px-4"},{default:u(()=>[o(e,{modelValue:i.dialog,"onUpdate:modelValue":r[1]||(r[1]=l=>i.dialog=l),scrollable:"",persistent:"",width:"992"},{activator:u(({props:l})=>[o(_,k({icon:"mdi-plus"},l),null,16)]),default:u(()=>[o(a,{submitMethod:m,onClose:r[0]||(r[0]=l=>i.dialog=!1),title:"Normaviy hujjat kiritish",height:"700px",onVnodeMounted:t},{default:u(()=>[o($,{formData:d},null,8,["formData"])]),_:1},512)]),_:1},8,["modelValue"])]),_:1})}}}),q=x({__name:"EditDocument",props:["current"],emits:["editDocument"],setup(s,{expose:f,emit:i}){const{current:d}=s,m=D({dialog:!1}),t=D({name:null,confirm_date:null,description:null,positionTypes:[],files:[]});async function n(){const a=new FormData;a.append("name",t.name),a.append("confirm_date",t.confirm_date),a.append("description",t.description==null?"":t.description),t.positionTypes.forEach(e=>a.append("positionTypes[]",JSON.stringify(e))),t.files.forEach(e=>{e.type?a.append("files[]",e):a.append("files[]",e.id)}),await w.post(`document/${d.selected}`,a).then(({data:e})=>{console.log(m.dialog,"dialog"),m.dialog=!1,i("editDocument",e)})}function r(a){w.get(`/document/${a}`).then(({data:e})=>{t.name=e.name,t.confirm_date=e.confirm_date,t.description=e.description,t.positionTypes=e.position_types,e.files.forEach(p=>p.name=p.src),t.files=e.files})}return f({toggle:()=>m.dialog=!0}),(a,e)=>{const p=c("CustomForm"),l=c("v-dialog");return g(),C(l,{modelValue:m.dialog,"onUpdate:modelValue":e[2]||(e[2]=b=>m.dialog=b),scrollable:"",width:"992",location:"right"},{default:u(()=>[o(p,{submitMethod:n,onClose:e[0]||(e[0]=b=>m.dialog=!1),title:"Normaviy hujjat kiritish",height:"700px",onVnodeMounted:e[1]||(e[1]=b=>r(s.current.selected))},{default:u(()=>[o($,{formData:t},null,8,["formData"])]),_:1},512)]),_:1},8,["modelValue"])}}}),z={class:"d-flex flex-column"},G={class:"d-flex justify-space-between items-center"},J=x({__name:"MainDocuments",setup(s){const f=U(),i=D({gridApi:null,Document:[],selected:null});function d(n){i.gridApi.applyTransaction({add:[n]})}function m(n){i.gridApi.getRowNode(n.id).setData(n)}const t=D([{field:"id",headerName:"â„–",width:65},{field:"name",headerName:"Nomi"},{field:"files",headerName:"Hujjatlar",cellRenderer:I,valueFormatter:null,cellClass:["d-flex","align-center"]},{field:"confirm_date",headerName:"Tasdiqdan o'tgan sana"},{field:"description",headerName:"Izoh",flex:1},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:F,headerClass:["px-2"],onCellClicked:({data:n})=>{i.selected=n.id,f.value.toggle()}}]);return w.get("document").then(({data:n})=>i.Document=n),(n,r)=>{const _=c("Breadcrumbs"),a=c("AgGridVue"),e=c("v-spacer");return g(),y("section",z,[N("div",G,[o(_),o(M,{onAddDocument:d}),o(q,{onEditDocument:m,ref_key:"editComponent",ref:f,current:i},null,8,["current"])]),o(e,{class:"px-4"},{default:u(()=>[o(a,{defaultColDef:{sortable:!0},headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:p})=>p.id,columnDefs:t,rowData:i.Document,onGridReady:r[0]||(r[0]=p=>i.gridApi=p.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{J as default};
