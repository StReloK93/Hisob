import{I as O}from"./IconEdit-c3c8045e.js";import{d as I,a as t,o as v,h as x,F as q,k as P,c as z,l as N,r as H,w as o,b as e,p as L,j as M,g as G,f as j,m as $,n as K}from"./app-fcb2f473.js";const Q={class:"d-flex item-center"},W=I({__name:"FileIcons",props:["params"],setup(T){return(b,i)=>{const a=t("v-btn");return v(),x("div",Q,[(v(!0),x(q,null,P(T.params.value,c=>(v(),z(a,{tag:"a",href:`/files/${c.src}`,target:"_blank",color:"teal",icon:"mdi-file-pdf-box",class:"mr-1",size:"small"},null,8,["href"]))),256))])}}}),X={class:"text-subtitle-1 d-flex justify-space-between align-center mb-2"},Y=j("span",null," Ish turlari ",-1),Z={class:"d-flex flex-wrap bg-grey-lighten-4 mb-1"},ee=I({__name:"AddDocument",emits:["addDocument"],setup(T,{emit:b}){const i=N({dialog:!1,rules:[f=>[null,""].includes(f)?"toldiring":!0]}),a=N({name:null,confirm_date:null,description:null,files:[],positionTypes:[{name:"",code:""}]});function c(){a.positionTypes.push({name:"",code:""})}function n(f){a.positionTypes.splice(f,1)}const r=H();async function V(){const{valid:f}=await r.value.validate();if(f==!1)return;const s=new FormData;s.append("name",a.name),s.append("confirm_date",a.confirm_date),s.append("description",a.description==null?"":a.description),a.files.forEach(p=>s.append("files[]",p)),a.positionTypes.forEach(p=>s.append("positionTypes[]",JSON.stringify(p))),$.post("document",s).then(({data:p})=>{i.dialog=!1,b("addDocument",p)})}function y(){r.value.reset(),a.positionTypes=[{name:"",code:""}]}return(f,s)=>{const p=t("v-btn"),_=t("v-card-title"),l=t("v-divider"),u=t("v-textarea"),D=t("v-text-field"),C=t("v-file-input"),g=t("v-col"),U=t("v-row"),h=t("v-container"),k=t("v-card-text"),E=t("FormFooter"),A=t("v-card"),R=t("v-form"),S=t("v-dialog");return v(),z(U,{justify:"end",class:"ma-0 pb-2 px-4"},{default:o(()=>[e(S,{modelValue:i.dialog,"onUpdate:modelValue":s[5]||(s[5]=d=>i.dialog=d),scrollable:"",width:"992",location:"right"},{activator:o(({props:d})=>[e(p,L({icon:"mdi-plus"},d),null,16)]),default:o(()=>[e(R,{ref_key:"formTag",ref:r,onSubmit:M(V,["prevent"]),onVnodeMounted:y},{default:o(()=>[e(A,{class:"bg-white"},{default:o(()=>[e(_,null,{default:o(()=>[G(" Normaviy hujjat kiritish ")]),_:1}),e(l),e(k,{class:"pa-0",style:{height:"700px"}},{default:o(()=>[e(h,null,{default:o(()=>[e(U,null,{default:o(()=>[e(g,{cols:"6",class:"pt-0"},{default:o(()=>[e(u,{class:"mb-2",label:"Nomi",modelValue:a.name,"onUpdate:modelValue":s[0]||(s[0]=d=>a.name=d),rules:i.rules},null,8,["modelValue","rules"]),e(D,{class:"mb-2",label:"Hujjat tasdiqlangan sana",modelValue:a.confirm_date,"onUpdate:modelValue":s[1]||(s[1]=d=>a.confirm_date=d),type:"date",rules:i.rules},null,8,["modelValue","rules"]),e(C,{class:"mb-2",chips:"",modelValue:a.files,"onUpdate:modelValue":s[2]||(s[2]=d=>a.files=d),multiple:"",label:"Normaviy hujjatlar",rules:i.rules},null,8,["modelValue","rules"]),e(u,{class:"mb-2",label:"Izoh",modelValue:a.description,"onUpdate:modelValue":s[3]||(s[3]=d=>a.description=d)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:o(()=>[j("h2",X,[Y,e(p,{density:"comfortable",icon:"mdi-plus",onClick:c})]),(v(!0),x(q,null,P(a.positionTypes,(d,B)=>(v(),x("section",Z,[e(g,{cols:"12",class:"pt-1 pb-0 d-flex justify-end"},{default:o(()=>[e(p,{color:"red",density:"compact",onClick:w=>n(B),variant:"text",icon:"mdi-close"},null,8,["onClick"])]),_:2},1024),e(g,{cols:"4",class:"pb-1 pt-0"},{default:o(()=>[e(D,{density:"compact",class:"mb-2",label:"Tartib raqami",hideDetails:!0,modelValue:d.code,"onUpdate:modelValue":w=>d.code=w,rules:i.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(g,{cols:"8",class:"pb-1 pt-0"},{default:o(()=>[e(D,{density:"compact",class:"mb-2",label:"Nomi",hideDetails:!0,modelValue:d.name,"onUpdate:modelValue":w=>d.name=w,rules:i.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]))),256))]),_:1})]),_:1})]),_:1})]),_:1}),e(l),e(E,{onClose:s[4]||(s[4]=d=>i.dialog=!1)})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}}}),te={class:"text-subtitle-1 d-flex justify-space-between align-center mb-2"},le=j("span",null," Ish turlari ",-1),oe={class:"d-flex flex-wrap bg-grey-lighten-4 mb-1"},ne=I({__name:"EditDocument",props:["current"],emits:["editDocument"],setup(T,{expose:b,emit:i}){const{current:a}=T,c=N({dialog:!1,rules:[_=>[null,""].includes(_)?"toldiring":!0]}),n=N({name:null,confirm_date:null,description:null,positionTypes:[],files:[]});function r(){n.positionTypes.push({name:"",code:""})}function V(_){n.positionTypes.splice(_,1)}const y=H();async function f(){const{valid:_}=await y.value.validate();if(_==!1)return;const l=new FormData;l.append("name",n.name),l.append("confirm_date",n.confirm_date),l.append("description",n.description==null?"":n.description),n.positionTypes.forEach(u=>l.append("positionTypes[]",JSON.stringify(u))),n.files.forEach(u=>{u.type?l.append("files[]",u):l.append("files[]",u.id)}),$.post(`document/${a.selected}`,l).then(({data:u})=>{c.dialog=!1,i("editDocument",u)})}function s(_){$.get(`/document/${_}`).then(({data:l})=>{n.name=l.name,n.confirm_date=l.confirm_date,n.description=l.description,n.positionTypes=l.position_types,console.log(l.positionTypes),l.files.forEach(u=>u.name=u.src),n.files=l.files})}return K(()=>c.dialog,_=>{_?s(a.selected):y.value.reset()}),b({toggle:()=>c.dialog=!0}),(_,l)=>{const u=t("v-card-title"),D=t("v-divider"),C=t("v-textarea"),g=t("v-text-field"),U=t("v-file-input"),h=t("v-col"),k=t("v-btn"),E=t("v-row"),A=t("v-container"),R=t("v-card-text"),S=t("FormFooter"),d=t("v-card"),B=t("v-form"),w=t("v-dialog");return v(),z(w,{modelValue:c.dialog,"onUpdate:modelValue":l[5]||(l[5]=m=>c.dialog=m),scrollable:"",width:"992",location:"right"},{default:o(()=>[e(B,{ref_key:"formTag",ref:y,onSubmit:M(f,["prevent"])},{default:o(()=>[e(d,{class:"bg-white"},{default:o(()=>[e(u,null,{default:o(()=>[G(" Normaviy hujjatni tahrirlash ")]),_:1}),e(D),e(R,{class:"pa-0",style:{height:"700px"}},{default:o(()=>[e(A,null,{default:o(()=>[e(E,null,{default:o(()=>[e(h,{cols:"6",class:"pt-0"},{default:o(()=>[e(C,{class:"mb-2",label:"Nomi",modelValue:n.name,"onUpdate:modelValue":l[0]||(l[0]=m=>n.name=m),rules:c.rules},null,8,["modelValue","rules"]),e(g,{class:"mb-2",label:"Hujjat tasdiqlangan sana",modelValue:n.confirm_date,"onUpdate:modelValue":l[1]||(l[1]=m=>n.confirm_date=m),type:"date",rules:c.rules},null,8,["modelValue","rules"]),e(U,{class:"mb-2",chips:"",modelValue:n.files,"onUpdate:modelValue":l[2]||(l[2]=m=>n.files=m),multiple:"",label:"Normaviy hujjatlar",rules:c.rules},null,8,["modelValue","rules"]),e(C,{class:"mb-2",label:"Izoh",modelValue:n.description,"onUpdate:modelValue":l[3]||(l[3]=m=>n.description=m)},null,8,["modelValue"])]),_:1}),e(h,{cols:"6"},{default:o(()=>[j("h2",te,[le,e(k,{density:"comfortable",icon:"mdi-plus",onClick:r})]),(v(!0),x(q,null,P(n.positionTypes,(m,J)=>(v(),x("section",oe,[e(h,{cols:"12",class:"pt-1 pb-0 d-flex justify-end"},{default:o(()=>[e(k,{color:"red",density:"compact",onClick:F=>V(J),variant:"text",icon:"mdi-close"},null,8,["onClick"])]),_:2},1024),e(h,{cols:"4",class:"pb-1 pt-0"},{default:o(()=>[e(g,{density:"compact",class:"mb-2",label:"Tartib raqami",hideDetails:!0,modelValue:m.code,"onUpdate:modelValue":F=>m.code=F,rules:c.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(h,{cols:"8",class:"pb-1 pt-0"},{default:o(()=>[e(g,{density:"compact",class:"mb-2",label:"Nomi",hideDetails:!0,modelValue:m.name,"onUpdate:modelValue":F=>m.name=F,rules:c.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]))),256))]),_:1})]),_:1})]),_:1})]),_:1}),e(D),e(S,{onClose:l[4]||(l[4]=m=>c.dialog=!1)})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])}}}),ae={class:"d-flex flex-column"},se={class:"d-flex justify-space-between items-center"},ce=I({__name:"MainDocuments",setup(T){const b=H(),i=N({gridApi:null,Document:[],selected:null});function a(r){i.gridApi.applyTransaction({add:[r]})}function c(r){i.gridApi.getRowNode(r.id).setData(r)}const n=N([{field:"id",headerName:"â„–",width:65},{field:"name",headerName:"Nomi"},{field:"files",headerName:"Hujjatlar",cellRenderer:W,valueFormatter:null,cellClass:["d-flex","align-center"]},{field:"confirm_date",headerName:"Tasdiqdan o'tgan sana"},{field:"description",headerName:"Izoh",flex:1},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:O,headerClass:["px-2"],onCellClicked:({data:r})=>{i.selected=r.id,b.value.toggle()}}]);return $.get("document").then(({data:r})=>i.Document=r),(r,V)=>{const y=t("Breadcrumbs"),f=t("AgGridVue"),s=t("v-spacer");return v(),x("section",ae,[j("div",se,[e(y),e(ee,{onAddDocument:a}),e(ne,{onEditDocument:c,ref_key:"editComponent",ref:b,current:i},null,8,["current"])]),e(s,{class:"px-4"},{default:o(()=>[e(f,{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:p})=>p.id,columnDefs:n,rowData:i.Document,onGridReady:V[0]||(V[0]=p=>i.gridApi=p.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ce as default};
