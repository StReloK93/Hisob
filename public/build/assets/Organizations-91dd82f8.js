import{I as B}from"./IconEdit-1030684a.js";import{d as p,r as z,b as s,o as v,i as C,f as n,C as N,D as $,e as b,_ as I,c as w,w as _,h as V,m as f,q as A,p as k,n as g}from"./app-d5ce1550.js";import{r as D}from"./helpers-ab18c3f4.js";const F=o=>(N("data-v-c7854a78"),o=o(),$(),o),R={class:"relative"},U=F(()=>b("div",{class:"absolute front-block"},null,-1)),j=p({__name:"Button",props:["params"],setup(o){const{params:u}=o,e=z(!1);return e.value=!!u.value,(i,l)=>{const a=s("v-switch");return v(),C("main",R,[n(a,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=t=>e.value=t),"hide-details":"auto",color:o.params.color?o.params.color:"teal"},null,8,["modelValue","color"]),U])}}});const E=I(j,[["__scopeId","data-v-c7854a78"]]),O=p({__name:"FormInputs",props:["formData"],setup(o){return(u,e)=>{const i=s("v-text-field"),l=s("v-switch"),a=s("v-col"),t=s("v-row");return v(),w(t,null,{default:_(()=>[n(a,{cols:"12",class:"pt-0"},{default:_(()=>[n(i,{class:"mb-2",label:"Nomi",modelValue:o.formData.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.formData.name=r),rules:V(D)},null,8,["modelValue","rules"]),n(i,{class:"mb-2",label:"Qisqa nomi",modelValue:o.formData.short_name,"onUpdate:modelValue":e[1]||(e[1]=r=>o.formData.short_name=r),rules:V(D)},null,8,["modelValue","rules"]),n(l,{class:"mb-2",label:"Faolligi",modelValue:o.formData.isActive,"onUpdate:modelValue":e[2]||(e[2]=r=>o.formData.isActive=r)},null,8,["modelValue"])]),_:1})]),_:1})}}}),S=p({__name:"AddOrganization",emits:["addOrganization"],setup(o,{emit:u}){const e=f({dialog:!1}),i=f({name:null,short_name:[],isActive:!0});function l(){g.post("organization",i).then(({data:a})=>{e.dialog=!1,u("addOrganization",a)})}return A(()=>e.dialog,a=>{a&&(i.name=null,i.short_name=null,i.isActive=!0)}),(a,t)=>{const r=s("v-btn"),h=s("CustomForm"),c=s("v-dialog"),d=s("v-row");return v(),w(d,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:_(()=>[n(c,{modelValue:e.dialog,"onUpdate:modelValue":t[1]||(t[1]=m=>e.dialog=m),persistent:"",width:"512",location:"right"},{activator:_(({props:m})=>[n(r,k({icon:"mdi-plus",color:"teal"},m),null,16)]),default:_(()=>[n(h,{submitMethod:l,onClose:t[0]||(t[0]=m=>e.dialog=!1),title:"Bo'linma kiritish"},{default:_(()=>[n(O,{formData:i},null,8,["formData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),q=p({__name:"EditOrganization",props:["current"],emits:["editOrganization"],setup(o,{expose:u,emit:e}){const{current:i}=o,l=f({dialog:!1}),a=f({name:null,short_name:null,isActive:!0});async function t(){await g.patch(`organization/${i.selected}`,a).then(({data:c})=>{l.dialog=!1,e("editOrganization",c)})}function r(c){g.get(`organization/${c}`).then(({data:d})=>{a.name=d.name,a.short_name=d.short_name,a.isActive=!!d.isActive})}return A(()=>l.dialog,c=>{c&&r(i.selected)}),u({toggle:()=>l.dialog=!0}),(c,d)=>{const m=s("CustomForm"),y=s("v-dialog");return v(),w(y,{modelValue:l.dialog,"onUpdate:modelValue":d[1]||(d[1]=x=>l.dialog=x),persistent:"",width:"512",location:"right"},{default:_(()=>[n(m,{submitMethod:t,onClose:d[0]||(d[0]=x=>l.dialog=!1),title:"Bo'linma tahrirlash"},{default:_(()=>[n(O,{formData:a},null,8,["formData"])]),_:1})]),_:1},8,["modelValue"])}}}),G={class:"d-flex flex-column"},M={class:"d-flex justify-space-between items-center"},T=p({__name:"Organizations",setup(o){const u=z(),e=f({gridApi:null,organization:[],selected:null});function i(t){e.gridApi.applyTransaction({add:[t]})}function l(t){e.gridApi.getRowNode(t.id).setData(t)}const a=f([{field:"id",headerName:"â„–",width:65},{field:"name",headerName:"Nomi",flex:1},{field:"short_name",headerName:"Qisqa nomi",flex:1},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:E,width:60,headerClass:["px-2"],onCellClicked:t=>{+g.post(`organization/set_activate/${t.data.id}`,{active:!t.value}).then(()=>{t.node.setDataValue("isActive",!t.value)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:B,headerClass:["px-2"],onCellClicked:({data:t})=>{e.selected=t.id,u.value.toggle()}}]);return g.get("organization").then(({data:t})=>e.organization=t),(t,r)=>{const h=s("Breadcrumbs"),c=s("AgGridVue"),d=s("v-spacer");return v(),C("section",G,[b("div",M,[n(h),n(S,{onAddOrganization:i}),n(q,{onEditOrganization:l,ref_key:"editComponent",ref:u,current:e},null,8,["current"])]),n(d,{class:"px-4"},{default:_(()=>[n(c,{defaultColDef:{sortable:!0},headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:m})=>m.id,columnDefs:a,rowData:e.organization,onGridReady:r[0]||(r[0]=m=>e.gridApi=m.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{T as default};
