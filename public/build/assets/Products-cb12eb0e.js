import{d as k,j as g,k as m,l as B,a as o,o as D,c as R,w as t,b as e,m as T,i as S,f as b,e as U,r as q,h as E,g as F}from"./app-cb4a4c21.js";import{_ as O,A as G}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-1dc78a55.js";import{B as Y}from"./Button-99282b83.js";import{I as z}from"./IconEdit-b0d31a9e.js";const K=U("span",null,"Mahsulot kiritish formasi",-1),L=k({__name:"AddProduct",emits:["addProduct"],setup(V,{emit:v}){const u=g({dialog:!1,products_types:null}),i=g({name:null,expiration_date:null,product_type:null,isActive:!0});function c(){m.post("product",i).then(({data:l})=>{u.dialog=!1,v("addProduct",l)})}return m.get("product_type").then(({data:l})=>{u.products_types=l.map(n=>({...n,count:1}))}),B(()=>u.dialog,l=>{l&&(i.name=null,i.product_type=null,i.expiration_date=null,i.isActive=!0)}),(l,n)=>{const d=o("v-btn"),_=o("v-card-title"),x=o("v-text-field"),s=o("v-col"),a=o("v-select"),h=o("v-switch"),y=o("v-row"),f=o("v-container"),w=o("v-card-text"),A=o("v-spacer"),C=o("v-card-actions"),N=o("v-card"),P=o("v-dialog");return D(),R(y,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:t(()=>[e(P,{modelValue:u.dialog,"onUpdate:modelValue":n[5]||(n[5]=r=>u.dialog=r),persistent:"",width:"512",location:"right"},{activator:t(({props:r})=>[e(d,T({icon:"mdi-plus",color:"teal"},r),null,16)]),default:t(()=>[e(N,{tag:"form",class:"bg-white",onSubmit:S(c,["prevent"])},{default:t(()=>[e(_,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[K]),_:1}),e(w,{class:"pa-0"},{default:t(()=>[e(f,null,{default:t(()=>[e(y,null,{default:t(()=>[e(s,{cols:"12",class:"pt-0"},{default:t(()=>[e(x,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:i.name,"onUpdate:modelValue":n[0]||(n[0]=r=>i.name=r),required:""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",class:"pt-0"},{default:t(()=>[e(x,{color:"teal",label:"Muddati (Oy)",variant:"underlined","hide-details":"auto",type:"number",modelValue:i.expiration_date,"onUpdate:modelValue":n[1]||(n[1]=r=>i.expiration_date=r),required:""},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",class:"pt-0"},{default:t(()=>[e(a,{color:"teal",items:u.products_types,variant:"underlined","hide-details":"auto",modelValue:i.product_type,"onUpdate:modelValue":n[2]||(n[2]=r=>i.product_type=r),label:"Turi","item-title":"name","item-value":r=>r.id,required:""},null,8,["items","modelValue","item-value"])]),_:1}),e(s,{cols:"12",class:"pt-0"},{default:t(()=>[e(h,{label:"Faolligi",modelValue:i.isActive,"onUpdate:modelValue":n[3]||(n[3]=r=>i.isActive=r),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(A),e(d,{color:"blue-gray-1",variant:"text",type:"button",onClick:n[4]||(n[4]=r=>u.dialog=!1)},{default:t(()=>[b(" Yopish ")]),_:1}),e(d,{color:"blue-darken-1",variant:"text",type:"submit"},{default:t(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}}}),H=U("span",null,"Lavozim kiritish formasi",-1),J=k({__name:"EditProduct",props:["current"],emits:["editProduct"],setup(V,{expose:v,emit:u}){const{current:i}=V,c=g({dialog:!1,products_types:null}),l=g({name:null,expiration_date:null,product_type:null,isActive:!0});m.get("product_type").then(({data:s})=>{c.products_types=s.map(a=>({...a,count:1}))});function n(){m.patch(`product/${i.selected}`,l).then(({data:s})=>{c.dialog=!1,u("editProduct",s)})}function d(s){m.get(`product/${s}`).then(({data:a})=>{l.name=a.name,l.product_type=a.product_type_id,l.expiration_date=a.expiration_date,l.isActive=!!a.isActive})}function _(){l.name=null,l.product_type=null,l.expiration_date=null,l.isActive=!0}return B(()=>c.dialog,s=>{s?d(i.selected):_()}),v({toggle:()=>c.dialog=!0}),(s,a)=>{const h=o("v-card-title"),y=o("v-text-field"),f=o("v-col"),w=o("v-select"),A=o("v-switch"),C=o("v-row"),N=o("v-container"),P=o("v-card-text"),r=o("v-spacer"),$=o("v-btn"),j=o("v-card-actions"),I=o("v-card"),M=o("v-dialog");return D(),R(M,{modelValue:c.dialog,"onUpdate:modelValue":a[5]||(a[5]=p=>c.dialog=p),persistent:"",width:"512",location:"right"},{default:t(()=>[e(I,{tag:"form",class:"bg-white",onSubmit:S(n,["prevent"])},{default:t(()=>[e(h,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[H]),_:1}),e(P,{class:"pa-0"},{default:t(()=>[e(N,null,{default:t(()=>[e(C,null,{default:t(()=>[e(f,{cols:"12",class:"pt-0"},{default:t(()=>[e(y,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:l.name,"onUpdate:modelValue":a[0]||(a[0]=p=>l.name=p),required:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",class:"pt-0"},{default:t(()=>[e(y,{color:"teal",label:"Muddati (Oy)",variant:"underlined","hide-details":"auto",type:"number",modelValue:l.expiration_date,"onUpdate:modelValue":a[1]||(a[1]=p=>l.expiration_date=p),required:""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",class:"pt-0"},{default:t(()=>[e(w,{color:"teal",items:c.products_types,variant:"underlined","hide-details":"auto",modelValue:l.product_type,"onUpdate:modelValue":a[2]||(a[2]=p=>l.product_type=p),label:"Turi","item-title":"name","item-value":p=>p.id,required:""},null,8,["items","modelValue","item-value"])]),_:1}),e(f,{cols:"12",class:"pt-0"},{default:t(()=>[e(A,{label:"Faolligi",modelValue:l.isActive,"onUpdate:modelValue":a[3]||(a[3]=p=>l.isActive=p),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:t(()=>[e(r),e($,{color:"blue-gray-1",variant:"text",type:"button",onClick:a[4]||(a[4]=p=>c.dialog=!1)},{default:t(()=>[b(" Yopish ")]),_:1}),e($,{color:"blue-darken-1",variant:"text",type:"submit"},{default:t(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])}}}),Q={class:"d-flex flex-column"},W={class:"d-flex justify-space-between items-center"},oe=k({__name:"Products",setup(V){const v=q(),u=g({selected:null,gridApi:null});function i(d){u.gridApi.applyTransaction({add:[d],addIndex:0})}function c(d){u.gridApi.getRowNode(d.id).setData(d)}const l=g([{field:"id",headerName:"Kod",width:80},{field:"name",headerName:"Nomi",flex:1},{field:"expiration_date",headerName:"Muddati (Oy)"},{field:"product_type.name",headerName:"Turi"},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:Y,width:60,headerClass:["px-2"],onCellClicked:d=>{const _=+!d.value;m.post(`product/set_activate/${d.data.id}`,{active:_}).then(()=>{d.node.setDataValue("isActive",_)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:z,headerClass:["px-2"],onCellClicked:({data:d})=>{u.selected=d.id,v.value.toggle()}}]),n=q([]);return m.get("product").then(({data:d})=>n.value=d),(d,_)=>{const x=o("v-spacer");return D(),E("section",Q,[U("div",W,[e(O),e(L,{onAddProduct:i}),e(J,{onEditProduct:c,ref_key:"editComponent",ref:v,current:u},null,8,["current"])]),e(x,{class:"px-4"},{default:t(()=>[e(F(G),{class:"ag-theme-material h-100",getRowId:({data:s})=>s.id,columnDefs:l,rowData:n.value,onGridReady:_[0]||(_[0]=s=>u.gridApi=s.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{oe as default};
