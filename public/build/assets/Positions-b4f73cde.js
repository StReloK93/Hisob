import{_ as H,A as J}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-3968d791.js";import{d as N,j as w,k as f,l as F,a as n,o as p,c as j,w as t,b as e,m as K,i as I,h as g,p as q,F as E,f as $,e as _,t as V,g as A,r as O}from"./app-70045dd6.js";import{d as z,i as L}from"./helpers-2d02b701.js";import{B as Q}from"./Button-9b74e894.js";import{I as W}from"./IconEdit-5c9848b1.js";const X=_("span",null,"Lavozim kiritish formasi",-1),Z={class:"w-100 d-flex justify-space-between align-center py-1 px-2 table-border"},ee={class:"text-grey-darken-1"},te={class:"d-flex align-center"},oe={class:"px-2"},ne=N({__name:"AddPosition",emits:["addPosition"],setup(k,{emit:v}){const i=w({dialog:!1,products:null}),s=w({name:null,products:[],isActive:!0});function d(){f.post("position",s).then(({data:l})=>{i.dialog=!1,v("addPosition",l)})}return f.get("product").then(({data:l})=>{i.products=l.map(o=>({...o,count:1}))}),F(()=>i.dialog,l=>{l&&(s.name=null,s.products=[],s.isActive=!0)}),(l,o)=>{const u=n("v-btn"),C=n("v-card-title"),x=n("v-text-field"),m=n("v-col"),c=n("v-select"),h=n("v-switch"),P=n("v-row"),b=n("v-container"),D=n("v-card-text"),y=n("v-spacer"),B=n("v-card-actions"),R=n("v-card"),S=n("v-dialog");return p(),j(P,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:t(()=>[e(S,{modelValue:i.dialog,"onUpdate:modelValue":o[4]||(o[4]=a=>i.dialog=a),persistent:"",width:"512",location:"right"},{activator:t(({props:a})=>[e(u,K({icon:"mdi-plus",color:"teal"},a),null,16)]),default:t(()=>[e(R,{tag:"form",class:"bg-white",onSubmit:I(d,["prevent"])},{default:t(()=>[e(C,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[X]),_:1}),e(D,{class:"pa-0"},{default:t(()=>[e(b,null,{default:t(()=>[e(P,null,{default:t(()=>[e(m,{cols:"12",class:"pt-0"},{default:t(()=>[e(x,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:s.name,"onUpdate:modelValue":o[0]||(o[0]=a=>s.name=a),required:""},null,8,["modelValue"])]),_:1}),e(m,{cols:"12",class:"pt-0"},{default:t(()=>[e(c,{color:"teal",items:i.products,variant:"underlined","hide-details":"auto",modelValue:s.products,"onUpdate:modelValue":o[1]||(o[1]=a=>s.products=a),label:"Biriktirilgan buyumlar","item-title":"name","item-value":a=>a,multiple:"",required:""},null,8,["items","modelValue","item-value"])]),_:1}),e(m,{cols:"12",class:"py-4"},{default:t(()=>[(p(!0),g(E,null,q(s.products,a=>(p(),g("div",Z,[_("span",ee,V(a.name),1),_("main",te,[e(u,{icon:"mdi-menu-left",density:"compact",elevation:"0",onClick:U=>A(z)(a),disabled:a.count==1},null,8,["onClick","disabled"]),_("span",oe,V(a.count),1),e(u,{icon:"mdi-menu-right",density:"compact",elevation:"0",onClick:U=>A(L)(a)},null,8,["onClick"])])]))),256))]),_:1}),e(m,{cols:"12",class:"pt-0"},{default:t(()=>[e(h,{label:"Faolligi",modelValue:s.isActive,"onUpdate:modelValue":o[2]||(o[2]=a=>s.isActive=a),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(B,null,{default:t(()=>[e(y),e(u,{color:"blue-gray-1",variant:"text",type:"button",onClick:o[3]||(o[3]=a=>i.dialog=!1)},{default:t(()=>[$(" Yopish ")]),_:1}),e(u,{color:"blue-darken-1",variant:"text",type:"submit"},{default:t(()=>[$(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}}}),le=_("span",null,"Lavozim kiritish formasi",-1),ae={class:"w-100 d-flex justify-space-between align-center py-1 px-2 table-border"},se={class:"text-grey-darken-1"},ie={class:"d-flex align-center"},ce={class:"px-2"},de=N({__name:"EditPosition",props:["current"],emits:["editPosition"],setup(k,{expose:v,emit:i}){const{current:s}=k,d=w({dialog:!1,products:null}),l=w({name:null,products:[],isActive:!1});f.get("product").then(({data:m})=>{d.products=m.map(c=>({...c,count:1}))});function o(){f.patch(`position/${s.selected}`,l).then(({data:m})=>{d.dialog=!1,i("editPosition",m)})}function u(m){f.get(`position/${m}`).then(({data:c})=>{l.name=c.name,l.products=c.products.map(h=>({...h.product,count:h.count})),l.isActive=!!c.isActive})}function C(){s.selected=null,l.name=null,l.products=[],l.isActive=!1}return F(()=>d.dialog,m=>{m?u(s.selected):C()}),v({toggle:()=>d.dialog=!0}),(m,c)=>{const h=n("v-card-title"),P=n("v-text-field"),b=n("v-col"),D=n("v-select"),y=n("v-btn"),B=n("v-switch"),R=n("v-row"),S=n("v-container"),a=n("v-card-text"),U=n("v-spacer"),G=n("v-card-actions"),T=n("v-card"),Y=n("v-dialog");return p(),j(Y,{modelValue:d.dialog,"onUpdate:modelValue":c[4]||(c[4]=r=>d.dialog=r),persistent:"",width:"512",location:"right"},{default:t(()=>[e(T,{tag:"form",class:"bg-white",onSubmit:I(o,["prevent"])},{default:t(()=>[e(h,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[le]),_:1}),e(a,{class:"pa-0"},{default:t(()=>[e(S,null,{default:t(()=>[e(R,null,{default:t(()=>[e(b,{cols:"12",class:"pt-0"},{default:t(()=>[e(P,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:l.name,"onUpdate:modelValue":c[0]||(c[0]=r=>l.name=r),required:""},null,8,["modelValue"])]),_:1}),e(b,{cols:"12",class:"pt-0"},{default:t(()=>[e(D,{color:"teal",items:d.products,variant:"underlined","hide-details":"auto",modelValue:l.products,"onUpdate:modelValue":c[1]||(c[1]=r=>l.products=r),label:"Biriktirilgan buyumlar","item-title":"name","item-value":r=>r,multiple:"",required:""},null,8,["items","modelValue","item-value"])]),_:1}),e(b,{cols:"12",class:"py-4"},{default:t(()=>[(p(!0),g(E,null,q(l.products,r=>(p(),g("div",ae,[_("span",se,V(r.name),1),_("main",ie,[e(y,{icon:"mdi-menu-left",density:"compact",elevation:"0",onClick:M=>A(z)(r),disabled:r.count==1},null,8,["onClick","disabled"]),_("span",ce,V(r.count),1),e(y,{icon:"mdi-menu-right",density:"compact",elevation:"0",onClick:M=>A(L)(r)},null,8,["onClick"])])]))),256))]),_:1}),e(b,{cols:"12",class:"pt-0"},{default:t(()=>[e(B,{label:"Faolligi",modelValue:l.isActive,"onUpdate:modelValue":c[2]||(c[2]=r=>l.isActive=r),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(U),e(y,{color:"blue-gray-1",variant:"text",type:"button",onClick:c[3]||(c[3]=r=>d.dialog=!1)},{default:t(()=>[$(" Yopish ")]),_:1}),e(y,{color:"blue-darken-1",variant:"text",type:"submit"},{default:t(()=>[$(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])}}}),re={class:"text-teal pl-2"},ue=N({__name:"PositionProducts",props:["params"],setup(k){return(v,i)=>{const s=n("v-chip");return p(),g("main",null,[(p(!0),g(E,null,q(k.params.data.products,d=>(p(),j(s,{size:"small",label:"",key:d,class:"mx-1"},{default:t(()=>[$(V(d.product.name)+" ",1),_("span",re,"x"+V(d.count),1)]),_:2},1024))),128))])}}}),me={class:"d-flex flex-column"},pe={class:"d-flex justify-space-between items-center"},he=N({__name:"Positions",setup(k){const v=O(),i=w({gridApi:null,selected:null,positions:[]});function s(o){i.gridApi.applyTransaction({add:[o],addIndex:0})}function d(o){i.gridApi.getRowNode(o.id).setData(o)}const l=w([{field:"id",headerName:"â„–",width:65},{field:"name",headerName:"Nomi"},{headerName:"Biriktirilgan maxsulotlar",flex:1,cellRenderer:ue},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:Q,width:60,headerClass:["px-2"],onCellClicked:o=>{const u=+!o.value;f.post(`position/set_activate/${o.data.id}`,{active:u}).then(()=>{o.node.setDataValue("isActive",u)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:W,headerClass:["px-2"],onCellClicked:({data:o})=>{i.selected=o.id,v.value.toggle()}}]);return f.get("position").then(({data:o})=>i.positions=o),(o,u)=>{const C=n("v-spacer");return p(),g("section",me,[_("div",pe,[e(H),e(ne,{onAddPosition:s}),e(de,{onEditPosition:d,ref_key:"editComponent",ref:v,current:i},null,8,["current"])]),e(C,{class:"px-4"},{default:t(()=>[e(A(J),{class:"ag-theme-material h-100",getRowId:({data:x})=>x.id,columnDefs:l,rowData:i.positions,onGridReady:u[0]||(u[0]=x=>i.gridApi=x.api),animateRows:!0},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{he as default};
