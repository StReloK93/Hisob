import{I as L}from"./IconEdit-cefb1ea4.js";import{d as F,a as t,o as v,h,F as B,k as q,c as P,l as j,r as S,w as o,b as e,p as J,j as z,g as H,f as C,m as k,n as K}from"./app-eb415e53.js";const O={class:"d-flex item-center"},Q=F({__name:"FileIcons",props:["params"],setup(N){return(b,d)=>{const s=t("v-btn");return v(),h("div",O,[(v(!0),h(B,null,q(N.params.value,r=>(v(),P(s,{tag:"a",href:`/files/${r.src}`,target:"_blank",color:"teal",icon:"mdi-file-pdf-box",class:"mr-1",size:"small"},null,8,["href"]))),256))])}}}),W={class:"text-subtitle-1 d-flex justify-space-between align-center mb-2"},X=C("span",null," Ish turlari ",-1),Y={class:"d-flex flex-wrap bg-grey-lighten-4 mb-1"},Z=F({__name:"AddDocument",emits:["addDocument"],setup(N,{emit:b}){const d=j({dialog:!1,rules:[p=>[null,""].includes(p)?"toldiring":!0]}),s=j({name:null,confirm_date:null,description:null,files:[],positionTypes:[]});function r(){s.positionTypes.push({name:"",code:""})}function n(p){s.positionTypes.splice(p,1)}const c=S();async function V(){const{valid:p}=await c.value.validate();if(p==!1)return;const a=new FormData;a.append("name",s.name),a.append("confirm_date",s.confirm_date),a.append("description",s.description==null?"":s.description),s.files.forEach(f=>a.append("files[]",f)),k.post("document",a).then(({data:f})=>{d.dialog=!1,b("addDocument",f)})}return(p,a)=>{const f=t("v-btn"),y=t("v-card-title"),m=t("v-textarea"),l=t("v-text-field"),_=t("v-file-input"),g=t("v-col"),D=t("v-row"),T=t("v-container"),x=t("v-card-text"),U=t("FormFooter"),I=t("v-form"),A=t("v-card"),E=t("v-dialog");return v(),P(D,{justify:"end",class:"ma-0 pb-2 px-4"},{default:o(()=>[e(E,{modelValue:d.dialog,"onUpdate:modelValue":a[6]||(a[6]=i=>d.dialog=i),persistent:"",width:"992",location:"right"},{activator:o(({props:i})=>[e(f,J({icon:"mdi-plus"},i),null,16)]),default:o(()=>[e(A,{class:"bg-white"},{default:o(()=>[e(I,{ref_key:"formTag",ref:c,onSubmit:z(V,["prevent"]),onVnodeMounted:a[5]||(a[5]=i=>c.value.reset())},{default:o(()=>[e(y,null,{default:o(()=>[H(" Normaviy hujjat kiritish ")]),_:1}),e(x,{class:"pa-0"},{default:o(()=>[e(T,null,{default:o(()=>[e(D,null,{default:o(()=>[e(g,{cols:"6",class:"pt-0"},{default:o(()=>[e(m,{class:"mb-2",label:"Nomi",modelValue:s.name,"onUpdate:modelValue":a[0]||(a[0]=i=>s.name=i),rules:d.rules},null,8,["modelValue","rules"]),e(l,{class:"mb-2",label:"Hujjat tasdiqlangan sana",modelValue:s.confirm_date,"onUpdate:modelValue":a[1]||(a[1]=i=>s.confirm_date=i),type:"date",rules:d.rules},null,8,["modelValue","rules"]),e(_,{class:"mb-2",chips:"",modelValue:s.files,"onUpdate:modelValue":a[2]||(a[2]=i=>s.files=i),multiple:"",label:"Normaviy hujjatlar",rules:d.rules},null,8,["modelValue","rules"]),e(m,{class:"mb-2",label:"Izoh",modelValue:s.description,"onUpdate:modelValue":a[3]||(a[3]=i=>s.description=i)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6",class:"pt-0"},{default:o(()=>[C("h2",W,[X,e(f,{density:"comfortable",icon:"mdi-plus",onClick:r})]),(v(!0),h(B,null,q(s.positionTypes,(i,R)=>(v(),h("section",Y,[e(g,{cols:"12",class:"pt-1 pb-0 d-flex justify-end"},{default:o(()=>[e(f,{color:"red",density:"compact",onClick:w=>n(R),variant:"text",icon:"mdi-close"},null,8,["onClick"])]),_:2},1024),e(g,{cols:"4",class:"pb-1 pt-0"},{default:o(()=>[e(l,{density:"compact",class:"mb-2",label:"Tartib raqami",hideDetails:!0,modelValue:i.code,"onUpdate:modelValue":w=>i.code=w,rules:d.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(g,{cols:"8",class:"pb-1 pt-0"},{default:o(()=>[e(l,{density:"compact",class:"mb-2",label:"Nomi",hideDetails:!0,modelValue:i.name,"onUpdate:modelValue":w=>i.name=w,rules:d.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]))),256))]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{onClose:a[4]||(a[4]=i=>d.dialog=!1)})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),ee={class:"text-subtitle-1 d-flex justify-space-between align-center mb-2"},te=C("span",null," Ish turlari ",-1),le={class:"d-flex flex-wrap bg-grey-lighten-4 mb-1"},oe=F({__name:"EditDocument",props:["current"],emits:["editDocument"],setup(N,{expose:b,emit:d}){const{current:s}=N,r=j({dialog:!1,rules:[m=>[null,""].includes(m)?"toldiring":!0]}),n=j({name:null,confirm_date:null,description:null,positionTypes:[],files:[]});function c(){n.positionTypes.push({name:"",code:""})}function V(m){n.positionTypes.splice(m,1)}const p=S();async function a(){const{valid:m}=await p.value.validate();if(m==!1)return;const l=new FormData;l.append("name",n.name),l.append("confirm_date",n.confirm_date),l.append("description",n.description==null?"":n.description),n.files.forEach(_=>{_.type?l.append("files[]",_):l.append("files[]",_.id)}),k.post(`document/${s.selected}`,l).then(({data:_})=>{r.dialog=!1,d("editDocument",_)})}function f(m){k.get(`/document/${m}`).then(({data:l})=>{n.name=l.name,n.confirm_date=l.confirm_date,n.description=l.description,l.files.forEach(_=>_.name=_.src),n.files=l.files})}return K(()=>r.dialog,m=>{m?f(s.selected):p.value.reset()}),b({toggle:()=>r.dialog=!0}),(m,l)=>{const _=t("v-card-title"),g=t("v-textarea"),D=t("v-text-field"),T=t("v-file-input"),x=t("v-col"),U=t("v-btn"),I=t("v-row"),A=t("v-container"),E=t("v-card-text"),i=t("FormFooter"),R=t("v-form"),w=t("v-card"),G=t("v-dialog");return v(),P(G,{modelValue:r.dialog,"onUpdate:modelValue":l[5]||(l[5]=u=>r.dialog=u),persistent:"",width:"992",location:"right"},{default:o(()=>[e(w,{class:"bg-white"},{default:o(()=>[e(R,{ref_key:"formTag",ref:p,onSubmit:z(a,["prevent"])},{default:o(()=>[e(_,null,{default:o(()=>[H(" Normaviy hujjatni tahrirlash ")]),_:1}),e(E,{class:"pa-0"},{default:o(()=>[e(A,null,{default:o(()=>[e(I,null,{default:o(()=>[e(x,{cols:"6",class:"pt-0"},{default:o(()=>[e(g,{class:"mb-2",label:"Nomi",modelValue:n.name,"onUpdate:modelValue":l[0]||(l[0]=u=>n.name=u),rules:r.rules},null,8,["modelValue","rules"]),e(D,{class:"mb-2",label:"Hujjat tasdiqlangan sana",modelValue:n.confirm_date,"onUpdate:modelValue":l[1]||(l[1]=u=>n.confirm_date=u),type:"date",rules:r.rules},null,8,["modelValue","rules"]),e(T,{class:"mb-2",chips:"",modelValue:n.files,"onUpdate:modelValue":l[2]||(l[2]=u=>n.files=u),multiple:"",label:"Normaviy hujjatlar",rules:r.rules},null,8,["modelValue","rules"]),e(g,{class:"mb-2",label:"Izoh",modelValue:n.description,"onUpdate:modelValue":l[3]||(l[3]=u=>n.description=u)},null,8,["modelValue"])]),_:1}),e(x,{cols:"6",class:"pt-0"},{default:o(()=>[C("h2",ee,[te,e(U,{density:"comfortable",icon:"mdi-plus",onClick:c})]),(v(!0),h(B,null,q(n.positionTypes,(u,M)=>(v(),h("section",le,[e(x,{cols:"12",class:"pt-1 pb-0 d-flex justify-end"},{default:o(()=>[e(U,{color:"red",density:"compact",onClick:$=>V(M),variant:"text",icon:"mdi-close"},null,8,["onClick"])]),_:2},1024),e(x,{cols:"4",class:"pb-1 pt-0"},{default:o(()=>[e(D,{density:"compact",class:"mb-2",label:"Tartib raqami",hideDetails:!0,modelValue:u.code,"onUpdate:modelValue":$=>u.code=$,rules:r.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(x,{cols:"8",class:"pb-1 pt-0"},{default:o(()=>[e(D,{density:"compact",class:"mb-2",label:"Nomi",hideDetails:!0,modelValue:u.name,"onUpdate:modelValue":$=>u.name=$,rules:r.rules},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]))),256))]),_:1})]),_:1})]),_:1})]),_:1}),e(i,{onClose:l[4]||(l[4]=u=>r.dialog=!1)})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}}),ne={class:"d-flex flex-column"},ae={class:"d-flex justify-space-between items-center"},ie=F({__name:"MainDocuments",setup(N){const b=S(),d=j({gridApi:null,Document:[],selected:null});function s(c){d.gridApi.applyTransaction({add:[c]})}function r(c){d.gridApi.getRowNode(c.id).setData(c)}const n=j([{field:"id",headerName:"â„–",width:65},{field:"name",headerName:"Nomi"},{field:"files",headerName:"Hujjatlar",cellRenderer:Q,valueFormatter:null,cellClass:["d-flex","align-center"]},{field:"confirm_date",headerName:"Tasdiqdan o'tgan sana"},{field:"description",headerName:"Izoh",flex:1},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:L,headerClass:["px-2"],onCellClicked:({data:c})=>{d.selected=c.id,b.value.toggle()}}]);return k.get("document").then(({data:c})=>d.Document=c),(c,V)=>{const p=t("Breadcrumbs"),a=t("AgGridVue"),f=t("v-spacer");return v(),h("section",ne,[C("div",ae,[e(p),e(Z,{onAddDocument:s}),e(oe,{onEditDocument:r,ref_key:"editComponent",ref:b,current:d},null,8,["current"])]),e(f,{class:"px-4"},{default:o(()=>[e(a,{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:y})=>y.id,columnDefs:n,rowData:d.Document,onGridReady:V[0]||(V[0]=y=>d.gridApi=y.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ie as default};
