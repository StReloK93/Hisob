import{d as D,j as g,k as m,l as B,a as l,o as U,c as R,w as t,b as e,m as T,i as S,f as b,e as $,r as q,h as E,g as F}from"./app-04b2ffd6.js";import{_ as O,A as G}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-0b580806.js";import{B as Y}from"./Button-d84b848a.js";import{I as z}from"./IconEdit-63a43e58.js";const K=$("span",null,"Mahsulot kiritish formasi",-1),L=D({__name:"AddProduct",emits:["addProduct"],setup(V,{emit:f}){const s=g({dialog:!1,products_types:null,products:null}),i=g({name:null,expiration_date:null,product_type:null,isActive:!0});function u(){m.post("product",i).then(({data:o})=>{s.dialog=!1,f("addProduct",o)})}return m.get("product_type").then(({data:o})=>{s.products_types=o.map(a=>({...a,count:1}))}),m.get("product").then(({data:o})=>{s.products=o.map(a=>a.name)}),B(()=>s.dialog,o=>{o&&(i.name=null,i.product_type=null,i.expiration_date=null,i.isActive=!0)}),(o,a)=>{const d=l("v-btn"),_=l("v-card-title"),x=l("v-combobox"),r=l("v-col"),n=l("v-text-field"),h=l("v-select"),y=l("v-switch"),v=l("v-row"),w=l("v-container"),A=l("v-card-text"),C=l("v-spacer"),N=l("v-card-actions"),P=l("v-card"),k=l("v-dialog");return U(),R(v,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:t(()=>[e(k,{modelValue:s.dialog,"onUpdate:modelValue":a[5]||(a[5]=c=>s.dialog=c),persistent:"",width:"512",location:"right"},{activator:t(({props:c})=>[e(d,T({icon:"mdi-plus",color:"teal"},c),null,16)]),default:t(()=>[e(P,{tag:"form",class:"bg-white",onSubmit:S(u,["prevent"])},{default:t(()=>[e(_,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[K]),_:1}),e(A,{class:"pa-0"},{default:t(()=>[e(w,null,{default:t(()=>[e(v,null,{default:t(()=>[e(r,{cols:"12",class:"pt-0"},{default:t(()=>[e(x,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",items:s.products,modelValue:i.name,"onUpdate:modelValue":a[0]||(a[0]=c=>i.name=c),required:""},null,8,["items","modelValue"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:t(()=>[e(n,{color:"teal",label:"Muddati (Oy)",variant:"underlined","hide-details":"auto",type:"number",modelValue:i.expiration_date,"onUpdate:modelValue":a[1]||(a[1]=c=>i.expiration_date=c),required:""},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:t(()=>[e(h,{color:"teal",items:s.products_types,variant:"underlined","hide-details":"auto",modelValue:i.product_type,"onUpdate:modelValue":a[2]||(a[2]=c=>i.product_type=c),label:"Turi","item-title":"name","item-value":c=>c.id,required:""},null,8,["items","modelValue","item-value"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:t(()=>[e(y,{label:"Faolligi",modelValue:i.isActive,"onUpdate:modelValue":a[3]||(a[3]=c=>i.isActive=c),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(C),e(d,{color:"blue-gray-1",variant:"text",type:"button",onClick:a[4]||(a[4]=c=>s.dialog=!1)},{default:t(()=>[b(" Yopish ")]),_:1}),e(d,{color:"blue-darken-1",variant:"text",type:"submit"},{default:t(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}}}),H=$("span",null,"Lavozim kiritish formasi",-1),J=D({__name:"EditProduct",props:["current"],emits:["editProduct"],setup(V,{expose:f,emit:s}){const{current:i}=V,u=g({dialog:!1,products_types:null}),o=g({name:null,expiration_date:null,product_type:null,isActive:!0});m.get("product_type").then(({data:r})=>{u.products_types=r.map(n=>({...n,count:1}))});function a(){m.patch(`product/${i.selected}`,o).then(({data:r})=>{u.dialog=!1,s("editProduct",r)})}function d(r){m.get(`product/${r}`).then(({data:n})=>{o.name=n.name,o.product_type=n.product_type_id,o.expiration_date=n.expiration_date,o.isActive=!!n.isActive})}function _(){o.name=null,o.product_type=null,o.expiration_date=null,o.isActive=!0}return B(()=>u.dialog,r=>{r?d(i.selected):_()}),f({toggle:()=>u.dialog=!0}),(r,n)=>{const h=l("v-card-title"),y=l("v-text-field"),v=l("v-col"),w=l("v-select"),A=l("v-switch"),C=l("v-row"),N=l("v-container"),P=l("v-card-text"),k=l("v-spacer"),c=l("v-btn"),j=l("v-card-actions"),I=l("v-card"),M=l("v-dialog");return U(),R(M,{modelValue:u.dialog,"onUpdate:modelValue":n[5]||(n[5]=p=>u.dialog=p),persistent:"",width:"512",location:"right"},{default:t(()=>[e(I,{tag:"form",class:"bg-white",onSubmit:S(a,["prevent"])},{default:t(()=>[e(h,{class:"bg-blue-grey-lighten-5"},{default:t(()=>[H]),_:1}),e(P,{class:"pa-0"},{default:t(()=>[e(N,null,{default:t(()=>[e(C,null,{default:t(()=>[e(v,{cols:"12",class:"pt-0"},{default:t(()=>[e(y,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:o.name,"onUpdate:modelValue":n[0]||(n[0]=p=>o.name=p),required:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",class:"pt-0"},{default:t(()=>[e(y,{color:"teal",label:"Muddati (Oy)",variant:"underlined","hide-details":"auto",type:"number",modelValue:o.expiration_date,"onUpdate:modelValue":n[1]||(n[1]=p=>o.expiration_date=p),required:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",class:"pt-0"},{default:t(()=>[e(w,{color:"teal",items:u.products_types,variant:"underlined","hide-details":"auto",modelValue:o.product_type,"onUpdate:modelValue":n[2]||(n[2]=p=>o.product_type=p),label:"Turi","item-title":"name","item-value":p=>p.id,required:""},null,8,["items","modelValue","item-value"])]),_:1}),e(v,{cols:"12",class:"pt-0"},{default:t(()=>[e(A,{label:"Faolligi",modelValue:o.isActive,"onUpdate:modelValue":n[3]||(n[3]=p=>o.isActive=p),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:t(()=>[e(k),e(c,{color:"blue-gray-1",variant:"text",type:"button",onClick:n[4]||(n[4]=p=>u.dialog=!1)},{default:t(()=>[b(" Yopish ")]),_:1}),e(c,{color:"blue-darken-1",variant:"text",type:"submit"},{default:t(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])}}}),Q={class:"d-flex flex-column"},W={class:"d-flex justify-space-between items-center"},oe=D({__name:"Products",setup(V){const f=q(),s=g({selected:null,gridApi:null});function i(d){s.gridApi.applyTransaction({add:[d],addIndex:0})}function u(d){s.gridApi.getRowNode(d.id).setData(d)}const o=g([{field:"id",headerName:"Kod",width:80},{field:"name",headerName:"Nomi",flex:1},{field:"expiration_date",headerName:"Muddati (Oy)"},{field:"product_type.name",headerName:"Turi"},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:Y,width:60,headerClass:["px-2"],onCellClicked:d=>{const _=+!d.value;m.post(`product/set_activate/${d.data.id}`,{active:_}).then(()=>{d.node.setDataValue("isActive",_)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:z,headerClass:["px-2"],onCellClicked:({data:d})=>{s.selected=d.id,f.value.toggle()}}]),a=q([]);return m.get("product").then(({data:d})=>a.value=d),(d,_)=>{const x=l("v-spacer");return U(),E("section",Q,[$("div",W,[e(O),e(L,{onAddProduct:i}),e(J,{onEditProduct:u,ref_key:"editComponent",ref:f,current:s},null,8,["current"])]),e(x,{class:"px-4"},{default:t(()=>[e(F(G),{class:"ag-theme-material h-100",getRowId:({data:r})=>r.id,columnDefs:o,rowData:a.value,onGridReady:_[0]||(_[0]=r=>s.gridApi=r.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{oe as default};
