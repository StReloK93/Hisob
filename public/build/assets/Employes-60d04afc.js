import{d as S,r as k,j as h,k as c,l as j,a as t,o as $,c as T,w as l,b as e,m as G,i as B,f as I,e as R,n as X,h as Y,g as L}from"./app-cb4a4c21.js";import{I as J}from"./IconEdit-b0d31a9e.js";import{_ as M,A as P}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-1dc78a55.js";const K=R("span",null,"Xodim kiritish",-1),O=S({__name:"AddEmploye",emits:["addEmploye"],setup(x,{emit:v}){const p=k(),r=h({dialog:!1,organizations:null,positions:null,inputLoading:!1,rules:[o=>o==null||o==""?"toldiring":!0]}),n=h({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,organization_id:null});async function u(){const{valid:o}=await p.value.validate();o!=!1&&c.post("employe",n).then(({data:i})=>{r.dialog=!1,v("addEmploye",i)})}function a(){n.table_number.length==5&&(r.inputLoading=!0,b())}function b(){c.get(`employe/getdata/${n.table_number}`).then(({data:o})=>{n.name=o.name,n.organization_id=o.organization_id,setTimeout(()=>r.inputLoading=!1,1e3)}).catch(()=>{r.inputLoading=!1})}return c.all([c.get("organization"),c.get("position")]).then(c.spread(({data:o},{data:i})=>{r.organizations=o,r.positions=i})),j(()=>r.dialog,o=>{o&&(n.table_number=null,n.name=null,n.position_id=null,n.hiring_date=null,n.gender=null,n.organization_id=null)}),(o,i)=>{const y=t("v-btn"),s=t("v-card-title"),d=t("v-text-field"),f=t("v-col"),V=t("v-select"),g=t("v-radio"),z=t("v-radio-group"),w=t("v-row"),N=t("v-container"),U=t("v-card-text"),C=t("v-spacer"),D=t("v-card-actions"),A=t("v-form"),E=t("v-card"),q=t("v-dialog");return $(),T(w,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:l(()=>[e(q,{modelValue:r.dialog,"onUpdate:modelValue":i[7]||(i[7]=m=>r.dialog=m),persistent:"",width:"512",location:"right"},{activator:l(({props:m})=>[e(y,G({icon:"mdi-plus",color:"teal"},m),null,16)]),default:l(()=>[e(E,null,{default:l(()=>[e(A,{ref_key:"form",ref:p,"fast-fail":"",class:"bg-white",onSubmit:B(u,["prevent"])},{default:l(()=>[e(s,{class:"bg-blue-grey-lighten-5"},{default:l(()=>[K]),_:1}),e(U,{class:"pa-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(w,null,{default:l(()=>[e(f,{cols:"12",class:"pt-0"},{default:l(()=>[e(d,{onInput:a,loading:r.inputLoading,color:"teal",rules:r.rules,label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:n.table_number,"onUpdate:modelValue":i[0]||(i[0]=m=>n.table_number=m),type:"number"},null,8,["loading","rules","modelValue"])]),_:1}),e(f,{cols:"12",class:"pt-0"},{default:l(()=>[e(d,{color:"teal",rules:r.rules,label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:n.name,"onUpdate:modelValue":i[1]||(i[1]=m=>n.name=m)},null,8,["rules","modelValue"])]),_:1}),e(f,{cols:"12",class:"pt-0"},{default:l(()=>[e(V,{color:"teal",items:r.organizations,variant:"underlined","hide-details":"auto",modelValue:n.organization_id,"onUpdate:modelValue":i[2]||(i[2]=m=>n.organization_id=m),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:r.rules},null,8,["items","modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:l(()=>[e(V,{color:"teal",items:r.positions,variant:"underlined","hide-details":"auto",modelValue:n.position_id,"onUpdate:modelValue":i[3]||(i[3]=m=>n.position_id=m),label:"Lavozimi","item-title":"name",rules:r.rules,"item-value":"id"},null,8,["items","modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:l(()=>[e(d,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:n.hiring_date,"onUpdate:modelValue":i[4]||(i[4]=m=>n.hiring_date=m),type:"date",rules:r.rules},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:l(()=>[e(z,{color:"teal",class:"",small:"",modelValue:n.gender,"onUpdate:modelValue":i[5]||(i[5]=m=>n.gender=m),"hide-details":"auto",rules:r.rules},{default:l(()=>[e(g,{label:"Erkak",value:"1"}),e(g,{label:"Ayol",value:"0"})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:l(()=>[e(C),e(y,{color:"blue-gray-1",variant:"text",type:"button",onClick:i[6]||(i[6]=m=>r.dialog=!1)},{default:l(()=>[I(" Yopish ")]),_:1}),e(y,{color:"teal",variant:"text",type:"submit"},{default:l(()=>[I(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Q=R("span",null,"Xodim ma'lumotlarini o'zgartirish",-1),W=S({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(x,{expose:v,emit:p}){const{current:r}=x,n=k(),u=h({dialog:!1,organizations:null,positions:null,rules:[s=>s==null||s==""?"toldiring":!0]}),a=h({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,organization_id:null});function b(){c.get(`employe/${r.selected}`).then(({data:s})=>{const d=s.position.at(-1);d&&(a.position_id=d.position.id),a.table_number=s.table_number,a.name=s.name,a.hiring_date=s.hiring_date,a.gender=s.gender,a.organization_id=s.organization_id})}async function o(){const{valid:s}=await n.value.validate();s!=!1&&c.patch(`employe/${r.selected}`,a).then(({data:d})=>{u.dialog=!1,p("editEmploye",d)})}c.all([c.get("organization"),c.get("position")]).then(c.spread(({data:s},{data:d})=>{u.organizations=s,u.positions=d}));function i(){a.table_number=null,a.name=null,a.position_id=null,a.hiring_date=null,a.gender=null,a.organization_id=null}return j(()=>u.dialog,s=>{s?b():i()}),v({toggle:()=>u.dialog=!0}),(s,d)=>{const f=t("v-card-title"),V=t("v-text-field"),g=t("v-col"),z=t("v-select"),w=t("v-radio"),N=t("v-radio-group"),U=t("v-row"),C=t("v-container"),D=t("v-card-text"),A=t("v-spacer"),E=t("v-btn"),q=t("v-card-actions"),m=t("v-form"),F=t("v-card"),H=t("v-dialog");return $(),T(H,{modelValue:u.dialog,"onUpdate:modelValue":d[7]||(d[7]=_=>u.dialog=_),persistent:"",width:"512",location:"right"},{default:l(()=>[e(F,null,{default:l(()=>[e(m,{ref_key:"form",ref:n,class:"bg-white",onSubmit:B(o,["prevent"])},{default:l(()=>[e(f,{class:"bg-blue-grey-lighten-5"},{default:l(()=>[Q]),_:1}),e(D,{class:"pa-0"},{default:l(()=>[e(C,null,{default:l(()=>[e(U,null,{default:l(()=>[e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(V,{color:"teal",label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:a.table_number,"onUpdate:modelValue":d[0]||(d[0]=_=>a.table_number=_),type:"number",rules:u.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(V,{color:"teal",label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:a.name,"onUpdate:modelValue":d[1]||(d[1]=_=>a.name=_),rules:u.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(z,{color:"teal",items:u.organizations,variant:"underlined","hide-details":"auto",modelValue:a.organization_id,"onUpdate:modelValue":d[2]||(d[2]=_=>a.organization_id=_),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:u.rules},null,8,["items","modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(z,{color:"teal",items:u.positions,variant:"underlined","hide-details":"auto",modelValue:a.position_id,"onUpdate:modelValue":d[3]||(d[3]=_=>a.position_id=_),label:"Lavozimi","item-title":"name","item-value":"id",rules:u.rules},null,8,["items","modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(V,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:a.hiring_date,"onUpdate:modelValue":d[4]||(d[4]=_=>a.hiring_date=_),type:"date",rules:u.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(N,{color:"teal",small:"",modelValue:a.gender,"onUpdate:modelValue":d[5]||(d[5]=_=>a.gender=_),"hide-details":"auto"},{default:l(()=>[e(w,{label:"Erkak",value:1}),e(w,{label:"Ayol",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(q,null,{default:l(()=>[e(A),e(E,{color:"blue-gray-1",variant:"text",type:"button",onClick:d[6]||(d[6]=_=>u.dialog=!1)},{default:l(()=>[I(" Yopish ")]),_:1}),e(E,{color:"blue-darken-1",variant:"text",type:"submit"},{default:l(()=>[I(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}});function Z(x){return x?"Erkak":"Ayol"}const ee={class:"d-flex flex-column"},le={class:"d-flex justify-space-between items-center"},ne=S({__name:"Employes",setup(x){const v=k(),p=h({gridApi:null,selected:null});function r(o){p.gridApi.applyTransaction({add:[o],addIndex:0})}function n(o){p.gridApi.getRowNode(o.id).setData(o)}const u=X(),a=h([{field:"table_number",headerName:"Tabel raqami",sortable:!0},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:o=>o.value.at(-1)?o.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:o=>Z(o.value),sortable:!0,width:100},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:J,headerClass:["px-2"],onCellClicked:({data:o})=>{p.selected=o.id,v.value.toggle()}}]),b=k([]);return c.get("employe").then(({data:o})=>b.value=o),(o,i)=>{const y=t("v-spacer");return $(),Y("main",ee,[R("div",le,[e(M),e(O,{onAddEmploye:r}),e(W,{onEditEmploye:n,ref_key:"editComponent",ref:v,current:p},null,8,["current"])]),e(y,{class:"px-4"},{default:l(()=>[e(L(P),{class:"ag-theme-material h-100",getRowId:({data:s})=>s.id,columnDefs:a,rowData:b.value,onGridReady:i[0]||(i[0]=s=>p.gridApi=s.api),onRowDoubleClicked:i[1]||(i[1]=s=>L(u).push({name:"employe",params:{id:s.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ne as default};
