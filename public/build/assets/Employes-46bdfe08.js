import{d as S,r as E,l as z,p as f,m as j,a as i,o as $,c as T,w as a,b as e,n as H,j as O,f as U,e as R,q as K,h as G,g as L}from"./app-2de8305d.js";import{I as X}from"./IconEdit-0a8d414e.js";import{_ as Y,A as J}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-26705092.js";const M=R("span",null,"Xodim kiritish",-1),P=S({__name:"AddEmploye",emits:["addEmploye"],setup(y,{emit:b}){const h=E(),u=z({dialog:!1,organizations:null,positions:null,inputLoading:!1,rules:[m=>m==null||m==""?"toldiring":!0]}),t=z({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function _(){const{valid:m}=await h.value.validate();m!=!1&&f.post("employe",t).then(({data:n})=>{u.dialog=!1,b("addEmploye",n)})}function l(){t.table_number.length==5&&(u.inputLoading=!0,V())}function V(){f.get(`employe/getdata/${t.table_number}`).then(({data:m})=>{t.name=m.name,t.organization_id=m.organization_id,setTimeout(()=>u.inputLoading=!1,1e3)}).catch(()=>{u.inputLoading=!1})}f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:m},{data:n})=>{u.organizations=m,u.positions=n}));function p(){t.table_number=null,t.name=null,t.position_id=null,t.hiring_date=null,t.gender=null,t.heigth=null,t.size_cloth=null,t.size_head=null,t.size_shoes=null,t.organization_id=null}return j(()=>u.dialog,m=>{m&&p()}),(m,n)=>{const d=i("v-btn"),o=i("v-card-title"),v=i("v-text-field"),c=i("v-col"),g=i("v-autocomplete"),x=i("v-radio"),w=i("v-radio-group"),C=i("v-row"),N=i("v-container"),I=i("v-card-text"),q=i("v-spacer"),D=i("v-card-actions"),k=i("v-form"),A=i("v-card"),B=i("v-dialog");return $(),T(C,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:a(()=>[e(B,{modelValue:u.dialog,"onUpdate:modelValue":n[11]||(n[11]=s=>u.dialog=s),persistent:"",width:"512",location:"right"},{activator:a(({props:s})=>[e(d,H({icon:"mdi-plus",color:"teal"},s),null,16)]),default:a(()=>[e(A,null,{default:a(()=>[e(k,{ref_key:"form",ref:h,"fast-fail":"",class:"bg-white",onSubmit:O(_,["prevent"])},{default:a(()=>[e(o,{class:"bg-blue-grey-lighten-5"},{default:a(()=>[M]),_:1}),e(I,{class:"pa-0"},{default:a(()=>[e(N,null,{default:a(()=>[e(C,null,{default:a(()=>[e(c,{cols:"12",class:"pt-0"},{default:a(()=>[e(v,{onInput:l,loading:u.inputLoading,color:"teal",rules:u.rules,label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:t.table_number,"onUpdate:modelValue":n[0]||(n[0]=s=>t.table_number=s),type:"number"},null,8,["loading","rules","modelValue"])]),_:1}),e(c,{cols:"12",class:"pt-0"},{default:a(()=>[e(v,{color:"teal",rules:u.rules,label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:t.name,"onUpdate:modelValue":n[1]||(n[1]=s=>t.name=s)},null,8,["rules","modelValue"])]),_:1}),e(c,{cols:"12",class:"pt-0"},{default:a(()=>[e(g,{color:"teal",items:u.organizations,variant:"underlined","hide-details":"auto",modelValue:t.organization_id,"onUpdate:modelValue":n[2]||(n[2]=s=>t.organization_id=s),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:u.rules},null,8,["items","modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(g,{color:"teal",items:u.positions,variant:"underlined","hide-details":"auto",modelValue:t.position_id,"onUpdate:modelValue":n[3]||(n[3]=s=>t.position_id=s),label:"Lavozimi","item-title":"name",rules:u.rules,"item-value":"id"},null,8,["items","modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(v,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:t.hiring_date,"onUpdate:modelValue":n[4]||(n[4]=s=>t.hiring_date=s),type:"date",rules:u.rules},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(v,{color:"teal",label:"Bo'yi",variant:"underlined","hide-details":"auto",modelValue:t.heigth,"onUpdate:modelValue":n[5]||(n[5]=s=>t.heigth=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(v,{color:"teal",label:"Bosh o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_head,"onUpdate:modelValue":n[6]||(n[6]=s=>t.size_head=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(v,{color:"teal",label:"Kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_cloth,"onUpdate:modelValue":n[7]||(n[7]=s=>t.size_cloth=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:a(()=>[e(v,{color:"teal",label:"Oyoq kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_shoes,"onUpdate:modelValue":n[8]||(n[8]=s=>t.size_shoes=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(w,{color:"teal",class:"",small:"",modelValue:t.gender,"onUpdate:modelValue":n[9]||(n[9]=s=>t.gender=s),"hide-details":"auto",rules:u.rules},{default:a(()=>[e(x,{label:"Erkak",value:!0}),e(x,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:a(()=>[e(q),e(d,{color:"blue-gray-1",variant:"text",type:"button",onClick:n[10]||(n[10]=s=>u.dialog=!1)},{default:a(()=>[U(" Yopish ")]),_:1}),e(d,{color:"teal",variant:"text",type:"submit"},{default:a(()=>[U(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),W=R("span",null,"Xodim ma'lumotlarini o'zgartirish",-1),Q=S({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(y,{expose:b,emit:h}){const{current:u}=y,t=E(),_=z({dialog:!1,organizations:null,positions:null,rules:[d=>d==null||d==""?"toldiring":!0]}),l=z({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function V(){f.get(`employe/${u.selected}`).then(({data:d})=>{const o=d.position.at(-1);o&&(l.position_id=o.position.id),l.table_number=d.table_number,l.name=d.name,l.hiring_date=d.hiring_date,l.gender=d.gender,l.heigth=d.heigth,l.size_cloth=d.size_cloth,l.size_head=d.size_head,l.size_shoes=d.size_shoes,l.organization_id=d.organization_id})}async function p(){const{valid:d}=await t.value.validate();d!=!1&&f.patch(`employe/${u.selected}`,l).then(({data:o})=>{_.dialog=!1,h("editEmploye",o)})}f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:d},{data:o})=>{_.organizations=d,_.positions=o}));function m(){l.table_number=null,l.name=null,l.position_id=null,l.hiring_date=null,l.gender=null,l.heigth=null,l.size_cloth=null,l.size_head=null,l.size_shoes=null,l.organization_id=null}return j(()=>_.dialog,d=>{d?V():m()}),b({toggle:()=>_.dialog=!0}),(d,o)=>{const v=i("v-card-title"),c=i("v-text-field"),g=i("v-col"),x=i("v-autocomplete"),w=i("v-radio"),C=i("v-radio-group"),N=i("v-row"),I=i("v-container"),q=i("v-card-text"),D=i("v-spacer"),k=i("v-btn"),A=i("v-card-actions"),B=i("v-form"),s=i("v-card"),F=i("v-dialog");return $(),T(F,{modelValue:_.dialog,"onUpdate:modelValue":o[11]||(o[11]=r=>_.dialog=r),persistent:"",width:"512",location:"right"},{default:a(()=>[e(s,null,{default:a(()=>[e(B,{ref_key:"form",ref:t,class:"bg-white",onSubmit:O(p,["prevent"])},{default:a(()=>[e(v,{class:"bg-blue-grey-lighten-5"},{default:a(()=>[W]),_:1}),e(q,{class:"pa-0"},{default:a(()=>[e(I,null,{default:a(()=>[e(N,null,{default:a(()=>[e(g,{cols:"12",class:"pt-0"},{default:a(()=>[e(c,{color:"teal",label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:l.table_number,"onUpdate:modelValue":o[0]||(o[0]=r=>l.table_number=r),type:"number",rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:a(()=>[e(c,{color:"teal",label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:l.name,"onUpdate:modelValue":o[1]||(o[1]=r=>l.name=r),rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:a(()=>[e(x,{color:"teal",items:_.organizations,variant:"underlined","hide-details":"auto",modelValue:l.organization_id,"onUpdate:modelValue":o[2]||(o[2]=r=>l.organization_id=r),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:_.rules},null,8,["items","modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:a(()=>[e(x,{color:"teal",items:_.positions,variant:"underlined","hide-details":"auto",modelValue:l.position_id,"onUpdate:modelValue":o[3]||(o[3]=r=>l.position_id=r),label:"Lavozimi","item-title":"name","item-value":"id",rules:_.rules},null,8,["items","modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:a(()=>[e(c,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:l.hiring_date,"onUpdate:modelValue":o[4]||(o[4]=r=>l.hiring_date=r),type:"date",rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"6"},{default:a(()=>[e(c,{color:"teal",label:"Bo'yi",variant:"underlined","hide-details":"auto",modelValue:l.heigth,"onUpdate:modelValue":o[5]||(o[5]=r=>l.heigth=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:a(()=>[e(c,{color:"teal",label:"Bosh o'lchami",variant:"underlined","hide-details":"auto",modelValue:l.size_head,"onUpdate:modelValue":o[6]||(o[6]=r=>l.size_head=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:a(()=>[e(c,{color:"teal",label:"Kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:l.size_cloth,"onUpdate:modelValue":o[7]||(o[7]=r=>l.size_cloth=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:a(()=>[e(c,{color:"teal",label:"Oyoq kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:l.size_shoes,"onUpdate:modelValue":o[8]||(o[8]=r=>l.size_shoes=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:a(()=>[e(C,{color:"teal",small:"",modelValue:l.gender,"onUpdate:modelValue":o[9]||(o[9]=r=>l.gender=r),"hide-details":"auto"},{default:a(()=>[e(w,{label:"Erkak",value:!0}),e(w,{label:"Ayol",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(D),e(k,{color:"blue-gray-1",variant:"text",type:"button",onClick:o[10]||(o[10]=r=>_.dialog=!1)},{default:a(()=>[U(" Yopish ")]),_:1}),e(k,{color:"blue-darken-1",variant:"text",type:"submit"},{default:a(()=>[U(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}});function Z(y){return y?"Erkak":"Ayol"}const ee={class:"d-flex flex-column"},le={class:"d-flex justify-space-between items-center"},ne=S({__name:"Employes",setup(y){const b=E(),h=z({gridApi:null,selected:null});function u(p){h.gridApi.applyTransaction({add:[p],addIndex:0})}function t(p){h.gridApi.getRowNode(p.id).setData(p)}const _=K(),l=z([{field:"table_number",headerName:"Tabel №",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:p=>p.value.at(-1)?p.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:p=>Z(p.value),sortable:!0,width:60,headerClass:["px-2"],cellClass:["px-2"]},{field:"heigth",headerName:"Bo'yi (sm)",sortable:!0,width:85,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_head",headerName:"Bosh o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_cloth",headerName:"Kiyim o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_shoes",headerName:"Oyoq kiyim o'lch..",sortable:!0,width:125,headerClass:["px-2"],cellClass:["px-2"]},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:X,headerClass:["px-2"],onCellClicked:({data:p})=>{h.selected=p.id,b.value.toggle()}}]),V=E([]);return f.get("employe").then(({data:p})=>V.value=p),(p,m)=>{const n=i("v-spacer");return $(),G("main",ee,[R("div",le,[e(Y),e(P,{onAddEmploye:u}),e(Q,{onEditEmploye:t,ref_key:"editComponent",ref:b,current:h},null,8,["current"])]),e(n,{class:"px-4"},{default:a(()=>[e(L(J),{class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:d})=>d.id,columnDefs:l,rowData:V.value,onGridReady:m[0]||(m[0]=d=>h.gridApi=d.api),onRowDoubleClicked:m[1]||(m[1]=d=>L(_).push({name:"employe",params:{id:d.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ne as default};
