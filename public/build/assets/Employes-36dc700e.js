import{_ as w}from"./Icon.vue_vue_type_script_setup_true_lang-2b491ab6.js";import{d as z,a as s,o as y,c as x,w as m,e as t,g as _,m as f,l as D,n as A,p as I,u as j,r as C,q as $,h as B,b as k,i as F}from"./app-5751a8d8.js";import{r as v}from"./helpers-ca74a7fa.js";const E=z({__name:"FormInputs",props:["formData","pageData"],setup(l){const{formData:d,pageData:r}=l;function g(){d.table_number.length==5&&(r.inputLoading=!0,u())}function u(){f.get(`employe/getdata/${d.table_number}`).then(({data:o})=>{d.name=o.name,d.organization_id=o.organization_id,d.profession=o.profession,d.hiring_date=o.hiring_date,setTimeout(()=>r.inputLoading=!1,1e3)}).catch(()=>{r.inputLoading=!1})}return(o,a)=>{const c=s("v-text-field"),b=s("v-autocomplete"),e=s("v-col"),i=s("v-radio"),p=s("v-radio-group"),V=s("v-row");return y(),x(V,null,{default:m(()=>[t(e,{cols:"12",class:"pt-0"},{default:m(()=>[t(c,{class:"mb-2",onInput:g,loading:l.pageData.inputLoading,rules:_(v),label:"Tabel raqam",modelValue:l.formData.table_number,"onUpdate:modelValue":a[0]||(a[0]=n=>l.formData.table_number=n),type:"number"},null,8,["loading","rules","modelValue"]),t(c,{class:"mb-2",rules:_(v),label:"F.I.SH",modelValue:l.formData.name,"onUpdate:modelValue":a[1]||(a[1]=n=>l.formData.name=n)},null,8,["rules","modelValue"]),t(b,{class:"mb-2",items:l.pageData.organizations,modelValue:l.formData.organization_id,"onUpdate:modelValue":a[2]||(a[2]=n=>l.formData.organization_id=n),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:_(v)},null,8,["items","modelValue","rules"]),t(b,{class:"mb-2",items:l.pageData.positions,modelValue:l.formData.position_id,"onUpdate:modelValue":a[3]||(a[3]=n=>l.formData.position_id=n),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:_(v),"item-value":"id"},null,8,["items","modelValue","rules"]),t(c,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:l.formData.profession,"onUpdate:modelValue":a[4]||(a[4]=n=>l.formData.profession=n),rules:_(v)},null,8,["modelValue","rules"]),t(c,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:l.formData.hiring_date,"onUpdate:modelValue":a[5]||(a[5]=n=>l.formData.hiring_date=n),type:"date",rules:_(v)},null,8,["modelValue","rules"])]),_:1}),t(e,{cols:"6"},{default:m(()=>[t(c,{class:"mb-2",label:"Bo'yi",modelValue:l.formData.heigth,"onUpdate:modelValue":a[6]||(a[6]=n=>l.formData.heigth=n)},null,8,["modelValue"]),t(c,{class:"mb-2",label:"Kiyim o'lchami",modelValue:l.formData.size_cloth,"onUpdate:modelValue":a[7]||(a[7]=n=>l.formData.size_cloth=n)},null,8,["modelValue"])]),_:1}),t(e,{cols:"6"},{default:m(()=>[t(c,{class:"mb-2",label:"Bosh o'lchami",modelValue:l.formData.size_head,"onUpdate:modelValue":a[8]||(a[8]=n=>l.formData.size_head=n)},null,8,["modelValue"]),t(c,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:l.formData.size_shoes,"onUpdate:modelValue":a[9]||(a[9]=n=>l.formData.size_shoes=n)},null,8,["modelValue"])]),_:1}),t(e,{cols:"12"},{default:m(()=>[t(p,{small:"",modelValue:l.formData.gender,"onUpdate:modelValue":a[10]||(a[10]=n=>l.formData.gender=n),rules:_(v)},{default:m(()=>[t(i,{label:"Erkak",value:!0}),t(i,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})}}}),L=z({__name:"AddEmploye",emits:["addEmploye"],setup(l,{emit:d}){const r=D({dialog:!1,organizations:null,positions:null,inputLoading:!1}),g=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function u(){await f.post("employe",g).then(({data:o})=>{r.dialog=!1,d("addEmploye",o)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:o},{data:a})=>{r.organizations=o,r.positions=a})),(o,a)=>{const c=s("v-btn"),b=s("CustomForm"),e=s("v-dialog"),i=s("v-row");return y(),x(i,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:m(()=>[t(e,{modelValue:r.dialog,"onUpdate:modelValue":a[1]||(a[1]=p=>r.dialog=p),persistent:"",width:"768",location:"right"},{activator:m(({props:p})=>[t(c,A({icon:"mdi-plus",color:"teal"},p),null,16)]),default:m(()=>[t(b,{submitMethod:u,onClose:a[0]||(a[0]=p=>r.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:m(()=>[t(E,{formData:g,pageData:r},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),T=z({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(l,{expose:d,emit:r}){const{current:g}=l,u=D({dialog:!1,organizations:null,positions:null}),o=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function a(){f.get(`employe/${g.selected}`).then(({data:e})=>{const i=e.position.at(-1);i&&(o.position_id=i.position.id),o.table_number=e.table_number,o.name=e.name,o.hiring_date=e.hiring_date,o.gender=e.gender,o.heigth=e.heigth,o.profession=e.profession,o.size_cloth=e.size_cloth,o.size_head=e.size_head,o.size_shoes=e.size_shoes,o.organization_id=e.organization_id})}async function c(){await f.patch(`employe/${g.selected}`,o).then(({data:e})=>{u.dialog=!1,r("editEmploye",e)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:e},{data:i})=>{u.organizations=e,u.positions=i})),I(()=>u.dialog,e=>{e&&a()}),d({toggle:()=>u.dialog=!0}),(e,i)=>{const p=s("CustomForm"),V=s("v-dialog");return y(),x(V,{modelValue:u.dialog,"onUpdate:modelValue":i[1]||(i[1]=n=>u.dialog=n),persistent:"",width:"768",location:"right"},{default:m(()=>[t(p,{submitMethod:c,onClose:i[0]||(i[0]=n=>u.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:m(()=>[t(E,{formData:o,pageData:u},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])}}}),q={class:"d-flex flex-column"},S={class:"d-flex justify-space-between items-center"},G={class:"px-4 mb-2"},P=z({__name:"Employes",setup(l){const d=j(),r=C(),g=D({gridApi:null,selected:null});function u(e){g.gridApi.applyTransaction({add:[e],addIndex:0})}function o(e){g.gridApi.getRowNode(e.id).setData(e)}const a=$(),c=D([{field:"table_number",headerName:"Tabel â„–",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>a.push({name:"employe",params:{id:e.id}})},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>{g.selected=e.id,r.value.toggle()}}]),b=C([]);return f.get("employe").then(({data:e})=>b.value=e),(e,i)=>{const p=s("Breadcrumbs"),V=s("v-text-field"),n=s("v-col"),R=s("v-row"),U=s("AgGridVue"),N=s("v-spacer");return y(),B("main",q,[k("div",S,[t(p),_(d).userRoles.includes(4)||_(d).userRoles.includes(1)?(y(),x(L,{key:0,onAddEmploye:u})):F("",!0),t(T,{onEditEmploye:o,ref_key:"editComponent",ref:r,current:g},null,8,["current"])]),k("div",G,[t(R,{class:"d-flex justify-end"},{default:m(()=>[t(n,{cols:"3"},{default:m(()=>[t(V,{"prepend-inner-icon":"mdi-magnify",onInput:i[0]||(i[0]=h=>g.gridApi.setQuickFilter(h.target.value)),label:"Qidiruv"})]),_:1})]),_:1})]),t(N,{class:"px-4"},{default:m(()=>[t(U,{defaultColDef:{sortable:!0},class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:h})=>h.id,columnDefs:c,rowData:b.value,onGridReady:i[1]||(i[1]=h=>g.gridApi=h.api),onRowDoubleClicked:i[2]||(i[2]=h=>_(a).push({name:"employe",params:{id:h.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{P as default};
