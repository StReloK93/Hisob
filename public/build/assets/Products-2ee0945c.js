import{d as k,l as f,m as _,n as R,a as t,o as D,c as S,w as l,b as e,p as E,j,g as y,f as B,r as U,h as F,e as G}from"./app-c9a20659.js";import{B as M}from"./Button-19f04297.js";import{I as Y}from"./IconEdit-336cb755.js";import{A as z}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-e699bd52.js";const H=B("span",null,"Mahsulot kiritish formasi",-1),K=k({__name:"AddProduct",emits:["addProduct"],setup(x,{emit:v}){const s=f({dialog:!1,products_types:null,products:null,rules:[o=>o==null||o==""?"toldiring":!0]}),c=f({name:null,product_type:null,isActive:!0});function u(){_.post("product",c).then(({data:o})=>{s.dialog=!1,v("addProduct",o)})}return _.get("product_type").then(({data:o})=>{s.products_types=o.map(d=>({...d,count:1}))}),_.get("product").then(({data:o})=>{s.products=o.map(d=>d.name)}),R(()=>s.dialog,o=>{o&&(c.name=null,c.product_type=null,c.isActive=!0)}),(o,d)=>{const n=t("v-btn"),m=t("v-card-title"),b=t("v-combobox"),i=t("v-col"),a=t("v-select"),w=t("v-switch"),h=t("v-row"),g=t("v-container"),V=t("v-card-text"),A=t("v-spacer"),C=t("v-card-actions"),N=t("v-card"),P=t("v-dialog");return D(),S(h,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:l(()=>[e(P,{modelValue:s.dialog,"onUpdate:modelValue":d[4]||(d[4]=r=>s.dialog=r),persistent:"",width:"512",location:"right"},{activator:l(({props:r})=>[e(n,E({icon:"mdi-plus",color:"teal"},r),null,16)]),default:l(()=>[e(N,{tag:"form",class:"bg-white",onSubmit:j(u,["prevent"])},{default:l(()=>[e(m,{class:"bg-blue-grey-lighten-5"},{default:l(()=>[H]),_:1}),e(V,{class:"pa-0"},{default:l(()=>[e(g,null,{default:l(()=>[e(h,null,{default:l(()=>[e(i,{cols:"12",class:"pt-0"},{default:l(()=>[e(b,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",items:s.products,modelValue:c.name,"onUpdate:modelValue":d[0]||(d[0]=r=>c.name=r),required:""},null,8,["items","modelValue"])]),_:1}),e(i,{cols:"12",class:"pt-0"},{default:l(()=>[e(a,{color:"teal",items:s.products_types,variant:"underlined","hide-details":"auto",modelValue:c.product_type,"onUpdate:modelValue":d[1]||(d[1]=r=>c.product_type=r),label:"Turi","item-title":"name","item-value":r=>r.id,rules:s.rules},null,8,["items","modelValue","item-value","rules"])]),_:1}),e(i,{cols:"12",class:"pt-0"},{default:l(()=>[e(w,{label:"Faolligi",modelValue:c.isActive,"onUpdate:modelValue":d[2]||(d[2]=r=>c.isActive=r),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(C,null,{default:l(()=>[e(A),e(n,{color:"blue-gray-1",variant:"text",type:"button",onClick:d[3]||(d[3]=r=>s.dialog=!1)},{default:l(()=>[y(" Yopish ")]),_:1}),e(n,{color:"blue-darken-1",variant:"text",type:"submit"},{default:l(()=>[y(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}}}),L=B("span",null,"Lavozim kiritish formasi",-1),J=k({__name:"EditProduct",props:["current"],emits:["editProduct"],setup(x,{expose:v,emit:s}){const{current:c}=x,u=f({dialog:!1,products_types:null}),o=f({name:null,product_type:null,isActive:!0});_.get("product_type").then(({data:i})=>{u.products_types=i.map(a=>({...a,count:1}))});function d(){_.patch(`product/${c.selected}`,o).then(({data:i})=>{u.dialog=!1,s("editProduct",i)})}function n(i){_.get(`product/${i}`).then(({data:a})=>{o.name=a.name,o.product_type=a.product_type_id,o.isActive=!!a.isActive})}function m(){o.name=null,o.product_type=null,o.isActive=!0}return R(()=>u.dialog,i=>{i?n(c.selected):m()}),v({toggle:()=>u.dialog=!0}),(i,a)=>{const w=t("v-card-title"),h=t("v-text-field"),g=t("v-col"),V=t("v-select"),A=t("v-switch"),C=t("v-row"),N=t("v-container"),P=t("v-card-text"),r=t("v-spacer"),$=t("v-btn"),I=t("v-card-actions"),T=t("v-card"),q=t("v-dialog");return D(),S(q,{modelValue:u.dialog,"onUpdate:modelValue":a[4]||(a[4]=p=>u.dialog=p),persistent:"",width:"512",location:"right"},{default:l(()=>[e(T,{tag:"form",class:"bg-white",onSubmit:j(d,["prevent"])},{default:l(()=>[e(w,{class:"bg-blue-grey-lighten-5"},{default:l(()=>[L]),_:1}),e(P,{class:"pa-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(C,null,{default:l(()=>[e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(h,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:o.name,"onUpdate:modelValue":a[0]||(a[0]=p=>o.name=p),required:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(V,{color:"teal",items:u.products_types,variant:"underlined","hide-details":"auto",modelValue:o.product_type,"onUpdate:modelValue":a[1]||(a[1]=p=>o.product_type=p),label:"Turi","item-title":"name","item-value":p=>p.id},null,8,["items","modelValue","item-value"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(A,{label:"Faolligi",modelValue:o.isActive,"onUpdate:modelValue":a[2]||(a[2]=p=>o.isActive=p),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(I,null,{default:l(()=>[e(r),e($,{color:"blue-gray-1",variant:"text",type:"button",onClick:a[3]||(a[3]=p=>u.dialog=!1)},{default:l(()=>[y(" Yopish ")]),_:1}),e($,{color:"blue-darken-1",variant:"text",type:"submit"},{default:l(()=>[y(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])}}}),O={class:"d-flex flex-column"},Q={class:"d-flex justify-space-between items-center"},te=k({__name:"Products",setup(x){const v=U(),s=f({selected:null,gridApi:null});function c(n){s.gridApi.applyTransaction({add:[n],addIndex:0})}function u(n){s.gridApi.getRowNode(n.id).setData(n)}const o=f([{field:"id",headerName:"Kod",width:80},{field:"name",headerName:"Nomi",flex:1},{field:"product_type.name",headerName:"Turi"},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:M,width:60,headerClass:["px-2"],onCellClicked:n=>{_.post(`product/set_activate/${n.data.id}`,{active:!n.value}).then(()=>{n.node.setDataValue("isActive",!n.value)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:Y,headerClass:["px-2"],onCellClicked:({data:n})=>{s.selected=n.id,v.value.toggle()}}]),d=U([]);return _.get("product").then(({data:n})=>d.value=n),(n,m)=>{const b=t("Breadcrumbs"),i=t("v-spacer");return D(),F("section",O,[B("div",Q,[e(b),e(K,{onAddProduct:c}),e(J,{onEditProduct:u,ref_key:"editComponent",ref:v,current:s},null,8,["current"])]),e(i,{class:"px-4"},{default:l(()=>[e(G(z),{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:a})=>a.id,columnDefs:o,rowData:d.value,onGridReady:m[0]||(m[0]=a=>s.gridApi=a.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{te as default};
