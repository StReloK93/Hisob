import{d as D,j as g,l as _,k as R,a as l,o as U,c as S,w as o,b as e,m as q,i as j,f as b,e as $,r as B,h as E,g as F}from"./app-7beed944.js";import{_ as O,A as G}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-307e9286.js";import{B as Y}from"./Button-7d37e0ce.js";import{I as z}from"./IconEdit-385ec21c.js";const H=$("span",null,"Mahsulot kiritish formasi",-1),K=D({__name:"AddProduct",emits:["addProduct"],setup(h,{emit:f}){const i=g({dialog:!1,products_types:null,products:null,rules:[t=>t==null||t==""?"toldiring":!0]}),s=g({name:null,expiration_date:null,product_type:null,isActive:!0});function c(){_.post("product",s).then(({data:t})=>{i.dialog=!1,f("addProduct",t)})}return _.get("product_type").then(({data:t})=>{i.products_types=t.map(a=>({...a,count:1}))}),_.get("product").then(({data:t})=>{i.products=t.map(a=>a.name)}),R(()=>i.dialog,t=>{t&&(s.name=null,s.product_type=null,s.expiration_date=null,s.isActive=!0)}),(t,a)=>{const d=l("v-btn"),m=l("v-card-title"),x=l("v-combobox"),r=l("v-col"),n=l("v-text-field"),V=l("v-select"),y=l("v-switch"),v=l("v-row"),w=l("v-container"),A=l("v-card-text"),C=l("v-spacer"),N=l("v-card-actions"),P=l("v-card"),k=l("v-dialog");return U(),S(v,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:o(()=>[e(k,{modelValue:i.dialog,"onUpdate:modelValue":a[5]||(a[5]=u=>i.dialog=u),persistent:"",width:"512",location:"right"},{activator:o(({props:u})=>[e(d,q({icon:"mdi-plus",color:"teal"},u),null,16)]),default:o(()=>[e(P,{tag:"form",class:"bg-white",onSubmit:j(c,["prevent"])},{default:o(()=>[e(m,{class:"bg-blue-grey-lighten-5"},{default:o(()=>[H]),_:1}),e(A,{class:"pa-0"},{default:o(()=>[e(w,null,{default:o(()=>[e(v,null,{default:o(()=>[e(r,{cols:"12",class:"pt-0"},{default:o(()=>[e(x,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",items:i.products,modelValue:s.name,"onUpdate:modelValue":a[0]||(a[0]=u=>s.name=u),required:""},null,8,["items","modelValue"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:o(()=>[e(n,{color:"teal",label:"Muddati (Oy)",variant:"underlined","hide-details":"auto",type:"number",modelValue:s.expiration_date,"onUpdate:modelValue":a[1]||(a[1]=u=>s.expiration_date=u)},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:o(()=>[e(V,{color:"teal",items:i.products_types,variant:"underlined","hide-details":"auto",modelValue:s.product_type,"onUpdate:modelValue":a[2]||(a[2]=u=>s.product_type=u),label:"Turi","item-title":"name","item-value":u=>u.id,rules:i.rules},null,8,["items","modelValue","item-value","rules"])]),_:1}),e(r,{cols:"12",class:"pt-0"},{default:o(()=>[e(y,{label:"Faolligi",modelValue:s.isActive,"onUpdate:modelValue":a[3]||(a[3]=u=>s.isActive=u),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,null,{default:o(()=>[e(C),e(d,{color:"blue-gray-1",variant:"text",type:"button",onClick:a[4]||(a[4]=u=>i.dialog=!1)},{default:o(()=>[b(" Yopish ")]),_:1}),e(d,{color:"blue-darken-1",variant:"text",type:"submit"},{default:o(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}}}),L=$("span",null,"Lavozim kiritish formasi",-1),J=D({__name:"EditProduct",props:["current"],emits:["editProduct"],setup(h,{expose:f,emit:i}){const{current:s}=h,c=g({dialog:!1,products_types:null}),t=g({name:null,expiration_date:null,product_type:null,isActive:!0});_.get("product_type").then(({data:r})=>{c.products_types=r.map(n=>({...n,count:1}))});function a(){_.patch(`product/${s.selected}`,t).then(({data:r})=>{c.dialog=!1,i("editProduct",r)})}function d(r){_.get(`product/${r}`).then(({data:n})=>{t.name=n.name,t.product_type=n.product_type_id,t.expiration_date=n.expiration_date,t.isActive=!!n.isActive})}function m(){t.name=null,t.product_type=null,t.expiration_date=null,t.isActive=!0}return R(()=>c.dialog,r=>{r?d(s.selected):m()}),f({toggle:()=>c.dialog=!0}),(r,n)=>{const V=l("v-card-title"),y=l("v-text-field"),v=l("v-col"),w=l("v-select"),A=l("v-switch"),C=l("v-row"),N=l("v-container"),P=l("v-card-text"),k=l("v-spacer"),u=l("v-btn"),I=l("v-card-actions"),M=l("v-card"),T=l("v-dialog");return U(),S(T,{modelValue:c.dialog,"onUpdate:modelValue":n[5]||(n[5]=p=>c.dialog=p),persistent:"",width:"512",location:"right"},{default:o(()=>[e(M,{tag:"form",class:"bg-white",onSubmit:j(a,["prevent"])},{default:o(()=>[e(V,{class:"bg-blue-grey-lighten-5"},{default:o(()=>[L]),_:1}),e(P,{class:"pa-0"},{default:o(()=>[e(N,null,{default:o(()=>[e(C,null,{default:o(()=>[e(v,{cols:"12",class:"pt-0"},{default:o(()=>[e(y,{color:"teal",label:"Nomi",variant:"underlined","hide-details":"auto",modelValue:t.name,"onUpdate:modelValue":n[0]||(n[0]=p=>t.name=p),required:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",class:"pt-0"},{default:o(()=>[e(y,{color:"teal",label:"Muddati (Oy)",variant:"underlined","hide-details":"auto",type:"number",modelValue:t.expiration_date,"onUpdate:modelValue":n[1]||(n[1]=p=>t.expiration_date=p)},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",class:"pt-0"},{default:o(()=>[e(w,{color:"teal",items:c.products_types,variant:"underlined","hide-details":"auto",modelValue:t.product_type,"onUpdate:modelValue":n[2]||(n[2]=p=>t.product_type=p),label:"Turi","item-title":"name","item-value":p=>p.id},null,8,["items","modelValue","item-value"])]),_:1}),e(v,{cols:"12",class:"pt-0"},{default:o(()=>[e(A,{label:"Faolligi",modelValue:t.isActive,"onUpdate:modelValue":n[3]||(n[3]=p=>t.isActive=p),"hide-details":"auto",color:"teal"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(I,null,{default:o(()=>[e(k),e(u,{color:"blue-gray-1",variant:"text",type:"button",onClick:n[4]||(n[4]=p=>c.dialog=!1)},{default:o(()=>[b(" Yopish ")]),_:1}),e(u,{color:"blue-darken-1",variant:"text",type:"submit"},{default:o(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])}}}),Q={class:"d-flex flex-column"},W={class:"d-flex justify-space-between items-center"},oe=D({__name:"Products",setup(h){const f=B(),i=g({selected:null,gridApi:null});function s(d){i.gridApi.applyTransaction({add:[d],addIndex:0})}function c(d){i.gridApi.getRowNode(d.id).setData(d)}const t=g([{field:"id",headerName:"Kod",width:80},{field:"name",headerName:"Nomi",flex:1},{field:"expiration_date",headerName:"Muddati (Oy)"},{field:"product_type.name",headerName:"Turi"},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],field:"isActive",headerName:"Faolligi",cellRenderer:Y,width:60,headerClass:["px-2"],onCellClicked:d=>{_.post(`product/set_activate/${d.data.id}`,{active:!d.value}).then(()=>{d.node.setDataValue("isActive",!d.value)})}},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:z,headerClass:["px-2"],onCellClicked:({data:d})=>{i.selected=d.id,f.value.toggle()}}]),a=B([]);return _.get("product").then(({data:d})=>a.value=d),(d,m)=>{const x=l("v-spacer");return U(),E("section",Q,[$("div",W,[e(O),e(K,{onAddProduct:s}),e(J,{onEditProduct:c,ref_key:"editComponent",ref:f,current:i},null,8,["current"])]),e(x,{class:"px-4"},{default:o(()=>[e(F(G),{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:r})=>r.id,columnDefs:t,rowData:a.value,onGridReady:m[0]||(m[0]=r=>i.gridApi=r.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{oe as default};
