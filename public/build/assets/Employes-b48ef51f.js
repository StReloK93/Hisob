import{s as $}from"./swal-00d0fd38.js";import{_ as w}from"./Icon.vue_vue_type_script_setup_true_lang-cb1fb80e.js";import{d as x,m as D,n as _,b as r,o as v,c as V,w as u,f as a,h as g,j as C,p as j,q as I,a as q,r as k,s as B,v as F,i as L,e as R}from"./app-d5ce1550.js";import{r as y}from"./helpers-ab18c3f4.js";const E=x({__name:"FormInputs",props:["formData","pageData"],setup(t){const{formData:d}=t,s=D({organizations:null,positions:null,inputLoading:!1});function m(){d.table_number.length==5&&(s.inputLoading=!0,f())}_.all([_.get("accessOrganizations"),_.get("position")]).then(_.spread(({data:n},{data:l})=>{s.organizations=n,s.positions=l}));function f(){_.get(`employe/getdata/${d.table_number}`).then(({data:n})=>{d.name=n.name,d.organization_id=n.organization_id,d.profession=n.profession,d.hiring_date=n.hiring_date,setTimeout(()=>s.inputLoading=!1,1e3)}).catch(()=>{s.inputLoading=!1})}return(n,l)=>{const c=r("v-text-field"),h=r("v-autocomplete"),e=r("v-col"),o=r("v-radio"),p=r("v-radio-group"),z=r("v-row");return v(),V(z,null,{default:u(()=>[a(e,{cols:"12",class:"pt-0"},{default:u(()=>[a(c,{class:"mb-2",onInput:m,loading:s.inputLoading,rules:g(y),label:"Tabel raqam",modelValue:t.formData.table_number,"onUpdate:modelValue":l[0]||(l[0]=i=>t.formData.table_number=i),type:"number"},null,8,["loading","rules","modelValue"]),a(c,{class:"mb-2",rules:g(y),label:"F.I.SH",modelValue:t.formData.name,"onUpdate:modelValue":l[1]||(l[1]=i=>t.formData.name=i)},null,8,["rules","modelValue"]),s.organizations?(v(),V(h,{key:0,class:"mb-2",items:s.organizations,modelValue:t.formData.organization_id,"onUpdate:modelValue":l[2]||(l[2]=i=>t.formData.organization_id=i),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:g(y)},null,8,["items","modelValue","rules"])):C("",!0),s.positions?(v(),V(h,{key:1,class:"mb-2",items:s.positions,modelValue:t.formData.position_id,"onUpdate:modelValue":l[3]||(l[3]=i=>t.formData.position_id=i),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:g(y),"item-value":"id"},null,8,["items","modelValue","rules"])):C("",!0),a(c,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:t.formData.profession,"onUpdate:modelValue":l[4]||(l[4]=i=>t.formData.profession=i),rules:g(y)},null,8,["modelValue","rules"]),a(c,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:t.formData.hiring_date,"onUpdate:modelValue":l[5]||(l[5]=i=>t.formData.hiring_date=i),type:"date",rules:g(y)},null,8,["modelValue","rules"])]),_:1}),a(e,{cols:"6"},{default:u(()=>[a(c,{class:"mb-2",label:"Bo'yi",modelValue:t.formData.heigth,"onUpdate:modelValue":l[6]||(l[6]=i=>t.formData.heigth=i)},null,8,["modelValue"]),a(c,{class:"mb-2",label:"Kiyim o'lchami",modelValue:t.formData.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=i=>t.formData.size_cloth=i)},null,8,["modelValue"])]),_:1}),a(e,{cols:"6"},{default:u(()=>[a(c,{class:"mb-2",label:"Bosh o'lchami",modelValue:t.formData.size_head,"onUpdate:modelValue":l[8]||(l[8]=i=>t.formData.size_head=i)},null,8,["modelValue"]),a(c,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:t.formData.size_shoes,"onUpdate:modelValue":l[9]||(l[9]=i=>t.formData.size_shoes=i)},null,8,["modelValue"])]),_:1}),a(e,{cols:"12"},{default:u(()=>[a(p,{small:"",modelValue:t.formData.gender,"onUpdate:modelValue":l[10]||(l[10]=i=>t.formData.gender=i),rules:g(y)},{default:u(()=>[a(o,{label:"Erkak",value:!0}),a(o,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})}}}),M=x({__name:"AddEmploye",emits:["addEmploye"],setup(t,{emit:d}){const s=D({dialog:!1}),m=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function f(){await _.post("employe",m).then(({data:n})=>{s.dialog=!1,d("addEmploye",n)})}return(n,l)=>{const c=r("v-btn"),h=r("CustomForm"),e=r("v-dialog"),o=r("v-row");return v(),V(o,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:u(()=>[a(e,{modelValue:s.dialog,"onUpdate:modelValue":l[1]||(l[1]=p=>s.dialog=p),persistent:"",width:"768",location:"right"},{activator:u(({props:p})=>[a(c,j({icon:"mdi-plus",color:"teal"},p),null,16)]),default:u(()=>[a(h,{submitMethod:f,onClose:l[0]||(l[0]=p=>s.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:u(()=>[a(E,{formData:m,pageData:s},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),T=x({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(t,{expose:d,emit:s}){const{current:m}=t,f=D({dialog:!1}),n=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function l(){_.get(`employe/${m.selected}`).then(({data:e})=>{const o=e.position.at(-1);o&&(n.position_id=o.position.id),n.table_number=e.table_number,n.name=e.name,n.hiring_date=o.hiring_date,n.profession=o.profession,n.organization_id=+o.organization_id,n.gender=e.gender,n.heigth=e.heigth,n.size_cloth=e.size_cloth,n.size_head=e.size_head,n.size_shoes=e.size_shoes})}async function c(){await _.patch(`employe/${m.selected}`,n).then(({data:e})=>{f.dialog=!1,s("editEmploye",e)})}return I(()=>f.dialog,e=>{e&&l()}),d({toggle:()=>f.dialog=!0}),(e,o)=>{const p=r("CustomForm"),z=r("v-dialog");return v(),V(z,{modelValue:f.dialog,"onUpdate:modelValue":o[1]||(o[1]=i=>f.dialog=i),persistent:"",width:"768",location:"right"},{default:u(()=>[a(p,{submitMethod:c,onClose:o[0]||(o[0]=i=>f.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:u(()=>[a(E,{formData:n,pageData:f},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])}}}),P={class:"d-flex flex-column"},Y={class:"d-flex justify-space-between items-center"},G={class:"px-4 mb-2"},X=x({__name:"Employes",setup(t){const d=q(),s=k(),m=D({gridApi:null,selected:null});function f(e){m.gridApi.applyTransaction({add:[e],addIndex:0})}function n(e){m.gridApi.getRowNode(e.id).setData(e)}const l=B(),c=D([{width:65,field:"id"},{field:"table_number",headerName:"Tabel №",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{headerName:"Ish joyi",sortable:!0,cellRenderer:({data:e})=>{var o;return(o=e.position.at(-1).organization)==null?void 0:o.short_name}},{headerName:"Lavozimi",sortable:!0,cellRenderer:({data:e})=>e.position.at(-1).profession},{headerName:"Yoriqnoma №",sortable:!0,cellRenderer:e=>{const o=e.data.position.at(-1).position;return`${o.position_type_id} - ${o.number_in_document}`}},{headerName:"Ishga qabul kuni",sortable:!0,width:160,cellRenderer:({data:e})=>F(e.position.at(-1).hiring_date).format("YYYY-MM-DD")},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>l.push({name:"employe",params:{id:e.id}})},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>{m.selected=e.id,s.value.toggle()}},{hide:d.userRoles.includes(1)==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-delete-empty",color:"red"},headerClass:["px-2"],onCellClicked:({data:e})=>{$.fire({title:"Aniq o'chirmoqchimisiz?",text:"Malumotni qayta tiklab bo'lmaydi",icon:"warning"}).then(o=>{o.isConfirmed&&_.delete(`employe/${e.id}`).then(()=>{m.gridApi.applyTransaction({remove:[e]})})})}}]),h=k([]);return _.get("employe").then(({data:e})=>h.value=e),(e,o)=>{const p=r("Breadcrumbs"),z=r("v-text-field"),i=r("v-col"),N=r("v-row"),U=r("AgGridVue"),A=r("v-spacer");return v(),L("main",P,[R("div",Y,[a(p),g(d).userRoles.includes(4)||g(d).userRoles.includes(1)?(v(),V(M,{key:0,onAddEmploye:f})):C("",!0),a(T,{onEditEmploye:n,ref_key:"editComponent",ref:s,current:m},null,8,["current"])]),R("div",G,[a(N,{class:"d-flex justify-end"},{default:u(()=>[a(i,{cols:"3"},{default:u(()=>[a(z,{"prepend-inner-icon":"mdi-magnify",onInput:o[0]||(o[0]=b=>m.gridApi.setQuickFilter(b.target.value)),label:"Qidiruv"})]),_:1})]),_:1})]),a(A,{class:"px-4"},{default:u(()=>[a(U,{defaultColDef:{sortable:!0},class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:b})=>b.id,columnDefs:c,rowData:h.value,onGridReady:o[1]||(o[1]=b=>m.gridApi=b.api),onRowDoubleClicked:o[2]||(o[2]=b=>g(l).push({name:"employe",params:{id:b.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{X as default};
