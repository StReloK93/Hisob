import{d as V,a as s,o as y,c as z,w as c,e as t,g as h,m as f,l as D,n as A,p as I,u as B,r as w,q as j,h as F,b as C,i as $}from"./app-94e534c8.js";import{r as v}from"./helpers-ca74a7fa.js";const k=V({__name:"Icon",props:["params"],setup(a){return(d,r)=>{const u=s("v-btn");return y(),z(u,{color:"teal",icon:a.params.icon,size:"x-small"},null,8,["icon"])}}}),E=V({__name:"FormInputs",props:["formData","pageData"],setup(a){const{formData:d,pageData:r}=a;function u(){d.table_number.length==5&&(r.inputLoading=!0,m())}function m(){f.get(`employe/getdata/${d.table_number}`).then(({data:o})=>{d.name=o.name,d.organization_id=o.organization_id,d.profession=o.profession,d.hiring_date=o.hiring_date,setTimeout(()=>r.inputLoading=!1,1e3)}).catch(()=>{r.inputLoading=!1})}return(o,l)=>{const g=s("v-text-field"),_=s("v-autocomplete"),e=s("v-col"),i=s("v-radio"),p=s("v-radio-group"),x=s("v-row");return y(),z(x,null,{default:c(()=>[t(e,{cols:"12",class:"pt-0"},{default:c(()=>[t(g,{class:"mb-2",onInput:u,loading:a.pageData.inputLoading,rules:h(v),label:"Tabel raqam",modelValue:a.formData.table_number,"onUpdate:modelValue":l[0]||(l[0]=n=>a.formData.table_number=n),type:"number"},null,8,["loading","rules","modelValue"]),t(g,{class:"mb-2",rules:h(v),label:"F.I.SH",modelValue:a.formData.name,"onUpdate:modelValue":l[1]||(l[1]=n=>a.formData.name=n)},null,8,["rules","modelValue"]),t(_,{class:"mb-2",items:a.pageData.organizations,modelValue:a.formData.organization_id,"onUpdate:modelValue":l[2]||(l[2]=n=>a.formData.organization_id=n),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:h(v)},null,8,["items","modelValue","rules"]),t(_,{class:"mb-2",items:a.pageData.positions,modelValue:a.formData.position_id,"onUpdate:modelValue":l[3]||(l[3]=n=>a.formData.position_id=n),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:h(v),"item-value":"id"},null,8,["items","modelValue","rules"]),t(g,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:a.formData.profession,"onUpdate:modelValue":l[4]||(l[4]=n=>a.formData.profession=n),rules:h(v)},null,8,["modelValue","rules"]),t(g,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:a.formData.hiring_date,"onUpdate:modelValue":l[5]||(l[5]=n=>a.formData.hiring_date=n),type:"date",rules:h(v)},null,8,["modelValue","rules"])]),_:1}),t(e,{cols:"6"},{default:c(()=>[t(g,{class:"mb-2",label:"Bo'yi",modelValue:a.formData.heigth,"onUpdate:modelValue":l[6]||(l[6]=n=>a.formData.heigth=n)},null,8,["modelValue"]),t(g,{class:"mb-2",label:"Kiyim o'lchami",modelValue:a.formData.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=n=>a.formData.size_cloth=n)},null,8,["modelValue"])]),_:1}),t(e,{cols:"6"},{default:c(()=>[t(g,{class:"mb-2",label:"Bosh o'lchami",modelValue:a.formData.size_head,"onUpdate:modelValue":l[8]||(l[8]=n=>a.formData.size_head=n)},null,8,["modelValue"]),t(g,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:a.formData.size_shoes,"onUpdate:modelValue":l[9]||(l[9]=n=>a.formData.size_shoes=n)},null,8,["modelValue"])]),_:1}),t(e,{cols:"12"},{default:c(()=>[t(p,{small:"",modelValue:a.formData.gender,"onUpdate:modelValue":l[10]||(l[10]=n=>a.formData.gender=n),rules:h(v)},{default:c(()=>[t(i,{label:"Erkak",value:!0}),t(i,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})}}}),L=V({__name:"AddEmploye",emits:["addEmploye"],setup(a,{emit:d}){const r=D({dialog:!1,organizations:null,positions:null,inputLoading:!1}),u=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function m(){await f.post("employe",u).then(({data:o})=>{r.dialog=!1,d("addEmploye",o)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:o},{data:l})=>{r.organizations=o,r.positions=l})),(o,l)=>{const g=s("v-btn"),_=s("CustomForm"),e=s("v-dialog"),i=s("v-row");return y(),z(i,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:c(()=>[t(e,{modelValue:r.dialog,"onUpdate:modelValue":l[1]||(l[1]=p=>r.dialog=p),persistent:"",width:"768",location:"right"},{activator:c(({props:p})=>[t(g,A({icon:"mdi-plus",color:"teal"},p),null,16)]),default:c(()=>[t(_,{submitMethod:m,onClose:l[0]||(l[0]=p=>r.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:c(()=>[t(E,{formData:u,pageData:r},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),q=V({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(a,{expose:d,emit:r}){const{current:u}=a,m=D({dialog:!1,organizations:null,positions:null}),o=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function l(){f.get(`employe/${u.selected}`).then(({data:e})=>{const i=e.position.at(-1);i&&(o.position_id=i.position.id),o.table_number=e.table_number,o.name=e.name,o.hiring_date=e.hiring_date,o.gender=e.gender,o.heigth=e.heigth,o.profession=e.profession,o.size_cloth=e.size_cloth,o.size_head=e.size_head,o.size_shoes=e.size_shoes,o.organization_id=e.organization_id})}async function g(){await f.patch(`employe/${u.selected}`,o).then(({data:e})=>{m.dialog=!1,r("editEmploye",e)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:e},{data:i})=>{m.organizations=e,m.positions=i})),I(()=>m.dialog,e=>{e&&l()}),d({toggle:()=>m.dialog=!0}),(e,i)=>{const p=s("CustomForm"),x=s("v-dialog");return y(),z(x,{modelValue:m.dialog,"onUpdate:modelValue":i[1]||(i[1]=n=>m.dialog=n),persistent:"",width:"768",location:"right"},{default:c(()=>[t(p,{submitMethod:g,onClose:i[0]||(i[0]=n=>m.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:c(()=>[t(E,{formData:o,pageData:m},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])}}});function T(a){return a?"Erkak":"Ayol"}const O={class:"d-flex flex-column"},S={class:"d-flex justify-space-between items-center"},G={class:"px-4 mb-2"},P=V({__name:"Employes",setup(a){const d=B(),r=w(),u=D({gridApi:null,selected:null});function m(e){u.gridApi.applyTransaction({add:[e],addIndex:0})}function o(e){u.gridApi.getRowNode(e.id).setData(e)}const l=j(),g=D([{field:"table_number",headerName:"Tabel â„–",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:e=>e.value.at(-1)?e.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:e=>T(e.value),sortable:!0,width:60,headerClass:["px-2"],cellClass:["px-2"]},{field:"heigth",headerName:"Bo'yi (sm)",sortable:!0,width:85,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_head",headerName:"Bosh o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_cloth",headerName:"Kiyim o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_shoes",headerName:"Oyoq kiyim o'lch..",sortable:!0,width:125,headerClass:["px-2"],cellClass:["px-2"]},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:k,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>l.push({name:"employe",params:{id:e.id}})},{hide:(d.userRoles.includes(4)||d.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:k,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>{u.selected=e.id,r.value.toggle()}}]),_=w([]);return f.get("employe").then(({data:e})=>_.value=e),(e,i)=>{const p=s("Breadcrumbs"),x=s("v-text-field"),n=s("v-col"),N=s("v-row"),R=s("AgGridVue"),U=s("v-spacer");return y(),F("main",O,[C("div",S,[t(p),h(d).userRoles.includes(4)||h(d).userRoles.includes(1)?(y(),z(L,{key:0,onAddEmploye:m})):$("",!0),t(q,{onEditEmploye:o,ref_key:"editComponent",ref:r,current:u},null,8,["current"])]),C("div",G,[t(N,{class:"d-flex justify-end"},{default:c(()=>[t(n,{cols:"3"},{default:c(()=>[t(x,{"prepend-inner-icon":"mdi-magnify",onInput:i[0]||(i[0]=b=>u.gridApi.setQuickFilter(b.target.value)),label:"Qidiruv"})]),_:1})]),_:1})]),t(U,{class:"px-4"},{default:c(()=>[t(R,{class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:b})=>b.id,columnDefs:g,rowData:_.value,onGridReady:i[1]||(i[1]=b=>u.gridApi=b.api),onRowDoubleClicked:i[2]||(i[2]=b=>h(l).push({name:"employe",params:{id:b.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{P as default};
