import{d as S,r as E,j as y,l as f,k as j,a as i,o as $,c as T,w as l,b as e,m as K,i as F,f as U,e as R,n as O,h as G,g as L}from"./app-7beed944.js";import{I as X}from"./IconEdit-385ec21c.js";import{_ as Y,A as J}from"./ag-grid.css_vue_type_style_index_0_src_true_lang-307e9286.js";const M=R("span",null,"Xodim kiritish",-1),P=S({__name:"AddEmploye",emits:["addEmploye"],setup(z,{emit:b}){const v=E(),u=y({dialog:!1,organizations:null,positions:null,inputLoading:!1,rules:[m=>m==null||m==""?"toldiring":!0]}),t=y({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function _(){const{valid:m}=await v.value.validate();m!=!1&&f.post("employe",t).then(({data:n})=>{u.dialog=!1,b("addEmploye",n)})}function a(){t.table_number.length==5&&(u.inputLoading=!0,V())}function V(){f.get(`employe/getdata/${t.table_number}`).then(({data:m})=>{t.name=m.name,t.organization_id=m.organization_id,setTimeout(()=>u.inputLoading=!1,1e3)}).catch(()=>{u.inputLoading=!1})}f.all([f.get("organization"),f.get("position")]).then(f.spread(({data:m},{data:n})=>{u.organizations=m,u.positions=n}));function p(){t.table_number=null,t.name=null,t.position_id=null,t.hiring_date=null,t.gender=null,t.heigth=null,t.size_cloth=null,t.size_head=null,t.size_shoes=null,t.organization_id=null}return j(()=>u.dialog,m=>{m&&p()}),(m,n)=>{const d=i("v-btn"),o=i("v-card-title"),h=i("v-text-field"),c=i("v-col"),g=i("v-select"),x=i("v-radio"),w=i("v-radio-group"),C=i("v-row"),N=i("v-container"),I=i("v-card-text"),q=i("v-spacer"),D=i("v-card-actions"),k=i("v-form"),A=i("v-card"),B=i("v-dialog");return $(),T(C,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:l(()=>[e(B,{modelValue:u.dialog,"onUpdate:modelValue":n[11]||(n[11]=s=>u.dialog=s),persistent:"",width:"512",location:"right"},{activator:l(({props:s})=>[e(d,K({icon:"mdi-plus",color:"teal"},s),null,16)]),default:l(()=>[e(A,null,{default:l(()=>[e(k,{ref_key:"form",ref:v,"fast-fail":"",class:"bg-white",onSubmit:F(_,["prevent"])},{default:l(()=>[e(o,{class:"bg-blue-grey-lighten-5"},{default:l(()=>[M]),_:1}),e(I,{class:"pa-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(C,null,{default:l(()=>[e(c,{cols:"12",class:"pt-0"},{default:l(()=>[e(h,{onInput:a,loading:u.inputLoading,color:"teal",rules:u.rules,label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:t.table_number,"onUpdate:modelValue":n[0]||(n[0]=s=>t.table_number=s),type:"number"},null,8,["loading","rules","modelValue"])]),_:1}),e(c,{cols:"12",class:"pt-0"},{default:l(()=>[e(h,{color:"teal",rules:u.rules,label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:t.name,"onUpdate:modelValue":n[1]||(n[1]=s=>t.name=s)},null,8,["rules","modelValue"])]),_:1}),e(c,{cols:"12",class:"pt-0"},{default:l(()=>[e(g,{color:"teal",items:u.organizations,variant:"underlined","hide-details":"auto",modelValue:t.organization_id,"onUpdate:modelValue":n[2]||(n[2]=s=>t.organization_id=s),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:u.rules},null,8,["items","modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(g,{color:"teal",items:u.positions,variant:"underlined","hide-details":"auto",modelValue:t.position_id,"onUpdate:modelValue":n[3]||(n[3]=s=>t.position_id=s),label:"Lavozimi","item-title":"name",rules:u.rules,"item-value":"id"},null,8,["items","modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(h,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:t.hiring_date,"onUpdate:modelValue":n[4]||(n[4]=s=>t.hiring_date=s),type:"date",rules:u.rules},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"6"},{default:l(()=>[e(h,{color:"teal",label:"Bo'yi",variant:"underlined","hide-details":"auto",modelValue:t.heigth,"onUpdate:modelValue":n[5]||(n[5]=s=>t.heigth=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:l(()=>[e(h,{color:"teal",label:"Bosh o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_head,"onUpdate:modelValue":n[6]||(n[6]=s=>t.size_head=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:l(()=>[e(h,{color:"teal",label:"Kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_cloth,"onUpdate:modelValue":n[7]||(n[7]=s=>t.size_cloth=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"6"},{default:l(()=>[e(h,{color:"teal",label:"Oyoq kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:t.size_shoes,"onUpdate:modelValue":n[8]||(n[8]=s=>t.size_shoes=s)},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(w,{color:"teal",class:"",small:"",modelValue:t.gender,"onUpdate:modelValue":n[9]||(n[9]=s=>t.gender=s),"hide-details":"auto",rules:u.rules},{default:l(()=>[e(x,{label:"Erkak",value:"1"}),e(x,{label:"Ayol",value:"0"})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:l(()=>[e(q),e(d,{color:"blue-gray-1",variant:"text",type:"button",onClick:n[10]||(n[10]=s=>u.dialog=!1)},{default:l(()=>[U(" Yopish ")]),_:1}),e(d,{color:"teal",variant:"text",type:"submit"},{default:l(()=>[U(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),W=R("span",null,"Xodim ma'lumotlarini o'zgartirish",-1),Q=S({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(z,{expose:b,emit:v}){const{current:u}=z,t=E(),_=y({dialog:!1,organizations:null,positions:null,rules:[d=>d==null||d==""?"toldiring":!0]}),a=y({table_number:null,name:null,position_id:null,hiring_date:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function V(){f.get(`employe/${u.selected}`).then(({data:d})=>{const o=d.position.at(-1);o&&(a.position_id=o.position.id),a.table_number=d.table_number,a.name=d.name,a.hiring_date=d.hiring_date,a.gender=d.gender,a.organization_id=d.organization_id})}async function p(){const{valid:d}=await t.value.validate();d!=!1&&f.patch(`employe/${u.selected}`,a).then(({data:o})=>{_.dialog=!1,v("editEmploye",o)})}f.all([f.get("organization"),f.get("position")]).then(f.spread(({data:d},{data:o})=>{_.organizations=d,_.positions=o}));function m(){a.table_number=null,a.name=null,a.position_id=null,a.hiring_date=null,a.gender=null,a.heigth=null,a.size_cloth=null,a.size_head=null,a.size_shoes=null,a.organization_id=null}return j(()=>_.dialog,d=>{d?V():m()}),b({toggle:()=>_.dialog=!0}),(d,o)=>{const h=i("v-card-title"),c=i("v-text-field"),g=i("v-col"),x=i("v-select"),w=i("v-radio"),C=i("v-radio-group"),N=i("v-row"),I=i("v-container"),q=i("v-card-text"),D=i("v-spacer"),k=i("v-btn"),A=i("v-card-actions"),B=i("v-form"),s=i("v-card"),H=i("v-dialog");return $(),T(H,{modelValue:_.dialog,"onUpdate:modelValue":o[11]||(o[11]=r=>_.dialog=r),persistent:"",width:"512",location:"right"},{default:l(()=>[e(s,null,{default:l(()=>[e(B,{ref_key:"form",ref:t,class:"bg-white",onSubmit:F(p,["prevent"])},{default:l(()=>[e(h,{class:"bg-blue-grey-lighten-5"},{default:l(()=>[W]),_:1}),e(q,{class:"pa-0"},{default:l(()=>[e(I,null,{default:l(()=>[e(N,null,{default:l(()=>[e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(c,{color:"teal",label:"Tabel raqam",variant:"underlined","hide-details":"auto",modelValue:a.table_number,"onUpdate:modelValue":o[0]||(o[0]=r=>a.table_number=r),type:"number",rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(c,{color:"teal",label:"F.I.SH",variant:"underlined","hide-details":"auto",modelValue:a.name,"onUpdate:modelValue":o[1]||(o[1]=r=>a.name=r),rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",class:"pt-0"},{default:l(()=>[e(x,{color:"teal",items:_.organizations,variant:"underlined","hide-details":"auto",modelValue:a.organization_id,"onUpdate:modelValue":o[2]||(o[2]=r=>a.organization_id=r),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:_.rules},null,8,["items","modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(x,{color:"teal",items:_.positions,variant:"underlined","hide-details":"auto",modelValue:a.position_id,"onUpdate:modelValue":o[3]||(o[3]=r=>a.position_id=r),label:"Lavozimi","item-title":"name","item-value":"id",rules:_.rules},null,8,["items","modelValue","rules"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(c,{color:"teal",label:"Ishga qabul qilingan sana",variant:"underlined","hide-details":"auto",modelValue:a.hiring_date,"onUpdate:modelValue":o[4]||(o[4]=r=>a.hiring_date=r),type:"date",rules:_.rules},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(c,{color:"teal",label:"Bo'yi",variant:"underlined","hide-details":"auto",modelValue:a.heigth,"onUpdate:modelValue":o[5]||(o[5]=r=>a.heigth=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(c,{color:"teal",label:"Bosh o'lchami",variant:"underlined","hide-details":"auto",modelValue:a.size_head,"onUpdate:modelValue":o[6]||(o[6]=r=>a.size_head=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(c,{color:"teal",label:"Kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:a.size_cloth,"onUpdate:modelValue":o[7]||(o[7]=r=>a.size_cloth=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(c,{color:"teal",label:"Oyoq kiyim o'lchami",variant:"underlined","hide-details":"auto",modelValue:a.size_shoes,"onUpdate:modelValue":o[8]||(o[8]=r=>a.size_shoes=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(C,{color:"teal",small:"",modelValue:a.gender,"onUpdate:modelValue":o[9]||(o[9]=r=>a.gender=r),"hide-details":"auto"},{default:l(()=>[e(w,{label:"Erkak",value:1}),e(w,{label:"Ayol",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D),e(k,{color:"blue-gray-1",variant:"text",type:"button",onClick:o[10]||(o[10]=r=>_.dialog=!1)},{default:l(()=>[U(" Yopish ")]),_:1}),e(k,{color:"blue-darken-1",variant:"text",type:"submit"},{default:l(()=>[U(" Saqlash ")]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}}});function Z(z){return z?"Erkak":"Ayol"}const ee={class:"d-flex flex-column"},le={class:"d-flex justify-space-between items-center"},ne=S({__name:"Employes",setup(z){const b=E(),v=y({gridApi:null,selected:null});function u(p){v.gridApi.applyTransaction({add:[p],addIndex:0})}function t(p){v.gridApi.getRowNode(p.id).setData(p)}const _=O(),a=y([{field:"table_number",headerName:"Tabel raqami",sortable:!0,width:100,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:p=>p.value.at(-1)?p.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:p=>Z(p.value),sortable:!0,width:60,headerClass:["px-2"],cellClass:["px-2"]},{field:"heigth",headerName:"Bo'yi (sm)",sortable:!0,width:85,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_head",headerName:"Bosh o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_cloth",headerName:"Kiyim o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_shoes",headerName:"Oyoq kiyim o'lch..",sortable:!0,width:125,headerClass:["px-2"],cellClass:["px-2"]},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:X,headerClass:["px-2"],onCellClicked:({data:p})=>{v.selected=p.id,b.value.toggle()}}]),V=E([]);return f.get("employe").then(({data:p})=>V.value=p),(p,m)=>{const n=i("v-spacer");return $(),G("main",ee,[R("div",le,[e(Y),e(P,{onAddEmploye:u}),e(Q,{onEditEmploye:t,ref_key:"editComponent",ref:b,current:v},null,8,["current"])]),e(n,{class:"px-4"},{default:l(()=>[e(L(J),{class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:d})=>d.id,columnDefs:a,rowData:V.value,onGridReady:m[0]||(m[0]=d=>v.gridApi=d.api),onRowDoubleClicked:m[1]||(m[1]=d=>L(_).push({name:"employe",params:{id:d.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{ne as default};
