import{d as w,a as r,o as y,c as h,w as c,e as l,g as x,l as g,m as _,n as A,r as V,h as P,b as N}from"./app-af53a518.js";import{r as b}from"./helpers-ca74a7fa.js";import{I as $}from"./IconEdit-b6cd3b61.js";const C=w({__name:"FormInputs",props:["formData","pageData"],setup(u){return(f,e)=>{const m=r("v-combobox"),d=r("v-autocomplete"),t=r("v-switch"),a=r("v-col"),n=r("v-row");return y(),h(n,null,{default:c(()=>[l(a,{cols:"12",class:"pt-0"},{default:c(()=>[l(m,{class:"mb-2",label:"Nomi",modelValue:u.formData.name,"onUpdate:modelValue":e[0]||(e[0]=s=>u.formData.name=s),items:u.pageData.products,rules:x(b)},null,8,["modelValue","items","rules"]),l(d,{class:"mb-2",label:"Turi",modelValue:u.formData.product_type_id,"onUpdate:modelValue":e[1]||(e[1]=s=>u.formData.product_type_id=s),items:u.pageData.products_types,rules:x(b),"item-title":"name","item-value":s=>s.id},null,8,["modelValue","items","rules","item-value"]),l(t,{label:"Faolligi",modelValue:u.formData.isActive,"onUpdate:modelValue":e[2]||(e[2]=s=>u.formData.isActive=s)},null,8,["modelValue"])]),_:1})]),_:1})}}}),B=w({__name:"AddProduct",emits:["addProduct"],setup(u,{emit:f}){const e=g({dialog:!1,products_types:null,products:null}),m=g({name:null,product_type_id:null,isActive:!0});async function d(){await _.post("product",m).then(({data:t})=>{e.dialog=!1,f("addProduct",t)})}return _.get("product_type").then(({data:t})=>{e.products_types=t.map(a=>({...a,count:1}))}),_.get("product").then(({data:t})=>{e.products=t.map(a=>a.name)}),(t,a)=>{const n=r("v-btn"),s=r("CustomForm"),i=r("v-dialog"),o=r("v-row");return y(),h(o,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:c(()=>[l(i,{modelValue:e.dialog,"onUpdate:modelValue":a[1]||(a[1]=p=>e.dialog=p),persistent:"",width:"512",location:"right"},{activator:c(({props:p})=>[l(n,A({icon:"mdi-plus"},p),null,16)]),default:c(()=>[l(s,{submitMethod:d,onClose:a[0]||(a[0]=p=>e.dialog=!1),title:"Mahsulot kiritish"},{default:c(()=>[l(C,{formData:m,pageData:e},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),k=w({__name:"EditProduct",props:["current"],emits:["editProduct"],setup(u,{expose:f,emit:e}){const{current:m}=u,d=g({dialog:!1,products_types:null,products:null}),t=g({name:null,product_type_id:null,isActive:!0});_.get("product_type").then(({data:i})=>{d.products_types=i});async function a(){await _.patch(`product/${m.selected}`,t).then(({data:i})=>{d.dialog=!1,e("editProduct",i)})}_.get("product").then(({data:i})=>{d.products=i.map(o=>o.name)});function n(i){_.get(`product/${i}`).then(({data:o})=>{t.name=o.name,t.product_type_id=o.product_type_id,t.isActive=!!o.isActive})}return f({toggle:()=>d.dialog=!0}),(i,o)=>{const p=r("CustomForm"),v=r("v-dialog");return y(),h(v,{modelValue:d.dialog,"onUpdate:modelValue":o[2]||(o[2]=D=>d.dialog=D),persistent:"",width:"512",location:"right"},{default:c(()=>[l(p,{submitMethod:a,onClose:o[0]||(o[0]=D=>d.dialog=!1),onVnodeMounted:o[1]||(o[1]=D=>n(u.current.selected)),title:"Mahsulotni tahrirlash"},{default:c(()=>[l(C,{formData:t,pageData:d},null,8,["formData","pageData"])]),_:1},512)]),_:1},8,["modelValue"])}}}),F={class:"d-flex flex-column"},I={class:"d-flex justify-space-between items-center"},E=w({__name:"Products",setup(u){const f=V(),e=g({selected:null,gridApi:null});function m(n){e.gridApi.applyTransaction({add:[n],addIndex:0})}function d(n){e.gridApi.getRowNode(n.id).setData(n)}const t=g([{field:"id",headerName:"Kod",width:80},{field:"name",headerName:"Nomi",flex:1},{field:"product_type.name",headerName:"Turi"},{cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:$,headerClass:["px-2"],onCellClicked:({data:n})=>{e.selected=n.id,f.value.toggle()}}]),a=V([]);return _.get("product").then(({data:n})=>a.value=n),(n,s)=>{const i=r("Breadcrumbs"),o=r("AgGridVue"),p=r("v-spacer");return y(),P("section",F,[N("div",I,[l(i),l(B,{onAddProduct:m}),l(k,{onEditProduct:d,ref_key:"editComponent",ref:f,current:e},null,8,["current"])]),l(p,{class:"px-4"},{default:c(()=>[l(o,{headerHeight:34,class:"ag-theme-material h-100",getRowId:({data:v})=>v.id,columnDefs:t,rowData:a.value,onGridReady:s[0]||(s[0]=v=>e.gridApi=v.api),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{E as default};
