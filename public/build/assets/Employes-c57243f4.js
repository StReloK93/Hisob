import{d as z,a as r,o as v,c as x,w as g,e as t,g as h,m as f,l as D,n as E,p as N,u as R,r as C,q as U,h as A,b as I,i as B}from"./app-0ff9e463.js";import{r as _}from"./helpers-ca74a7fa.js";const w=z({__name:"Icon",props:["params"],setup(a){return(s,d)=>{const u=r("v-btn");return v(),x(u,{color:"teal",icon:a.params.icon,size:"x-small"},null,8,["icon"])}}}),k=z({__name:"FormInputs",props:["formData","pageData"],setup(a){const{formData:s,pageData:d}=a;function u(){s.table_number.length==5&&(d.inputLoading=!0,m())}function m(){f.get(`employe/getdata/${s.table_number}`).then(({data:o})=>{s.name=o.name,s.organization_id=o.organization_id,s.profession=o.profession,s.hiring_date=o.hiring_date,setTimeout(()=>d.inputLoading=!1,1e3)}).catch(()=>{d.inputLoading=!1})}return(o,l)=>{const c=r("v-text-field"),b=r("v-autocomplete"),e=r("v-col"),i=r("v-radio"),p=r("v-radio-group"),V=r("v-row");return v(),x(V,null,{default:g(()=>[t(e,{cols:"12",class:"pt-0"},{default:g(()=>[t(c,{class:"mb-2",onInput:u,loading:a.pageData.inputLoading,rules:h(_),label:"Tabel raqam",modelValue:a.formData.table_number,"onUpdate:modelValue":l[0]||(l[0]=n=>a.formData.table_number=n),type:"number"},null,8,["loading","rules","modelValue"]),t(c,{class:"mb-2",rules:h(_),label:"F.I.SH",modelValue:a.formData.name,"onUpdate:modelValue":l[1]||(l[1]=n=>a.formData.name=n)},null,8,["rules","modelValue"]),t(b,{class:"mb-2",items:a.pageData.organizations,modelValue:a.formData.organization_id,"onUpdate:modelValue":l[2]||(l[2]=n=>a.formData.organization_id=n),label:"Ish joyi","item-title":"short_name","item-value":"id",rules:h(_)},null,8,["items","modelValue","rules"]),t(b,{class:"mb-2",items:a.pageData.positions,modelValue:a.formData.position_id,"onUpdate:modelValue":l[3]||(l[3]=n=>a.formData.position_id=n),label:"Meyoriy hujjatdagi lavozimi (kasbi)","item-title":"name",rules:h(_),"item-value":"id"},null,8,["items","modelValue","rules"]),t(c,{class:"mb-2",label:"Lavozimi (kasbi)",modelValue:a.formData.profession,"onUpdate:modelValue":l[4]||(l[4]=n=>a.formData.profession=n),rules:h(_)},null,8,["modelValue","rules"]),t(c,{class:"mb-2",label:"Ushbu lavozim (kasb)ga tayinlangan kuni",modelValue:a.formData.hiring_date,"onUpdate:modelValue":l[5]||(l[5]=n=>a.formData.hiring_date=n),type:"date",rules:h(_)},null,8,["modelValue","rules"])]),_:1}),t(e,{cols:"6"},{default:g(()=>[t(c,{class:"mb-2",label:"Bo'yi",modelValue:a.formData.heigth,"onUpdate:modelValue":l[6]||(l[6]=n=>a.formData.heigth=n)},null,8,["modelValue"]),t(c,{class:"mb-2",label:"Kiyim o'lchami",modelValue:a.formData.size_cloth,"onUpdate:modelValue":l[7]||(l[7]=n=>a.formData.size_cloth=n)},null,8,["modelValue"])]),_:1}),t(e,{cols:"6"},{default:g(()=>[t(c,{class:"mb-2",label:"Bosh o'lchami",modelValue:a.formData.size_head,"onUpdate:modelValue":l[8]||(l[8]=n=>a.formData.size_head=n)},null,8,["modelValue"]),t(c,{class:"mb-2",label:"Oyoq kiyim o'lchami",modelValue:a.formData.size_shoes,"onUpdate:modelValue":l[9]||(l[9]=n=>a.formData.size_shoes=n)},null,8,["modelValue"])]),_:1}),t(e,{cols:"12"},{default:g(()=>[t(p,{small:"",modelValue:a.formData.gender,"onUpdate:modelValue":l[10]||(l[10]=n=>a.formData.gender=n),rules:h(_)},{default:g(()=>[t(i,{label:"Erkak",value:!0}),t(i,{label:"Ayol",value:!1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})}}}),$=z({__name:"AddEmploye",emits:["addEmploye"],setup(a,{emit:s}){const d=D({dialog:!1,organizations:null,positions:null,inputLoading:!1}),u=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:!1,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});async function m(){await f.post("employe",u).then(({data:o})=>{d.dialog=!1,s("addEmploye",o)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:o},{data:l})=>{d.organizations=o,d.positions=l})),(o,l)=>{const c=r("v-btn"),b=r("CustomForm"),e=r("v-dialog"),i=r("v-row");return v(),x(i,{justify:"end",class:"flex-0-0 ma-0 pb-2 px-4 overflow-y-auto"},{default:g(()=>[t(e,{modelValue:d.dialog,"onUpdate:modelValue":l[1]||(l[1]=p=>d.dialog=p),persistent:"",width:"768",location:"right"},{activator:g(({props:p})=>[t(c,E({icon:"mdi-plus",color:"teal"},p),null,16)]),default:g(()=>[t(b,{submitMethod:m,onClose:l[0]||(l[0]=p=>d.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:g(()=>[t(k,{formData:u,pageData:d},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),j=z({__name:"EditEmploye",props:["current"],emits:["editEmploye"],setup(a,{expose:s,emit:d}){const{current:u}=a,m=D({dialog:!1,organizations:null,positions:null}),o=D({table_number:null,name:null,position_id:null,hiring_date:null,profession:null,gender:null,heigth:null,size_cloth:null,size_head:null,size_shoes:null,organization_id:null});function l(){f.get(`employe/${u.selected}`).then(({data:e})=>{const i=e.position.at(-1);i&&(o.position_id=i.position.id),o.table_number=e.table_number,o.name=e.name,o.hiring_date=e.hiring_date,o.gender=e.gender,o.heigth=e.heigth,o.profession=e.profession,o.size_cloth=e.size_cloth,o.size_head=e.size_head,o.size_shoes=e.size_shoes,o.organization_id=e.organization_id})}async function c(){await f.patch(`employe/${u.selected}`,o).then(({data:e})=>{m.dialog=!1,d("editEmploye",e)})}return f.all([f.get("accessOrganizations"),f.get("position")]).then(f.spread(({data:e},{data:i})=>{m.organizations=e,m.positions=i})),N(()=>m.dialog,e=>{e&&l()}),s({toggle:()=>m.dialog=!0}),(e,i)=>{const p=r("CustomForm"),V=r("v-dialog");return v(),x(V,{modelValue:m.dialog,"onUpdate:modelValue":i[1]||(i[1]=n=>m.dialog=n),persistent:"",width:"768",location:"right"},{default:g(()=>[t(p,{submitMethod:c,onClose:i[0]||(i[0]=n=>m.dialog=!1),title:"Xodim kiritish",height:"700px"},{default:g(()=>[t(k,{formData:o,pageData:m},null,8,["formData","pageData"])]),_:1})]),_:1},8,["modelValue"])}}});function F(a){return a?"Erkak":"Ayol"}const L={class:"d-flex flex-column"},q={class:"d-flex justify-space-between items-center"},S=z({__name:"Employes",setup(a){const s=R(),d=C(),u=D({gridApi:null,selected:null});function m(e){u.gridApi.applyTransaction({add:[e],addIndex:0})}function o(e){u.gridApi.getRowNode(e.id).setData(e)}const l=U(),c=D([{field:"table_number",headerName:"Tabel â„–",sortable:!0,width:65,headerClass:["px-2"],cellClass:["px-2"]},{field:"name",headerName:"F.I.SH",sortable:!0,flex:1,minWidth:275},{field:"organization.short_name",headerName:"Ish joyi",sortable:!0},{field:"position",headerName:"Lavozimi",sortable:!0,valueFormatter:e=>e.value.at(-1)?e.value.at(-1).position.name:""},{field:"hiring_date",headerName:"Ishga qabul kuni",sortable:!0,width:160},{field:"gender",headerName:"Jinsi",cellRenderer:e=>F(e.value),sortable:!0,width:60,headerClass:["px-2"],cellClass:["px-2"]},{field:"heigth",headerName:"Bo'yi (sm)",sortable:!0,width:85,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_head",headerName:"Bosh o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_cloth",headerName:"Kiyim o'lch..",sortable:!0,width:105,headerClass:["px-2"],cellClass:["px-2"]},{field:"size_shoes",headerName:"Oyoq kiyim o'lch..",sortable:!0,width:125,headerClass:["px-2"],cellClass:["px-2"]},{hide:(s.userRoles.includes(4)||s.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-eye-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>l.push({name:"employe",params:{id:e.id}})},{hide:(s.userRoles.includes(4)||s.userRoles.includes(1))==!1,cellClass:["d-flex","justify-center","align-center","px-2","bg-gray-100"],headerName:"",width:60,cellRenderer:w,cellRendererParams:{icon:"mdi-pencil-outline"},headerClass:["px-2"],onCellClicked:({data:e})=>{u.selected=e.id,d.value.toggle()}}]),b=C([]);return f.get("employe").then(({data:e})=>b.value=e),(e,i)=>{const p=r("Breadcrumbs"),V=r("AgGridVue"),n=r("v-spacer");return v(),A("main",L,[I("div",q,[t(p),h(s).userRoles.includes(4)||h(s).userRoles.includes(1)?(v(),x($,{key:0,onAddEmploye:m})):B("",!0),t(j,{onEditEmploye:o,ref_key:"editComponent",ref:d,current:u},null,8,["current"])]),t(n,{class:"px-4"},{default:g(()=>[t(V,{class:"ag-theme-material h-100",headerHeight:34,getRowId:({data:y})=>y.id,columnDefs:c,rowData:b.value,onGridReady:i[0]||(i[0]=y=>u.gridApi=y.api),onRowDoubleClicked:i[1]||(i[1]=y=>h(l).push({name:"employe",params:{id:y.data.id}})),animateRows:"true"},null,8,["getRowId","columnDefs","rowData"])]),_:1})])}}});export{S as default};
